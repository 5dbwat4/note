import Card from "@md-components/card.vue"

# 概率论和数理统计
2025-2026 秋冬  
黄炜  
hwmath2003@zju.edu.cn  
浙江大学数学科学学院  
© 浙大黄炜  
仅限用于浙江大学2025-2026 秋冬《概率论和数理统计》课堂


## Preface
- 预修课程：微积分一、二，要求会二重积分的计算；
- 课程教材：概率论与数理统计(第二版)，高等教育出版社，2023；
- 联系方式：hwmath2003@zju.edu.cn；
- 资源分享：学在浙大、钉钉群（原始课件、作业本编号、作业题号、上课课件）；
- 线上参考资源：
  - 中国大学MOOC(概率论与数理统计-浙大班SPOC，第十期)；https://www.icourse163.org/spoc/learn/ZJU-1206351805?tid
  - 智慧树(高等数理统计)
  - 注：需待第三轮选课结束，确定教学班名单后方能进入学习，后续再通知
- 成绩构成：平时成绩60%（包括作业及到课率等平时表现、小测、课程大作业等）+ 期末考试成绩40%
- 总评成绩说明：期末考试成绩设置最低分，低于期末最低分或总评低于60均为不及格。


# Chapter 1 Introduction to Probability
## 关键词(Keywords)
- 样本空间(Sample space)
- 随机事件(Events)
- 频率和概率(Frequency and Probability)
- 等可能概型(Classical Probability)
- 条件概率(Conditional Probability)
- 独立事件(Independent Events)


## §1.1 Sample Space and Events
自然界与社会生活中的两类现象：确定性现象，不确定性现象。
- 确定性现象(deterministic phenomenon)：结果确定；
- 不确定性现象(indeterministic phenomenon)：结果不确定。

<Card type="Example" title="Example 1">
| 现象描述 | 结果类型 |
| --- | --- |
| 向上抛出的物体会下落 | 确定 |
| 抛一枚均匀的硬币，落地时正面朝上 | 不确定 |
| 打靶，击中靶心 | 不确定 |
| 买了彩票会中奖 | 不确定 |
</Card>

### 不确定性现象
- 个别现象
- 随机现象(random phenomenon)：在个别试验中其结果呈现出不确定性，但在大量重复试验中其结果又具有统计规律性(statistical regularity)。——研究对象

**概率论与数理统计是研究随机现象数量规律性的学科。**


对随机现象的观察、记录、实验统称为**随机试验(random experiment)**。它具有以下特性：
1. 可以在相同条件下重复进行；
2. 每次试验的可能结果不止一个，并且事先知道可能出现的所有结果；
3. 完成试验之前不能确定哪一个结果会出现。

<Card type="Example" title="Example 2">
- 一枚硬币抛一次，观察正反面出现的情况；
- 对某路公交车某停靠站登记下车人数；
- 对某批电子产品测试其输入电压；
- 对听课人数进行登记。
</Card>

#### (一) 样本空间(Sample Space)
<Card type="Definition" title="Definition 1 (样本空间)">
一个元素的单点集称为**基本事件(elementary event)**。随机试验 $E$ 的所有结果构成的集合称为该随机试验 $E$ 的**样本空间**(the **sample space** of the experiment)，记为  
$$S=\left\{s_{1}, s_{2}, ..., s_{n}\right\}$$  
有时记为 $\Omega=\{\omega_{1}, \omega_{2}, ..., \omega_{n}\}$。称 $S$（或 $\Omega$）中的元素 $s_{i}$（或 $\omega_{i}$）为**样本点(sample point)**。
</Card>

<Card type="Definition" title="Definition 1 (Sample Space)">
The collection of all possible outcomes of an experiment is called the sample space of the experiment.  
</Card>

The sample space of an experiment can be thought of as a set, or collection, of different possible outcomes; and each outcome can be thought of as a point, or an element, in the sample space. Similarly, events can be thought of as subsets of the sample space.


<Card type="Example" title="Example 3">
1. 一枚硬币抛一次，观察正反面出现的情况：  
$$S=\{正面, 反面\}$$
2. 一颗骰子抛一次，观察其点数情况：  
$$S=\{1,2,3,4,5,6\}$$
3. 记录一城市一日中发生交通事故次数：  
$$S=\{0,1,2, ...\}$$
4. 记录一批产品的寿命 $x$：  
$$S=\{x | a \leq x \leq b\}$$
5. 记录某地一昼夜最高温度 $x$，最低温度 $y$：  
$$S=\left\{(x, y) | T_{0} \leq y \leq x \leq T_{1}\right\}$$
</Card>

注：**样本空间的元素与试验目的有关；样本空间在试验完成前是已知的**。


### 随机事件(Events)
<Card type="Definition" title="Definition 2 (随机事件)">
一般我们称样本空间 $S$ 的子集 $A$ 为随机试验 $E$ 的**随机事件** $A$，简称**事件(event)** $A$。当且仅当 $A$ 所包含的一个样本点发生则称事件 $A$ **发生**。
</Card>

随机事件有如下特征：
1. 任意一事件是相应的样本空间 $S$ 的一个子集，其关系可用维恩(Venn)图来表示；
2. 事件 $A$ 发生当且仅当 $A$ 中的某一个样本点出现；
3. 事件 $A$ 的表示可用集合，也可用语言来表示。


<Card type="Example" title="Example 4 (Rolling a Dice)">
When a six-sided dice is rolled, the sample space can be regarded as containing the six numbers 1, 2, 3, 4, 5, 6, each representing a possible side of the dice that shows after the roll. Symbolically, we write  
$$
S=\{1,2,3,4,5,6\}
$$  

One event $A$ is that an even number is obtained, and it can be represented as the subset $A=\{2,4,6\}$. The event $B$ that a number greater than 2 is obtained is defined by the subset $B=\{3,4,5,6\}$.
</Card>

### Events are sets
- Can describe in words
- Can describe in notation
- Can describe with Venn diagrams

Experiment: toss a coin 3 times.  
$
S=\{HHH, HHT, HTH, THH, HTT, THT, TTH, TTT\}
$  

Event:  

You get 2 or more heads $=\{HHH, HHT, HTH, THH\}$


<Card type="Example" title="Example 5">
观察89路公交车浙大紫金港站候车人数：  
$$
S=\{0,1,2, ...\}
$$  
$$
A=\{至少有10人候车\}=\{10,11,12, ...\}
$$  

$A$ 为随机事件，可能发生，也可能不发生。
</Card>

- 由一个样本点组成的单点集，称为**基本事件**；
- 如果将 $S$ 亦视作事件，则每次试验 $S$ 总是发生，故又称 $S$ 为**必然事件**；
- 为方便起见，记 $\varnothing$ 为**不可能事件**，$\varnothing$ 不包含任何样本点。


Some events are impossible. For example, when a dice is rolled, it is impossible to obtain a negative number. Hence, the event that a negative number will be obtained is defined by the subset of $S$ that contains no outcomes.

<Card type="Definition" title="Definition 3 (Empty Set)">
The subset of $S$ that contains no elements is called the **empty set**, or **null set**, and it is denoted by the symbol $\varnothing$.  
</Card>

In terms of events, the empty set is any event that cannot occur.


事件其本质即为集合。

### Finite and Infinite Sets
Some sets contain only finitely many elements, while others have infinitely many elements. There are two sizes of infinite sets that we need to distinguish.

<Card type="Definition" title="Definition 4 (Countable/Uncountable)">
An infinite set $A$ is **countable** if there is a one-to-one correspondence between the elements of $A$ and the set of natural numbers 1, 2, 3, ... . A set is **uncountable** if it is neither finite nor countable. If we say that a set has at most countably many elements, we mean that the set is either finite or countable.
</Card>

### 事件的相互关系及运算(Relations and Operations of Set Theory)
注：若无特殊说明，以下所提事件均在同一样本空间中。

#### 事件的关系(包含、相等)
- $A \subset B$：事件 $A$ 发生一定导致事件 $B$ 发生。For events, to say that $A \subset B$ means that if $A$ occurs then so does $B$。
- Venn diagram is often used to portray relationships between sets (events)，e.g.：  
  ![](Venn diagram of A subset B)
- 特别地，$\varnothing \subset A \subset S$；
- $A = B$：若 $A \subset B$ 且 $B \subset A$。


<Card type="Example" title="Example 6"></Card>
1. 记 $A=\{明天无雨且气温低于30^{\circ}C\}$，$B=\{明天无雨\}$，则 $A \subset B$；
2. 记 $A=\{至少有10人候车\}$，$B=\{至少有5人候车\}$，则 $A \subset B$；
3. 抛两颗均匀的骰子，两颗骰子出现的点数分别记为 $x$、$y$。记 $A=\{x+y为奇数\}$，$B=\{x,y一奇一偶\}$，则 $A = B$。


#### 事件的运算
1. **和事件**：事件 $A$ 与事件 $B$ 的和事件，记为 $A \cup B$，  
   $$
   A \cup B=\{x | x \in A\ or\ x \in B\}
   $$  
   The union of $A$ and $B$，denoted by $A \cup B$，is the set of all points in $A$ or $B$ or both (e.g.，all colored area)：  
   {/* ![](Venn diagram of A union B)   */}
   $A \cup B$ 发生，即事件 $A$ 与事件 $B$ 至少有一个发生。注意：不要写成 $A+B$。

2. **积事件**：事件 $A$ 与事件 $B$ 的积事件，记为 $A \cap B$、$A \cdot B$ 或 $AB$，  
    $$
    A \cap B=\{x | x \in A\ and\ x \in B\}
    $$  
    The intersection of $A$ and $B$，denoted by $A \cap B$，is the set of all points both in $A$ and $B$ (e.g.，green area)：  
    {/* ![](Venn diagram of A intersection B)   */}
    $A \cap B$ 发生，即事件 $A$ 与事件 $B$ 同时发生。


<Card type="Definition" title="Definition 5 (Union of Many Sets)">
The union of $n$ sets $A_{1}, A_{2}, ..., A_{n}$ is defined to be the set that contains all outcomes that belong to at least one of these $n$ sets. The notation for this union is either of the following：  
$$A_{1} \cup A_{2} \cup \cdots \cup A_{n}\ or\ \bigcup_{i=1}^{n} A_{i}$$  

Similarly, the union of an infinite sequence of sets $A_{1}, A_{2}, ...$ is the set that contains all outcomes that belong to at least one of the events in the sequence. The infinite union is denoted by $\bigcup_{i=1}^{\infty} A_{i}$。  
</Card>
In terms of events, the union of a collection of events is the event that at least one of the events in the collection occurs.


<Card type="Definition" title="Definition 6 (Intersection of Many Sets)">
The intersection of sets $A_{1}, A_{2}, ..., A_{n}$ is defined to be the set that contains the elements that are common to all these $n$ sets. The notation for this intersection is either of the following：  
$$A_{1} \cap A_{2} \cap \cdots \cap A_{n}\ or\ \bigcap_{i=1}^{n} A_{i}$$  

Similar notations are used for the intersection of an infinite sequence of sets or for the intersection of an arbitrary collection of sets. The infinite intersection is denoted by $\bigcap_{i=1}^{\infty} A_{i}$。  
</Card>
In terms of events, the intersection of a collection of events is the event that every event in the collection occurs.  

对于“并”（或“交”）而言，都具有Associative Property，即运算与次序无关。


3. **互不相容(互斥)事件**：当 $A \cap B = \varnothing$ 时，称事件 $A$ 和 $B$ **互不相容**或**互斥**，  
   {/* ![](Venn diagram of disjoint events)   */}
   当事件 $A$ 和 $B$ 互不相容时，意味着两者不会同时发生。  
   
   例：基本事件是两两互不相容的。


<Card type="Definition" title="Definition 7 (Disjoint/Mutually Exclusive)">
It is said that two sets $A$ and $B$ are mutually exclusive, or disjoint, if $A$ and $B$ have no outcomes in common, that is, if $A \cap B = \varnothing$：  
{/* ![](Venn diagram of disjoint sets)   */}

The sets $A_{1}, A_{2}, ..., A_{n}$ or the sets $A_{1}, A_{2}, ...$ are disjoint if for every $i \neq j$，we have that $A_{i}$ and $A_{j}$ are disjoint, that is, $A_{i} \cap A_{j} = \varnothing$ for all $i \neq j$。The events in an arbitrary collection are disjoint if no two events in the collection have any outcomes in common.  
</Card>
In terms of events, $A$ and $B$ are disjoint if they cannot both occur.


4. **逆事件(对立事件)**：$A$ 的逆事件记为 $\bar{A}$ 或 $A^{c}$，两者满足  
   $$
   \begin{cases}
   A \cup \bar{A} = S \\
   A \cap \bar{A} = \varnothing
   \end{cases}
   $$  
   若 $A \cup B = S$ 且 $A \cap B = \varnothing$，则称 $A$、$B$ 互逆（或互为对立事件），  
   {/* ![](Venn diagram of complement event)   */}
   每次试验，$A$ 与 $\bar{A}$ 必有一个发生，且只有一个发生。  

**注意区分：互斥（互不相容）与互逆（互为对立）事件。**


<Card type="Definition" title="Definition 8 (Complement)">
The complement of a set $A$ is defined to be the set that contains all elements of the sample space $S$ that do not belong to $A$。The notation for the complement of $A$ is $A^{c}$ or $\bar{A}$：  
</Card>
{/* ![](Venn diagram of complement set)   */}

In terms of events, the event $A^{c}$ is the event that $A$ does not occur.


5. **差事件**：事件 $A$ 对事件 $B$ 的差事件，记为 $A\bar{B}$ 或 $A - B$，  
$$
A\bar{B} = A - B = \{x | x \in A\ and\ x \notin B\}
$$  
$A - B$ is the intersection of $A$ and $\bar{B}$，is the set of all points both in $A$ and $\bar{B}$ (e.g.，red area)：  
{/* ![](Venn diagram of difference event)   */}
$A - B$ 发生，即事件 $A$ 发生，并且 $B$ 不发生。  

**注意区分 $A - B$ 与 $B - A$。**


#### Laws of Set Operations
1. **交换律(Commutative Laws)**：$A \cup B = B \cup A$，$A \cap B = B \cap A$；
2. **结合律(Associative Laws)**：  
$$
A \cup B \cup C = (A \cup B) \cup C = A \cup (B \cup C),\ A \cap B \cap C = (A \cap B) \cap C = A \cap (B \cap C)
$$
3. **分配律(Distributive Laws)**：  
$$
A \cap (B \cup C) = (A \cap B) \cup (A \cap C),\ A \cup (B \cap C) = (A \cup B) \cap (A \cup C)
$$  
{/* ![](Venn diagram of distributive laws 1)  */}
{/* ![](Venn diagram of distributive laws 2) */}
4. **德摩根律(De Morgan’s Laws)**：  
$$
\overline{A \cup B} = \bar{A} \cap \bar{B},\ \overline{A \cap B} = \bar{A} \cup \bar{B}
$$  
$$
\overline{\bigcup_{j=1}^{n} A_{j}} = \bigcap_{j=1}^{n} \bar{A}_{j},\ \overline{\bigcap_{j=1}^{n} A_{j}} = \bigcup_{j=1}^{n} \bar{A}_{j}
$$


<Card type="Example" title="Example 7">
设事件 $A$ 表示“学生甲来听课”，事件 $B$ 表示“学生乙来听课”，则：
- $A \cup B = \{甲、乙至少有一人来听课\}$
- $A \cap B = \{甲、乙都来听课\}$
- $\overline{A \cup B} = \bar{A} \cap \bar{B} = \{甲、乙都不来听课\}$
- $\bar{A} \cup \bar{B} = \overline{A \cap B} = \{甲、乙至少有一人不来听课\}$
</Card>

概率中有以下定义：由 $n$ 个元件组成的系统，其中一个损坏，则系统就损坏，此时这一系统称为“串联系统”；若有一个不损坏，则系统不损坏，此时这一系统称为“并联系统”。

<Card type="Example" title="Example 8">
由 $n$ 个部件组成的系统，记 $A_{i} = \{第i个部件没有损坏\}$，$i=1,2,\cdots,n$，$A = \{系统没有损坏\}$，则：
- 串联系统：$A = \bigcap_{i=1}^{n} A_{i}$；
- 并联系统：$A = \bigcup_{i=1}^{n} A_{i}$。
</Card>

## §1.2 Frequency and Probability
<Card type="Definition" title="Definition 9 (Frequency)">
If event $A$ occurs $n_{A}$ times in $n$ repeated experiments under a certain condition, then the frequency of $A$ occurring in $n$ experiments is defined as  
$$
f_{n}(A) = \frac{n_{A}}{n}
$$
</Card>

<Card type="Example" title="Example 9">
中国男子国家足球队，“冲出亚洲”共进行了 $n$ 次，其中成功了一次，在这 $n$ 次试验中“冲出亚洲”这事件发生的频率为 $\frac{1}{n}$。
</Card>

<Card type="Example" title="Example 10">
2000年悉尼奥运会开幕前，气象学家对两个开幕候选日“9月10日”和“9月15日”的100年气象学资料分析发现，“9月10日”的下雨天数为86天，“9月15日”的下雨天数为22天。即“9月10日”和“9月15日”的下雨频率分别为86%和22%，因此最后决定开幕日定为“9月15日”。
</Card>

频率 $f_{n}(A)$ 反映了事件 $A$ 发生的频繁程度。


### Properties of frequency
- $0 \leq f_{n}(A) \leq 1$；
- $f_{n}(S) = 1$；
- The sets $A_{1}, A_{2}, ..., A_{k}$ are disjoint if for every $i \neq j$（$i,j=1,2,...,k$），then  
$$
f_{n}\left(\bigcup_{j=1}^{k} A_{j}\right) = \sum_{j=1}^{k} f_{n}(A_{j})
$$


<Card type="Example" title="Example 11 (Tossing a Coin)">
Suppose that a coin is tossed once. Let $H = \{head\}$。

| No. | $n_H$ (n=5) | $f_n(H)$ (n=5) | $n_H$ (n=50) | $f_n(H)$ (n=50) | $n_H$ (n=500) | $f_n(H)$ (n=500) |
| --- | --- | --- | --- | --- | --- | --- |
| 1 | 2 | 0.4 | 22 | 0.44 | 251 | 0.502 |
| 2 | 3 | 0.6 | 25 | 0.50 | 249 | 0.498 |
| 3 | 1 | 0.2 | 21 | 0.42 | 256 | 0.512 |
| 4 | 5 | 1.0 | 25 | 0.50 | 253 | 0.506 |
| 5 | 1 | 0.2 | 24 | 0.48 | 251 | 0.502 |
| 6 | 2 | 0.4 | 21 | 0.42 | 246 | 0.492 |
| 7 | 4 | 0.8 | 18 | 0.36 | 244 | 0.488 |
| 8 | 2 | 0.4 | 24 | 0.48 | 258 | 0.516 |
| 9 | 3 | 0.6 | 27 | 0.54 | 262 | 0.524 |
| 10 | 3 | 0.6 | 31 | 0.62 | 247 | 0.494 |


| 实验者 | n | $n_H$ | $f(H)$ |
| --- | --- | --- | --- |
| 德·摩根 | 2048 | 1061 | 0.5181 |
| 蒲丰 | 4040 | 2048 | 0.5069 |
| K·皮尔逊 | 12000 | 6019 | 0.5016 |
| K·皮尔逊 | 24000 | 12012 | 0.5005 |
</Card>

**频率的重要性质：事件 $A$ 的频率 $f_n(A)$ 随试验次数 $n$ 的增大渐趋稳定。  **

When the times of experiments $n$ is large enough, the frequency turns out to have a kind of stability, i.e. the value of $f_n(A)$ show fluctuations which become progressively weaker as $n$ increase, until ultimately $f_n(A)$ stabilizes to a constant.  

It is very natural to use this limit constant, called probability, to show the possibility that $A$ occurs in a single experiment and it is commonly denoted by $P(A)$ (or $Pr(A)$)。  

Such a definition of probability is said to be a statistical one.


### Probability
<Card type="Definition" title="Definition 10 (概率的统计性定义)">
当试验次数足够大，事件 $A$ 的频率 $f_n(A)$ 的稳定值定义为 $A$ 的概率(probability)，记为 $P(A)$（或 $Pr(A)$）。
</Card>

<Card type="Definition" title="Definition 11 (概率的公理化定义)">

1. （非负性）For every event $A$，$P(A) \geq 0$；
2. （规范性）$P(S) = 1$；
3. （可列可加性）For every infinite sequence of disjoint events $A_1, A_2, ...$，  
$$
P\left(\bigcup_{i=1}^{\infty} A_i\right) = \sum_{i=1}^{\infty} P(A_i)
$$

A probability measure, or simply a probability, on a sample space $S$ is a specification of numbers $P(A)$ for all events $A$ that satisfy Axioms 1, 2, and 3.
</Card>

### Properties of probability
1. $P(\varnothing) = 0$  

<Card type="Proof" title="Proof">
Let $A_i = \varnothing$，$i=1,2,...$，then  
$$
\bigcup_{i=1}^{\infty} A_i = \varnothing,\ A_i A_j = \varnothing,\ i \neq j
$$  
Hence  
$$
P(\varnothing) = P\left(\bigcup_{i=1}^{\infty} A_i\right) = \sum_{i=1}^{\infty} P(A_i) = \sum_{i=1}^{\infty} P(\varnothing)
$$  
By noting $P(\varnothing) \geq 0$，So  
$$
P(\varnothing) = 0
$$
</Card>

2. （有限可加性）For every finite sequence of disjoint events $A_1, A_2, ..., A_n$，i.e.，the sets $A_i$ and $A_j$ are disjoint for every $i \neq j$（$i,j=1,2,...,n$），  
   $$
   P\left(\bigcup_{i=1}^{n} A_i\right) = \sum_{i=1}^{n} P(A_i)
   $$  

<Card type="Proof" title="Proof">
Let $A_{n+k} = \varnothing$，$k=1,2,...$，then  
$$
A_i A_j = \varnothing,\ for\ every\ i \neq j,\ i,j=1,2,...
$$  
Hence  
$$
P\left(\bigcup_{i=1}^{n} A_i\right) = P\left(\bigcup_{i=1}^{\infty} A_i\right) = \sum_{i=1}^{\infty} P(A_i) = \sum_{i=1}^{n} P(A_i) + \sum_{i=n+1}^{\infty} P(A_i) = \sum_{i=1}^{n} P(A_i)
$$
</Card>

3. For every event $A$，$P(\bar{A}) = 1 - P(A)$  

<Card type="Proof" title="Proof">
Since $A$ and $\bar{A}$ are disjoint events and $A \cup \bar{A} = S$。Together with $P(S) = 1$，we get  
$$
P(\bar{A}) = 1 - P(A)
$$
</Card>

4. If $A \subset B$，then $P(B - A) = P(B \cdot \bar{A}) = P(B) - P(A)$ and $P(B) \geq P(A)$。$P(A) \leq P(S) = 1$ is followed.  

<Card type="Proof" title="Proof">
Since $A \subset B$，  
$$
B = B S = B(A \cup \bar{A}) = B A \cup B \bar{A} = A \cup (B \bar{A})
$$  
Noting that $A$ and $(B \bar{A})$ are disjoint，So $P(B) = P(A \cup (B \bar{A})) = P(A) + P(B \bar{A})$。(Note: If $C = D$，then $P(C) = P(D)$)  

Then  
$$
P(B) - P(A) = P(\bar{A} B) = P(B - A)
$$  
By noting $P(B - A) \geq 0$，we get $P(B) \geq P(A)$。
</Card>
Question: For every two events $A$ and $B$，$P(B - A) = P(B \bar{A}) = ?$（Answer: $P(B) - P(A B)$）


5. （概率的加法公式）For every two events $A$ and $B$，  
$$
\color{red}\boxed{P(A \cup B) = P(A) + P(B) - P(A B)}
$$  

<Card type="Proof" title="Proof">
Since $A \cup B = A \cup (B \bar{A})$，together with the disjoint of $A$ and $B \bar{A}$，we have  
$$
P(A \cup B) = P(A) + P(B \bar{A}) = P(A) + P(B) - P(A B)
$$
</Card>

(5’)  For every three events $A, B$ and $C$，  
$$
P(A \cup B \cup C) = P(A) + P(B) + P(C) - P(A B) - P(A C) - P(B C) + P(A B C)
$$


(5”)  For every $n$ events $A_1, A_2, ..., A_n$，  
$$
\begin{aligned}
P\left(\bigcup_{i=1}^{n} A_i\right) = & \sum_{i=1}^{n} P(A_i) - \sum_{1 \leq i < j \leq n} P(A_i A_j) \\
& + \sum_{1 \leq i < j < k \leq n} P(A_i A_j A_k) + ... + (-1)^{n-1} P(A_1 A_2 ... A_n)
\end{aligned}
$$  

“多还少补”

<Card type="Example" title="Question">

1. 若 $P(A) = 0$，可否推出 $A = \varnothing$？  
2. 若 $P(B) = 1$，可否推出 $B = S$？

**Answer**

不能。  

反例：在$[0,1]$中任意地取一数，则 $S = [0,1]$。记 $A = \{取到的数是0.3\} = \{0.3\}$，$B = \bar{A} = [0,0.3) \cup (0.3,1]$，那么  
$$
P(A) = 0,\ 但是\ A \neq \varnothing；
$$  
$$
P(B) = 1,\ 但是\ B \neq S = [0,1]
$$
</Card>

<Card type="Example" title="Example 12">
设甲、乙两人向同一目标进行射击，已知甲击中目标的概率为0.7，乙击中目标的概率为0.6，两人同时击中目标的概率为0.4。求：
1. 目标不被击中的概率；
2. 甲击中目标而乙未击中目标的概率。

**Solution**

设 $A = \{甲击中目标\}$，$B = \{乙击中目标\}$，则  
$$
P(A) = 0.7,\ P(B) = 0.6,\ P(A B) = 0.4
$$  
于是：
1. $\{目标不被击中\} = \bar{A} \cap \bar{B} = \overline{A \cup B}$，因此  
$$
目标不被击中的概率 = P(\overline{A \cup B}) = 1 - P(A) - P(B) + P(A B) = 0.1
$$
2. $\{甲击中目标而乙未击中目标\} = A \cap \bar{B}$，因此  
$$
甲击中目标而乙未击中目标的概率 = P(A \cap \bar{B}) = P(A) - P(A B) = 0.3
$$

转到Example 31.
</Card>

<Card type="Example" title="Example 13">
甲、乙、丙3人去参加某个集会的概率均为0.4，其中至少有两人参加的概率为0.3，三人都参加的概率为0.05，求3人中至少有1人参加的概率。

**Solution**

设 $A, B, C$ 分别表示甲、乙、丙参加，则  
$$
0.3 = P(A B \cup A C \cup B C) = P(A B) + P(A C) + P(B C) - 2 P(A B C)
$$  
可得  
$$
P(A B) + P(A C) + P(B C) = 0.4
$$  
因此  
$$
P(A \cup B \cup C) = P(A) + P(B) + P(C) - P(A B) - P(A C) - P(B C) + P(A B C) = 0.85
$$
</Card>

<Card type="Example" title="Exarcise">
1. 已知 $P(A \cup B) = 0.6$，$P(A) = 0.3$，则 $P(\bar{A} B) = \underline{0.3}$；
2. 已知 $P(A B) = P(\bar{A} \cdot \bar{B})$，$P(A) = p$，则 $P(B) = \underline{1 - p}$；
3. 若已知 $A, B$ 至少有一发生时 $C$ 发生，则下列说法正确的是( )  
   A. $P(A \cup B) = P(C)$  
   B. $P(A \cup B) \leq P(C)$  
   C. $P(A B) = P(C)$  
   D. $P(A \cup B) > P(C)$  

（答案：B）
</Card>


## §1.3 Classical Probability (Simple Sample Space)
<Card type="Definition" title="Definition 12 (古典概型)">
若试验E满足：
- 样本空间S中样本点有限(有限性)；
- 出现每一样本点的概率相等(等可能性)，

则称这种试验为等可能概型(或古典概型)。此时，对于随机事件A，有
$$
P(A)=\frac{A 所包含的样本点数 }{S 中的样本点数 }
$$
</Card>

<Card type="Definition" title="Definition 12 (Classical Probability)">
A sample space S containing n outcomes $s_{1}, ..., s_{n}$ is called a simple sample space if the probability assigned to each of the outcomes $s_{1}, ..., s_{n}$ is $1/n$. If an event A in this simple sample space contains exactly m outcomes, then
$$
P(A)=\frac{m}{n}
$$
</Card>

<Card type="Definition" title="Definition 13 (排列)">
从n个不同元素中，任取k个不同的元素按照一定的顺序排成一列，叫做从n个不同元素中取出k个元素的一个排列；从n个不同元素中取出k个元素的所有排列的个数，叫做从n个不同元素中取出k个元素的排列数，用符号$A_{n}^{k}$ (或$P_{n}^{k}$，$P_{n, k}$)表示。
</Card>

<Card type="Definition" title="Definition 13 (Permutations)">
Suppose that a set has n elements. Suppose that an experiment consists of selecting k of the elements one at a time without replacement. Let each outcome consist of the k elements in the order selected. Each such outcome is called a permutation of n elements taken k at a time. We denote the number of distinct such permutations by the symbol $A_{n}^{k}$ (or $P_{n}^{k}$，$P_{n, k}$)。
</Card>

<Card type="Definition" title="Definition 14 (组合)">
从n个不同元素中，任取k个元素并成一组，叫做从n个不同元素中取出k个元素的一个组合；从n个不同元素中取出k个元素的所有组合的个数，叫做从n个不同元素中取出k个元素的组合数，用符号$C_{n, k}$ (或$\begin{pmatrix}n \\ k\end{pmatrix}$)表示。
</Card>

<Card type="Definition" title="Definition 14 (Combinations)">
Consider a set with n elements. Each subset of size k chosen from this set is called a combination of n elements taken k at a time. We denote the number of distinct such combinations by the symbol $C_{n}^{k}$ (or $C_{n, k}$，$\begin{pmatrix}n \\ k\end{pmatrix}$)。
</Card>

<Card type="Theorem" title="Theorem 1 (Number of Permutations)">
The number of permutations of n elements taken k at a time is
$$
A_{n}^{k}=\frac{n !}{(n-k) !}=n(n-1) \cdots(n-k+1)
$$
</Card>

<Card type="Theorem" title="Theorem 2 (Combinations)">
The number of distinct subsets of size k that can be chosen from a set of size n is
$$
C_{n}^{k}=\frac{A_{n}^{k}}{k !}=\frac{n !}{k !(n-k) !}
$$
</Card>

<Card type="Example" title="Example 14">
一袋中有8个球，其中3个为红球，5个为黄球，设摸到每一球的可能性相等。
1. 从袋中随机摸一球，记$A = \{摸到红球\}$，求$P(A)$
2. 从袋中不放回摸两球，记$B = \{摸到两球颜色不同\}$，求$P(B)$

**Solution**

将球进行编号1-8，其中1，2，3为红球，则$S=\{1,2,...,8\}$，$A=\{1,2,3\}$，所以
$$
P(A)=\frac{\# A}{\# S}=\frac{3}{8}
$$

$$
P(B)=\frac{C_{3}^{1} C_{5}^{1}}{C_{8}^{2}}=\frac{15}{28} \approx 53.6\%
$$
</Card>

<Card type="Example" title="Example 15">
有N件产品，其中D件是次品，从中不放回地取n件，记$A_{k}=\{恰有k件次品\}$，$k=0,1,...,n$，求$P(A_{k})$（$D \leq N$，$n \leq N$）。

**Solution**

$$
P\left(A_{k}\right)=\frac{C_{D}^{k} C_{N-D}^{n-k}}{C_{N}^{n}}, k=0,1, ..., n
$$
注：当$L>m$或$L<0$时，规定$C_{m}^{L}=0$
</Card>

<Card type="Example" title="Example 16">
将n个不同的球，投入N个不同的盒中（$n \leq N$），设每一球落入各盒的概率相同，且各盒可放的球数不限，记$A = \{恰有n个盒子各有一球\}$，求$P(A)$

**Solution**

将n个球放入N个盒子中，总样本点为$N^{n}$，使A发生的样本点数为$C_{N}^{n} \cdot n!$，于是
$$
P(A)=\frac{C_{N}^{n} \cdot n !}{N^{n}}
$$
</Card>

<Card type="Example" title="Example 17 (生日问题)">
在一个$n(≤365)$人的班级里，至少有两人生日相同的概率是多少？

**Solution**

记$B=\{至少两人生日相同\}$，则
$$
P(B)=1-\frac{C_{365}^{n} \cdot n !}{365^{n}}=1-\frac{A_{365}^{n}}{365^{n}}
$$

当$n=64$时，此概率$p=0.997$
</Card>

<Card type="Example" title="Example 18 (抽签问题)">
一袋中有a个红球，b个白球，记$a+b=n$。有n个人一人一次不放回地进行摸球，设每人每次摸到各球的概率相等，求第k个人摸到红球的概率$P(A_{k})$，其中$A_{k}=\{第k个人摸到红球\}$，$k=1,2,...,n$。

**Solution**
 (方法1)
可设想将n个球进行编号，其中前a号球为红球，将n个人也进行编号。视人、球对应的任意一种情况，即$1~n$的任一排列，为一个样本点，则每点出现的概率相等。因此，第k个人摸到红球的概率
$$
P\left(A_{k}\right)=\frac{a(n-1) !}{n !}=\frac{a}{n}=\frac{a}{a+b}, k=1,2, ..., n
$$
注意到该结果与k无关。

**Solution**
 (方法2)
视哪几人摸到红球为一样本点，则总样本点数为$C_{n}^{a}$，每点出现的概率相等。而$A_{k}$中有$C_{n-1}^{a-1}$个样本点，所以
$$
P\left(A_{k}\right)=\frac{C_{n-1}^{a-1}}{C_{n}^{a}}=\frac{a}{n}=\frac{a}{a+b}
$$

**Solution**
 (方法3)
将第k个人摸到的球号作为一个样本点，则$S=\{1,2,...,n\}$，$A_{k}=\{1,2,...,a\}$，所以
$$
P\left(A_{k}\right)=\frac{a}{n}=\frac{a}{a+b}
$$
</Card>

### 思考
记第k个人摸到的球的颜色为一样本点，则$S = \{红色, 白色\}$，$A_{k}=\{红色\}$，所以
$$
P\left(A_{k}\right)=\frac{1}{2}
$$

此值不仅与k无关，而且与a，b都无关。
此法正确吗？为什么？
可以思考一种特殊情形，当$a=0$，$b=2$。
此法有问题，当$a \neq b$时，这样取不满足等可能概型。

一袋中有a个红球，b个白球，记$a+b=n$。有n个人一人一次不放回地进行摸球，设每人每次摸到各球的概率相等，求第k个人摸到红球的概率$P(A_{k})$，其中$A_{k}=\{第k个人摸到红球\}$，$k=1,2,...,n$。
之前已解得$P(A_{k})=\frac{a}{n}$，$k=1,2,...,n$。请问$P(A_{2}|A_{1}) = ?$，$P(A_{2}|\bar{A}_{1}) = ?$

## §1.4 Conditional Probability
A major use of probability in statistical inference is the updating of probabilities when certain events are observed.
The updated probability of event A after we learn that event B has occurred is the conditional probability of A given B 
$$
P(A | B)
$$

<Card type="Example" title="Example 20 (Rolling a Dice)">
When a six-sided dice is rolled, the sample space can be regarded as containing the six numbers 1, 2, 3, 4, 5, 6, each representing a possible side of the dice that shows after the roll. Symbolically, we write
$$
S=\{1,2,3,4,5,6\}
$$

One event A is that a small number is obtained, and it can be represented as the subset $A=\{1,2,3\}$. The event B that an odd number is obtained is defined by the subset $B=\{1,3,5\}$. Please calculate the probability of the event A and the conditional probability of A given B.
</Card>

<Card type="Example" title="Example 20 (Rolling a Dice) - 续">
**Solution**

易见$P(A)=\frac{\sharp A}{\sharp S}=\frac{3}{6}=\frac{1}{2}$。若事件B已发生，此时试验的所有可能结果只有三种：1或3或5。在这一前提下，事件A发生只有两种情况：1或3出现，所以在事件B发生的条件下，事件A发生的条件概率为$\frac{2}{3}$，记为
$$
P(A | B)=\frac{2}{3} \neq P(A)
$$
其原因在于事件B的发生改变了样本空间，使它由原来的S缩小为$S_{B}=B$，而$P(A | B)$是在新的样本空间$S_{B}$下，对于事件A的概率度量，其本质是在新的样本空间$S_{B}$下，对于事件$A B$的概率度量。
</Card>

### 分析
若记$P(A | B)=x$，则应有$P(A B): P(B)=x: 1$，则有
$$
x=\frac{P(A B)}{P(B)}
$$

<Card type="Definition" title="Definition 15 (条件概率)">
如果$P(B) \neq 0$，那么在事件B发生的条件下，事件A发生的条件概率为
$$
P(A | B)=\frac{P(A B)}{P(B)}
$$
</Card>

<Card type="Definition" title="Definition 15 (Conditional Probability)">
If $P(B) \neq 0$, then the conditional probability that A occurs given that B occurs is defined to be
$$
P(A | B)=\frac{P(A B)}{P(B)}
$$
</Card>

注意区别于$P(A B)$

事实上，条件概率$P(\cdot | B)$也是一种概率，它满足概率的定义和性质，如：
- 非负性：$P(A | B) \geq 0$
- 规范性：$P(S | B)=1$
- 可列可加性：若$A_{1}, A_{2}, ..., A_{k}, ...$两两互斥，则$P(\cup _{i=1}^{\infty} A_{i} | B)=\sum_{i=1}^{\infty} P(A_{i} | B)$
- $P(\overline{A} | B)=1-P(A | B)$
- 加法公式：$P(A \cup C | B)=P(A | B)+P(C | B)-P(A \cap C | B)$
- 若$A \supset C$，则有$P(A | B) \geq P(C | B)$

注：
1. 当$B \neq D$时，$P(A | B)+P(C | D)$无意义；
2. $A | B$不表示事件，此记号无含义；
3. 由$P(A | B)$的含义，可将$P(A)$记为$P(A | S)$，只是S常常省略而已，因此$P(A)$也可以视为条件概率。

<Card type="Example" title="Example 21">
有一批产品，其合格率为90%，合格品中有95%是优质品，从中任取一件，记
$$
A=\{取到一件合格品\}, B=\{取到一件优质品\}
$$
则
$$
P(A)=90\%, P(B | A)=95\%
$$
且可得
$$
P(B)=P(A B)=P(A) \cdot P(B | A)=85.5\%
$$
</Card>

### 乘法公式(Multiplication Formula)
当下面的条件概率都有意义时，有：
- $P(A B)=P(A) \cdot P(B | A)=P(B) \cdot P(A | B)$
- $P(A B C)=P(A) \cdot P(B | A) \cdot P(C | A B)$
- $P\left(A_{1} A_{2} \cdots A_{n}\right)=P\left(A_{1}\right) P\left(A_{2} | A_{1}\right) P\left(A_{3} | A_{1} A_{2}\right) \cdots P\left(A_{n} | A_{1} \cdots A_{n-1}\right), n \geq 2$

<Card type="Example" title="Example 22">
某厂生产的产品能直接出厂的概率为70%，余下30%的产品要调试后再定，已知调试后有80%的产品可以出厂，20%的产品要报废。求该厂产品的报废率。

**Solution**

设$A=\{生产的产品要报废\}$，$B=\{生产的产品要调试\}$，则由题意知$P(B)=0.3$，$P(A | B)=0.2$。由于$A \subset B$，所以$A=A B$，因此
$$
P(A)=P(A B)=P(B) \cdot P(A | B)=0.2  \times  0.3=0.06
$$
</Card>

<Card type="Example" title="Example 23">
每人最多参加3次。某人第一次参加能通过的概率为60%，如果第一次未通过就去参加第二次，这时能通过的概率为80%，如果第二次再未通过，则去参加第三次，此时能通过的概率为90%。求这人能通过考核的概率。

**Solution**

设$A_{i}=\{这人第i次通过考核\}$，$i=1,2,3$，$A = \{这人能通过考核\}$。则由题意知，$P(A_{1})=0.6$，$P(A_{2} | \bar{A}_{1})=0.8$，$P(A_{3} | \bar{A}_{1} \bar{A}_{2})=0.9$，而$A=A_{1} \cup \bar{A}_{1}A_{2} \cup \bar{A}_{1}\bar{A}_{2}A_{3}$，因此
$$

\begin{aligned} 
P(A)&= P\left(A_{1}\right)+P\left(\overline{A}_{1} A_{2}\right)+P\left(\overline{A}_{1} \overline{A}_{2} A_{3}\right) \quad (利用有限可加性) \\ 
&= P\left(A_{1}\right)+P\left(\overline{A}_{1}\right) P\left(A_{2} | \overline{A}_{1}\right)+P\left(\overline{A}_{1}\right) P\left(\overline{A}_{2} | \overline{A}_{1}\right) P\left(A_{3} | \overline{A}_{1} \overline{A}_{2}\right) \\
&\quad (其中 P\left(\overline{A}_{2} | \overline{A}_{1}\right)=1-P\left(A_{2} | \overline{A}_{1}\right)=1-0.8=0.2) \\ 
&= 0.6+0.4  \times  0.8+0.4  \times  0.2  \times  0.9=0.992 
\end{aligned}

$$
</Card>

<Card type="Example" title="Example 23 - 续">
**Solution**
 (Cont.)
也可以通过考虑逆事件的概率来求解：
$$

\begin{aligned} 
P(A) &=1-P(\overline{A}) \\ 
&=1-P\left(\overline{A}_{1} \overline{A}_{2} \overline{A}_{3}\right) \\ 
&=1-P\left(\overline{A}_{1}\right) P\left(\overline{A}_{2} | \overline{A}_{1}\right) P\left(\overline{A}_{3} | \overline{A}_{1} \overline{A}_{2}\right) \\ 
&=1-0.4  \times  0.2  \times  0.1=0.992 
\end{aligned}

$$
</Card>

<Card type="Example" title="Example 24">
已知$P(A)=1 / 4$，$P(B | A)=1 / 3$，$P(A | B)=1 / 2$，求$P(\bar{A} | A \cup B)$。

**Solution**

由乘法公式可知
$$
P(A B)=P(A) P(B | A)=1 / 12, P(B)=P(A B) / P(A | B)=1 / 6
$$

可得Venn图如下：
{/* ![](Venn图1) */}
（图中标记：A区域为1/6，A与B交集为1/12，B区域为1/12，S为整个样本空间）
</Card>

<Card type="Example" title="Example 24 - 续">
**Solution**
 (Cont.)
$$
P(\overline{A} | A \cup B)=\frac{P(\overline{A} (A \cup B))}{P(A \cup B)}=\frac{P(\overline{A}B)}{P(A \cup B)}=\frac{1 / 12}{1 / 3}=\frac{1}{4}
$$
或
$$
P(A \cup B)=P(A)+P(B)-P(AB)=\frac{1}{4}+\frac{1}{6}-\frac{1}{12}=\frac{1}{3}
$$
$$
P(\overline{A} | A \cup B)=1-P(A | A \cup B)=1-\frac{P(A)}{P(A \cup B)}=1-\frac{1 / 4}{1 / 3}=\frac{1}{4}
$$

（补充Venn图细节：A区域$\frac{1}{6}$，A与B交集$\frac{1}{12}$，B区域$\frac{1}{12}$，S为整个样本空间）
</Card>

### 全概率公式与Bayes公式
A set of events is jointly or collectively exhaustive if at least one of the events must occur. Another way to describe collectively exhaustive events is that their union must cover all the events within the entire sample space.

<Card type="Definition" title="Definition 16 (完备事件组(划分))">
设S为试验E的样本空间，$B_{1}, B_{2}, ..., B_{n}$为E的一组事件，$n \geq 2$。若满足：
1. 不漏：$\cup_{j=1}^{n}B_{j}=S$
2. 不重：$B_{i} \cap B_{j}=\varnothing$，$i \neq j$，$i,j=1,2,...,n$

则称$B_{1}, B_{2}, ..., B_{n}$为S的划分(partition)，或称为一组完备事件组(collectively exhaustive events)。

Each elementary event belongs to exactly one set in a partition of S.
</Card>

（完备事件组示意图）
{/* ![](完备事件组示意图) */}
（图中标记：S为样本空间，包含$B_1,B_2,...,B_n$多个互不相交的区域，且这些区域的并集为S）

若$B_{1}, B_{2}, ..., B_{n}$为S的一个划分，则$B_{1}, B_{2}, ..., B_{n}$至少有一个发生是必然的，两两同时发生又是不可能的。

<Card type="Theorem" title="Theorem 3 (Law of Total Probability, 全概率公式)">
Let $B_{1}, B_{2}, ..., B_{n}$ be a partition of S such that $P(B_{i})>0$ for all i. Then for any events A in sample space S
$$
P(A)=\sum_{j=1}^{n} P\left(B_{j}\right) P\left(A | B_{j}\right)
$$
</Card>

（全概率公式示意图）
{/* ![](全概率公式示意图) */}
（图中标记：S为样本空间，包含$B_1,B_2,...,B_n$多个互不相交的区域，A与各$B_j$有交集）

<Card type="Theorem" title="Theorem 3 (Law of Total Probability) - Proof">
$$
A=A S=A B_{1} \cup A B_{2} \cup \cdots \cup A B_{n}
$$
This is a disjoint union, so
$$
P(A)=\sum_{j=1}^{n} P\left(A B_{j}\right)=\sum_{j=1}^{n} P\left(B_{j}\right) P\left(A | B_{j}\right)
$$
</Card>

注：运用全概率公式的关键是构造一个合适的划分。最简单的一个划分是B与$\bar{B}$。若记$P(B_{j})=p_{j}$，$P(A | B_{j})=q_{j}$，则全概率公式的示意图为：
{/* ![](全概率公式简化示意图) */}
（图中标记：$B_1$对应$p_1,q_1$；$B_2$对应$p_2,q_2$；...；$B_n$对应$p_n,q_n$，均在样本空间S内）

<Card type="Corollary" title="Corollary 1 (Law of Total Probability for Conditional Probability, 条件概率的全概率公式)">
Futhermore, let $B_{1}, B_{2}, ..., B_{n}$ be a partition of S such that $P(B_{i} C)>0$ for all i, where C is a event in sample space S and $P(C)>0$. Then for any events A in S
$$
P(A | C)=\sum_{j=1}^{n} P\left(A B_{j} | C\right)=\sum_{j=1}^{n} P\left(B_{j} | C\right) \cdot P\left(A | B_{j} C\right)
$$
</Card>

<Card type="Theorem" title="Theorem 4 (Bayes’ Formula, 贝叶斯公式)">
If $B_{1}, B_{2}, \cdots, B_{n}$ is a partition of S, each $B_{i}$ having positive probability, then for any events A such that $P(A)>0$,
$$
P\left(B_{i} | A\right)=\frac{P\left(B_{i}\right) P\left(A | B_{i}\right)}{\sum_{j=1}^{n} P\left(B_{j}\right) P\left(A | B_{j}\right)}
$$
</Card>

<Card type="Theorem" title="Theorem 4 (Bayes’ Formula) - Proof">
By the definition of conditional probability and the law of total probability,
$$
P\left(B_{i} | A\right)=\frac{P\left(A B_{i}\right)}{P(A)}=\frac{P\left(B_{i}\right) P\left(A | B_{i}\right)}{\sum_{j=1}^{n} P\left(B_{j}\right) P\left(A | B_{j}\right)}
$$
</Card>

<Card type="Example" title="Example 25">
一单位有甲、乙两人，其中甲近期出差的概率为70%。已知若甲出差，则乙出差的概率为10%；若甲不出差，则乙出差的概率为60%。
1. 求近期乙出差的概率
2. 若已知乙近期出差在外，求甲出差的概率

**Solution**

设$A=\{甲出差\}$，$B=\{乙出差\}$，则$P(A)=0.7$，$P(\bar{A})=0.3$，$P(B | A)=0.1$，$P(B | \bar{A})=0.6$。于是：
1. 由全概率公式
$$
P(B)=P(A) P(B | A)+P(\bar{A}) P(B | \bar{A})=0.7 \times 0.1 + 0.3 \times 0.6 = 0.25
$$
2. 由Bayes公式
$$
P(A | B)=\frac{P(A) P(B | A)}{P(B)}=\frac{0.7 \times 0.1}{0.25}=0.28
$$
</Card>

<Card type="Example" title="Example 26">
有三个箱子，第1箱装有3个白球和5个红球，第2箱装有2个白球和2个红球，第3箱装有5个白球和2个红球。现从3个箱子中任挑出一个，然后从该箱子中随机地取两次，每次取一球，作不放回抽样。
1. 求第一次取到的是白球的概率。
2. 已知第一次取到的是白球，求取到的是第1箱的概率。
3. 已知第一次取到的是白球，求第二次取到的还是白球的概率。

**Solution**

设$A_{i}=\{取到第i箱\}$，$i=1,2,3$，则$P(A_{i})=1 / 3$。设$B_{j}=\{第j次取到白球\}$，$j=1,2$，则
$$
P\left(B_{1} | A_{1}\right)=\frac{3}{8}, P\left(B_{1} | A_{2}\right)=\frac{1}{2}, P\left(B_{1} | A_{3}\right)=\frac{5}{7}
$$
</Card>

<Card type="Example" title="Example 26 - 续">
**Solution**
 (Cont.)
1. 由全概率公式
$$
P\left(B_{1}\right)=\sum_{i=1}^{3} P\left(A_{i}\right) P\left(B_{1} | A_{i}\right)=\frac{1}{3} \times\left(\frac{3}{8}+\frac{1}{2}+\frac{5}{7}\right)=\frac{89}{168}
$$

2. 由Bayes公式
$$
P\left(A_{1} | B_{1}\right)=\frac{P\left(A_{1}\right) P\left(B_{1} | A_{1}\right)}{P\left(B_{1}\right)}=\frac{1 / 3  \times  3 / 8}{89 / 168}=\frac{21}{89}
$$
</Card>

<Card type="Example" title="Example 26 - 续">
**Solution**
 (Cont.)
3. 由于
$$
P\left(B_{1} B_{2}\right)=\sum_{i=1}^{3} P\left(A_{i}\right) P\left(B_{1} B_{2} | A_{i}\right)=\frac{1}{3} \times\left(\frac{C_{3}^{2}}{C_{8}^{2}}+\frac{C_{2}^{2}}{C_{4}^{2}}+\frac{C_{5}^{2}}{C_{7}^{2}}\right)=\frac{1}{4}
$$
因此
$$
P\left(B_{2} | B_{1}\right)=\frac{P\left(B_{1} B_{2}\right)}{P\left(B_{1}\right)}=\frac{1 / 4}{89 / 168}=\frac{42}{89}
$$
</Card>

### Bayes公式：已知“结果”，求“原因”
<Card type="Example" title="Example 27">
某人从甲地到乙地，乘飞机、火车、汽车迟到的概率分别为0.1、0.2、0.3，他等可能地选择这三种交通工具。若已知他最后迟到了，求他分别是乘飞机、火车、汽车的概率。

### 分析
设$B_1=\{乘飞机\}$，$B_2=\{乘火车\}$，$B_3=\{乘汽车\}$，$A=\{迟到\}$，则$P(B_1)=P(B_2)=P(B_3)=\frac{1}{3}$，$P(A|B_1)=0.1$，$P(A|B_2)=0.2$，$P(A|B_3)=0.3$。

由Bayes公式：
$$
P(B_1|A)=\frac{P(B_1)P(A|B_1)}{\sum_{j=1}^3P(B_j)P(A|B_j)}=\frac{\frac{1}{3} \times 0.1}{\frac{1}{3} \times (0.1+0.2+0.3)}=\frac{1}{6}
$$
$$
P(B_2|A)=\frac{\frac{1}{3} \times 0.2}{\frac{1}{3} \times 0.6}=\frac{2}{6}
$$
$$
P(B_3|A)=\frac{\frac{1}{3} \times 0.3}{\frac{1}{3} \times 0.6}=\frac{3}{6}
$$
</Card>

Bayes公式：在观察到事件A发生后，对事件$B_{i}$的概率（先验概率）进行更新，得到$P(B_{i} | A)$（后验概率）。

<Card type="Example" title="Example 28 (Monty Hall Problem: Goats and Cars)">
Suppose you’re on a game show, and you’re given the choice of three doors. One door hides a car, two hide goats. Suppose that you pick Door 1. The host, who knows what is behind the doors, opens a door (Door 3) with a goat behind it.

（三门问题示意图）
{/* ![](三门问题示意图) */}
（图中标记：Door1、Door2、Door3，其中Door1为参与者初始选择，Door3已打开且后面是山羊）

Now the host asks you: Do you want to switch your original choice?
What is the best strategy for winning a car?
(a) Switch (b) Don't switch (c) It doesn't matter
</Card>

## §1.5 Independence
<Card type="Example" title="Example 29">
有10件产品，其中8件为正品，2件为次品。从中取2件，每次取1件，设$A_i = \{第i次取到正品\}$，$i=1,2$。
- 不放回抽样时：$P(A_{2} | A_{1})=\frac{7}{9} ≠P(A_{2})=\frac{8}{10}$
- 有放回抽样时：$P(A_{2} | A_{1})=\frac{8}{10}=P(A_{2} | \bar{A}_{1})=P(A_{2})=\frac{8}{10}$

在有放回抽样时，$A_{1}$的发生与否对$A_{2}$的概率没有影响，同样，$A_{2}$的发生对$A_{1}$的概率也不影响。此时有$P(\overline{A_{1}} A_{2})=P(\overline{A_{1}}) \cdot P(A_{2})$
</Card>

### Independent
In general, the occurrence of some event B changes the probability that another event A occurs, the original probability P being replaced by $P(A | B)$. If the probability remains unchanged, that is to say $P(A | B)=P(A)$, then we call A and B ‘independent’. This is well defined only if $P(B)>0$. Definition of conditional probability leads us to the following.

<Card type="Definition" title="Definition 17 (两事件相互独立)">
设A，B为两随机事件，如果$P(A B)=P(A) P(B)$，则称A，B相互独立。

若$P(A) > 0$，则
$$
P(A B)=P(A) P(B) \Leftrightarrow P(B)=P(B | A)=P(B | \overline{A})
$$

若$P(A) ≠0$，$P(B) ≠0$，则
$$
P(A B)=P(A) P(B) \Leftrightarrow P(B | A)=P(B) \Leftrightarrow P(A | B)=P(A)
$$
</Card>

<Card type="Proposition" title="Proposition 1">
设A，B为两随机事件，则A，B相互独立$\Leftrightarrow \bar{A}$，B相互独立$\Leftrightarrow A$，$\bar{B}$相互独立$\Leftrightarrow \bar{A}$，$\bar{B}$相互独立。

### Proof
Without the loss of generality, give a proof of the first equivalence below.
A，B相互独立$\Leftrightarrow P(AB) = P(A)P(B)$
$$

\Leftrightarrow P(B)-P(A B)=P(B)-P(A) P(B)

$$
$$

\Leftrightarrow P(B-A B)=P(B)[1-P(A)]

$$
$$

\Leftrightarrow P(\overline{A} B)=P(\overline{A}) P(B)

$$
即$\bar{A}$，B相互独立。
</Card>

### Notes
注意区分“独立(independent)”和“互斥(exclusive)”。
- 当$P(A) P(B) ≠0$（即$P(A)>0$且$P(B)>0$）时，“A，B相互独立”与“A，B互不相容”不会同时成立。
  - 当$P(A) P(B) ≠0$时，若“A，B相互独立”，则有$P(A B)=P(A) P(B) ≠ 0$，故可知$A B ≠\phi$；
  - 另一方面，当$P(A) P(B) ≠0$时，若“A，B互不相容”，则有$0=P(\phi)=P(A B) ≠ P(A) P(B)$，因此A，B不相互独立。

<Card type="Definition" title="Definition 18 (多事件相互独立)">
设$A_{1}, A_{2}, ..., A_{n}$为n个随机事件，$n ≥2$。若对$2 ≤k ≤n$均有
$$
P\left(A_{i_{1}} A_{i_{2}} \cdots A_{i_{k}}\right)=\prod_{j=1}^{k} P\left(A_{i_{j}}\right)
$$
则称$A_{1}, A_{2}, ..., A_{n}$相互独立。
</Card>

### Notes
- 对$n ≥3$个事件，两两独立不蕴含（⇏）相互独立。
- 对$n ≥3$个事件，n个事件相互独立可推出（⇒）两两独立。

<Card type="Example" title="Example 30">
有一个正四面体，四个面分别涂有红、黄、蓝三色（其中一个面涂两种颜色？原文表述为“三色”，结合后续解答推测四个面的颜色情况为：面1（红）、面2（黄）、面3（蓝）、面4（红、黄、蓝））。现在任取一面，考察该面的颜色情况。令$A_{1}=\{这面含红色\}$，$A_{2}=\{这面含黄色\}$，$A_{3}=\{这面含蓝色\}$。问$A_{1}$，$A_{2}$，$A_{3}$三个事件是否相互独立？是否两两独立？

**Solution**

对这四面分别编号为1，2，3，4，现在任取一面，该面的颜色情况为一样本点，则$S={1,2,3,4}$，$A_{1}={1,4}$，$A_{2}={2,4}$，$A_{3}={3,4}$，$A_{1} A_{2}=A_{1} A_{3}=A_{2} A_{3}=A_{1} A_{2} A_{3}={4}$，因此：
$$
P(A_{1})=P(A_{2})=P(A_{3})=\frac{1}{2}
$$
$$
P(A_{1} A_{2})=P(A_{1} A_{3})=P(A_{2} A_{3})=P(A_{1} A_{2} A_{3})=\frac{1}{4}
$$

注意到$P(A_iA_j) = P(A_i)P(A_j)$，$\forall i ≠j$（$i,j = 1,2,3$）；但$P(A_{1} A_{2} A_{3}) ≠P(A_{1}) P(A_{2}) P(A_{3})$，所以$A_{1}$，$A_{2}$，$A_{3}$三个事件两两独立但不相互独立。
</Card>

### 独立试验
试验结果互不影响的一系列试验。

### 重复试验
在相同条件下进行的试验。

实际问题中，常常不是用定义去验证事件的独立性，而是由实际情形来判断其独立性。

<Card type="Example" title="Example 31">
甲、乙两人同时向一目标射击，甲击中率为0.8，乙击中率为0.7，求目标被击中的概率。

**Solution**

设$A={甲击中}$，$B={乙击中}$，$C={目标被击中}$，则$C=A \cup B$
$$
P(C)=P(A)+P(B)-P(A B)
$$

由于甲、乙同时射击，其结果互不影响，所以A，B相互独立，因此
$$
P(C)=0.8+0.7-0.8  \times  0.7=0.94
$$

与Example 12做比较。
</Card>

<Card type="Example" title="Example 32">
甲、乙两人进行乒乓球比赛，每局甲胜的概率为p。试问对甲而言，采用三局二胜制有利，还是采用五局三胜制有利？（设各局胜负相互独立。）

**Solution**

设$A_i = \{第i局甲胜\}$，则$P(A_{i})=p$，$i=1,2,...,5$。再设$A={甲胜}$。

1. 若采用三局二胜制：
$$
P(A)=P\left(A_{1} A_{2} \cup A_{1} \overline{A}_{2} A_{3} \cup \overline{A}_{1} A_{2} A_{3}\right)=p^{2}+2 p^{2}(1-p) \stackrel{记为}{=} p_{1}
$$

2. 若采用五局三胜制：
$$
P(A) = P\left(A_1A_2A_3 \cup (\text{前三次有一次输})A_4 \cup (\text{前四次有两次输})A_5\right) = p^3 + C_3^1(1-p)p^3 + C_4^2(1-p)^2p^3 \stackrel{记为}{=} p_2
$$

于是
$$

\begin{aligned} 
p_{2}-p_{1}&=p^{3}\left[1+3(1-p)+6(1-p)^{2}\right]-p^{2}\left[1+2(1-p)\right] \\ 
&=3p^{2}(p-1)^{2}(2p-1)
\end{aligned}

$$

因此：
- 当$p>\frac{1}{2}$时，$p_2 - p_1 > 0$，五局三胜制对甲有利；
- 当$p<\frac{1}{2}$时，$p_2 - p_1 < 0$，三局二胜制对甲有利；
- 当$p=\frac{1}{2}$时，$p_2 - p_1 = 0$，两种赛制对甲利害情况相同。
</Card>

<Card type="Example" title="Example 33">
有5个独立元件构成的系统（如图所示），设每个元件能正常运行的概率为p（$0<p<1$），求系统正常运行的概率。

（系统结构示意图）
{/* ![](系统结构示意图1) */}
（图中标记：元件1和2并联，元件4和5并联，然后这两个并联组与元件3串联）

**Solution**

设$A_{i}=\{第i个元件正常运行\}$，$i=1,2,3,4,5$，再设$A=\{系统正常运行\}$，则
$$
A=A A_{3} \cup A \overline{A}_{3}
$$

当元件3正常运行时，系统可以简化为如下图所示：

（简化系统示意图1）
{/* ![](简化系统示意图1) */}
（图中标记：元件1和2并联，元件4和5并联，两个并联组串联）

此时有
$$

\begin{aligned} 
P\left(A | A_{3}\right) &=P\left(\left(A_{1} \cup A_{4}\right) \cap\left(A_{2} \cup A_{5}\right)\right) \\ 
&=P\left(A_{1} \cup A_{4}\right) \cdot P\left(A_{2} \cup A_{5}\right) \quad (\text{因各元件独立}) \\ 
&=\left(2 p-p^{2}\right)^{2}
\end{aligned}

$$

当元件3不正常运行时，系统可以简化为如下图所示：

（简化系统示意图2）
{/* ![](简化系统示意图2) */}
（图中标记：元件1和2串联，元件4和5串联，两个串联组并联）

此时有
$$
P\left(A | \overline{A}_{3}\right)=P\left(A_{1} A_{2} \cup A_{4} A_{5}\right)=2 p^{2}-p^{4}
$$

因此
$$

\begin{aligned} 
P(A) &=P\left(A A_{3} \cup A \overline{A}_{3}\right)=P\left(A_{3}\right) P\left(A | A_{3}\right)+P\left(\overline{A}_{3}\right) P\left(A | \overline{A}_{3}\right) \\ 
&=p\left(2 p-p^{2}\right)^{2}+(1-p)\left(2 p^{2}-p^{4}\right)=2 p^{2}+2 p^{3}-5 p^{4}+2 p^{5}
\end{aligned}

$$

问：$P\left(A_{1} A_{2} A_{3} \cup A_{3} A_{4} A_{5}\right)= ?$
</Card>

<Card type="Example" title="Example 34">
一袋中有编号为1,2,3,4共4个球，采用放回抽样，每次取一球，共取2次，记录号码之和，这样独立重复进行试验。求“和等于3”出现在“和等于5”之前的概率。

**Solution**

设A表示“‘和等于3’出现在‘和等于5’之前”，B表示“第一次号码之和为3”，C表示“第一次号码之和为5”，D表示“第一次号码之和既不为3也不为5”。于是

所有可能的号码组合（放回抽样，两次取球）共$4 \times 4=16$种：
- 和为3的组合：(1,2)、(2,1)，共2种，故$P(B)=\frac{2}{16}$；
- 和为5的组合：(1,4)、(2,3)、(3,2)、(4,1)，共4种，故$P(C)=\frac{4}{16}$；
- 其余组合（和不为3且不为5）共$16-2-4=10$种，故$P(D)=\frac{10}{16}$。

由全概率公式
$$

\begin{aligned} 
P(A) &=P(B) P(A | B)+P(C) P(A | C)+P(D) P(A | D) \\ 
&=\frac{2}{16}  \times  1+\frac{4}{16}  \times  0+\frac{10}{16}  \times  P(A | D)
\end{aligned}

$$

注意到，在第一次和不等于3或5的情况下，求A的条件概率，相当于重新考虑A的概率，即$P(A | D)=P(A)$。因此可以得到
$$
P(A)=\frac{2}{16} + \frac{10}{16}P(A)
$$
解得$P(A)=\frac{1}{3}$
</Card>

<Card type="Example" title="Example 35">
某技术工人长期进行某项技术操作，他经验丰富，因嫌按规定操作太过繁琐，就按照自己的方法进行，但这样做有可能发生事故。设他每次操作发生事故的概率为p，$p>0$但很小很小。现设他独立重复进行了n次操作，求：
1. n次都不发生事故的概率；
2. 至少有一次发生事故的概率。

**Solution**

设$C_{i}=\{第i次不发生事故\}$，$i=1,...,n$，则$C_{1},...,C_{n}$相互独立，且$P(C_{i})=1-p$。

1. 设$A=\{n次都不发生事故\}$，则
$$
P(A)=P(C_{1} \cap \cdots \cap C_{n})=(1-p)^{n}
$$

2. 设$B = \{至少有一次发生事故\}$，则
$$
P(B)=1-P(A)=1-(1-p)^{n}
$$

当$n \to \infty$时，$\lim _{n \to \infty} P(B)=1$，故“小概率事件”在大量独立重复试验中“至少有一次发生”几乎是必然的。
</Card>

### 条件独立(Conditional Independent)
<Card type="Example" title="Example 36">
一射击场有10支枪，其中7支已校正，3支未校正。某人用已校正的枪射击，命中率为0.8，用未校正的枪射击，命中率为0.4。若他随机地取一支枪，用这支枪独立射击2次。
1. 求他第一枪命中的概率。
2. 求他两枪都命中的概率。
3. 若已知他第一枪命中，求他取到的枪为已校正的枪的概率。

**Solution**

设$A = \{取到的枪为已校正的枪\}$，$B_i = \{第i枪命中\}$，$i=1,2$。则$P(A)=0.7$，$P(\bar{A})=0.3$，$P(B_i|A)=0.8$，$P(B_i|\bar{A})=0.4$（$i=1,2$），且在给定A（或$\bar{A}$）的条件下，$B_1$与$B_2$相互独立。

1. 由全概率公式
$$
P\left(B_{1}\right)=P\left(B_{1} | A\right) P(A)+P\left(B_{1} | \overline{A}\right) P(\overline{A})=0.8  \times  0.7+0.4  \times  0.3=0.68
$$

2. 由全概率公式及条件独立性
$$
P\left(B_{1} B_{2}\right)=P\left(B_{1} B_{2} | A\right) P(A)+P\left(B_{1} B_{2} | \overline{A}\right) P(\overline{A})=0.8^{2}  \times  0.7+0.4^{2}  \times  0.3=0.496
$$

3. 由Bayes公式
$$
P\left(A | B_{1}\right)=\frac{P\left(B_{1} | A\right) P(A)}{P\left(B_{1}\right)}=\frac{0.8  \times  0.7}{0.68}=\frac{14}{17}
$$
</Card>

<Card type="Example" title="Example 37 (疾病诊断)">
某种疾病的诊断试验有5%的假阳性和4%的假阴性，即令$A = \{试验反应是阳性\}$，$B=\{患有此种疾病\}$，则$P(A | \bar{B})=0.05$，$P(\bar{A} | B)=0.04$。已知此病发病率是0.01，即$P(B)=0.01$。
1. 当试验反应是阳性时，求此人患有此种疾病的概率。
2. 为提高准确率，通常会对第一次试验阳性的人再做一次独立的检查。如果这两次都是阳性，求此人患有此种疾病的概率。

**Solution**

1. 由Bayes公式
$$

\begin{aligned} 
P(B | A)&=\frac{P(A | B) P(B)}{P(A | B) P(B)+P(A | \overline{B}) P(\overline{B})} \\ 
&=\frac{(1 - 0.04)  \times  0.01}{(1 - 0.04)  \times  0.01+0.05  \times  (1 - 0.01)} \\ 
&=\frac{0.96  \times  0.01}{0.96  \times  0.01+0.05  \times  0.99}=0.1624
\end{aligned}

$$

2. 令$A_{i}=\{第i次试验阳性\}$，$i=1,2$。由Bayes公式
$$

\begin{aligned} 
P\left(B | A_{1} A_{2}\right) &=\frac{P\left(A_{1} A_{2} | B\right) P(B)}{P\left(A_{1} A_{2} | B\right) P(B)+P\left(A_{1} A_{2} | \overline{B}\right) P(\overline{B})} \\ 
&=\frac{0.96^{2}  \times  0.01}{0.96^{2}  \times  0.01+0.05^{2}  \times  0.99}=0.7883
\end{aligned}

$$
</Card>

谢谢!