# 第1章 概率论的基本概念
概率论是一门研究随机现象数量规律性的学科，它起源于对赌博问题的研究，20世纪苏联数学家柯尔莫哥洛夫建立了在测度论基础上的概率论公理系统后，它才成为一门严格的演绎学科。数理统计学是一门以概率论为基础，集数据收集、加工、分析与解释于一体的学科。

随着人们研究的不断深入，也得益于社会发展的推动，如今概率论与数理统计的理论与方法已经渗透到自然科学、社会科学、工程技术、军事科学等各个领域，并产生了不少新的学科分支，例如：统计物理学、统计热力学、气象统计学、环境统计学、医学统计学、卫生统计学、生物统计学、心理统计学、教育统计学、计量经济学、保险统计学、金融统计学、人口统计学、管理统计学、体育统计学、统计语言学等，不胜枚举。

现实生活中有诸多鲜活的实例都需要用到概率论与数理统计的方法，如设计各种彩票方案；分析设计合理的城市车辆通行方案；研制和使用复杂军事装备；进行航天航空领域系统可靠性分析；在生物遗传学中分析子女身高与父母身高的关系；在天文学中预测天体的未知位置；诊断研究气象情况；在公司新产品上市前，对消费者抽样调查，了解市场前景，进行产品市场分析等。

## 1.1 样本空间、随机事件
自然界和社会生活中存在这样两类现象：一类是在一定条件下必然发生的现象，称为必然现象，如在一个标准大气压下，水加热到100°C一定会沸腾；向上抛一重物，该重物一定会落下。另外一类是在一定条件下有可能发生也有可能不发生的现象，即不是必然发生的，其中的一种是随机现象，随机现象是指具有不止一种可能结果，且在个别试验中无法预知哪个结果会发生，但在大量重复试验中其结果的发生又呈现一定规律性的现象，这种规律性称为统计规律性。例如当一辆汽车按正常操作通过某一地段时，事先无法确切知道会不会发生交通事故，即带有偶然性；但经过大量的观察，发现某一地段发生交通事故比较多，因此就在这一地段的路边立了一块“事故多发地段”的牌子提醒人们注意。概率论与数理统计的研究对象为随机现象，是考察和分析随机现象的统计规律性的数学学科。

### （一）样本空间、随机事件
对随机现象进行观察、记录或试验，称为随机试验（random experiment）。随机试验具有以下特点：
1. 可以在相同的条件下重复进行；
2. 每次试验可能出现的结果是不确定的，但能事先知道试验的所有可能结果；
3. 每次试验完成前不能预知哪一个结果会发生。

在本书中，若无特别说明，以后提到的试验都是指具有上述特点的随机试验。

称随机试验的所有可能结果构成的集合为样本空间（sample space），常用字母S（或Ω）来表示，样本空间S中的每一个元素，即试验的每一个结果称为样本点（sample point）。样本空间的任一子集称为随机事件（random event），简称事件（event），常用字母A，B，C等表示，或用文字描述加大括号{}来明确其含义。特别地，只含有一个样本点的事件称为基本事件（elementary event）。

显然，样本空间和随机事件的本质为集合，因此在概率论与数理统计的研究中常结合集合论的知识来进行分析和讨论。

**例1.1.1** 投掷一枚硬币，观察正反面出现的情况。该试验的可能结果为“正面”或“反面”，即样本空间由两个样本点构成，则对应的样本空间可记为：
\[S=\{正面, 反面\}\]

**例1.1.2** 一位射手向一目标射击5次，观察他的击中次数，该试验的可能结果为“击中0次”“击中1次”……“击中5次”，即有6种可能结果，则对应的样本空间可记为：
\[S=\{0,1,2,3,4,5\}\]
记\(A=\{至多有3次击中\}=\{0,1,2,3\}\subset S\)，\(B=\{击中次数大于4次\}=\{5\}\subset S\)，则A，B均为随机事件。

**例1.1.3** 记录某人的血压值，x为收缩压，y为舒张压（单位：mmHg）。对应的样本空间可取为：
\[S=\{(x,y):0\leq y\leq x\leq 300\}\]
记\(A=\{正常血压\}=\{(x,y):90\leq x<130,60\leq y<85\}\subset S\)，则A是一随机事件。

**例1.1.4** 从15个同类产品（其中12个正品，3个次品）中任取4个产品，观察取得的次品数，对应的样本空间可记为：
\[S=\{0,1,2,3\}\]
记\(A=\{至少有两个正品\}=\{0,1,2\}\)，\(B=\{恰有两个正品\}=\{2\}\)，则A，B均为随机事件。

在一次试验完成时，当试验所出现的结果（即样本点）属于某一事件，即这一事件所包含的一个样本点恰好为此次试验出现的结果时，就称该事件发生，否则就称该事件没有发生（或该事件不发生）。例如，在例1.1.2中，对于事件\(A=\{0,1,2,3\}\)，若在一次试验中，射手的射击结果为“击中1次”，由于\(1\in A\)，即A所包含的一个样本点“1”出现，所以称事件A发生；类似地，若射手的射击结果为“击中2次”，亦称事件A发生。但若射手的射击结果不属于A，如当射手的射击结果为“击中4次”时，由于\(4\notin A\)，所以认为在此次试验中事件A没有发生。

特别地，若将样本空间S亦视为一事件，由于试验的所有可能结果都在S中，故在任何一次试验中，事件S一定会发生，因此也常称S为必然事件（certain event）。与之相对应，空集∅没有任何元素，即在任何试验中所出现的结果都不会属于该集合，因此常称∅为不可能事件（impossible event）。

### （二）事件的相互关系及运算
前面已经了解到事件的本质是集合，因此事件的相互关系及运算可以利用集合论中集合的关系和运算来进行，下面我们将着重结合“事件发生”的含义来给出其在概率论中的具体含义。

假设所考虑的随机试验E的样本空间为S，且下述所提及的事件均为其子集。

#### 1. 事件的包含与相等
（1）包含/包含于：若事件B发生一定导致事件A发生，则称事件B包含于事件A或称事件A包含事件B，亦称事件B为事件A的子事件（subevent），记为\(B\subset A\)或\(A\supset B\)。
（2）相等：若\(B\subset A\)且\(A\subset B\)，则称事件A与事件B相等，记为\(A=B\)。

#### 2. 事件的运算
（1）和事件：称由事件A和事件B的所有样本点构成的集合为A与B的和事件（union of events），记为\(A\cup B\)，即：
\[A\cup B=\{x:x\in A或x\in B\}\]
当且仅当事件A和事件B至少有一个发生时，和事件\(A\cup B\)发生。类似地，记\(\bigcup_{i=1}^{n}A_{i}\)为n个事件\(A_{1},A_{2},\cdots,A_{n}(n\geq2)\)的和事件，记\(\bigcup_{i=1}^{+\infty}A_{i}\)为可列个事件\(A_{1},A_{2},\cdots\)的和事件。

（2）积事件：称由事件A和事件B的共同样本点构成的集合为A与B的积事件（intersection of events），记为\(A\cap B\)，或AB，或\(A\cdot B\)，即：
\[A\cap B=AB=A\cdot B=\{x:x\in A且x\in B\}\]
当且仅当事件A和事件B同时发生时，积事件\(A\cap B\)发生。类似地，记\(\bigcap_{i=1}^{n}A_{i}\)为n个事件\(A_{1},A_{2},\cdots,A_{n}(n\geq2)\)的积事件，记\(\bigcap_{i=1}^{+\infty}A_{i}\)为可列个事件\(A_{1},A_{2},\cdots\)的积事件。

特别地，当积事件\(A\cap B\)为不可能事件，即事件A与事件B不会同时发生时，有如下定义。

**定义1.1.1** 设A，B为两随机事件，当\(A\cap B=\emptyset\)时，称事件A与事件B互不相容（或互斥）（mutually exclusive（disjoint））。

值得一提的是，对于任何随机试验，其对应的样本空间中的基本事件是两两互不相容的。

（3）逆事件（对立事件）：若\(A\cup B=S\)且\(A\cap B=\emptyset\)，则称事件A与事件B互为逆事件或对立事件（complementary events）。常记\(\overline{A}\)或\(A^{c}\)为事件A的逆事件，即：
\[\overline{A}=\{x:x\notin A\}\]
根据逆事件的定义，在一次试验中，A与\(\overline{A}\)至少有一个发生是必然的，但一定不会同时发生，只能发生其中之一，即样本空间被划分为A与\(\overline{A}\)两个互不相容的子集。

（4）差事件：称由事件A和事件\(\overline{B}\)的共同样本点构成的集合为A对B的差事件（difference of events），记为\(A-B\)或\(A\cap\overline{B}\)，即：
\[A-B=A\cap\overline{B}=\{x:x\in A且x\notin B\}\]
当且仅当事件A发生且事件B不发生时，A对B的差事件\(A-B\)发生。

我们可以借助维恩图来表示以上事件的关系和运算。

和事件、积事件与逆事件具有以下运算规则：
- 交换律：\(A\cup B=B\cup A\)，\(A\cap B=B\cap A\)；
- 结合律：\(A\cup(B\cup C)=(A\cup B)\cup C\)，\(A\cap(B\cap C)=(A\cap B)\cap C\)；
- 分配律：\(A\cap(B\cup C)=(A\cap B)\cup(A\cap C)\)，\((A\cap B)\cup C=(A\cup C)\cap(B\cup C)\)；
- 德摩根定律（De Morgan's law）：\(\overline{\bigcup_{j=1}^{n}A_{j}}=\bigcap_{j=1}^{n}\overline{A}_{j}\)，\(\overline{\bigcap_{j=1}^{n}A_{j}}=\bigcup_{j=1}^{n}\overline{A}_{j}\)，即“n个事件中至少有一个发生”的逆事件为“这n个事件都不发生”，“n个事件都发生”的逆事件为“这n个事件中至少有一个不发生”。

**例1.1.5** 掷一颗骰子一次，观察其点数出现的情况，则样本空间\(S=\{1,2,3,4,5,6\}\)。记\(A_{i}=\{得到的点数为i\}\)，\(i=1,2,\cdots,6\)，并设\(A=\{得到的点数为偶数\}\)，\(B=\{得到的点数为奇数\}\)，\(C=\{得到1点或3点\}\)，则：
\[A=A_{2}\cup A_{4}\cup A_{6}\]
\[B=A_{1}\cup A_{3}\cup A_{5}\]
\[C=A_{1}\cup A_{3}\]
显然，\(B\supset C\)。又\(A\cap C=\emptyset\)，故A与C互不相容。又\(\overline{A}=\overline{A}_{2}\cap\overline{A}_{4}\cap\overline{A}_{6}=B\)，故A与B互为逆事件。

概率论中常有以下定义：由n个元件组成一个系统，若有一个元件损坏，系统就损坏，则称该系统为串联系统；若只要有一个元件不损坏，系统就不损坏，则称该系统为并联系统。例如，一把椅子由4条腿、凳板、靠背共6个部件组成，如果其中一个部件损坏，我们就认为这把椅子坏了，那么这把椅子就是一个由6个部件组成的串联系统。

**例1.1.6** 由n个元件组成一个系统，设\(A=\{系统不损坏\}\)，\(A_{j}=\{第j个元件不损坏\}\)，\(j=1,2,\cdots,n\)，则：
- 串联系统：\(A=A_{1}\cap A_{2}\cap\cdots\cap A_{n}\)；
- 并联系统：\(A=A_{1}\cup A_{2}\cup\cdots\cup A_{n}\)。

## 1.2 频率与概率
前面已经提到，概率论与数理统计的研究目的是分析随机现象的统计规律性，研究方式是进行随机试验，在随机试验中，除必然事件和不可能事件外，其他事件在某次试验中可能发生也可能不发生，因此在很多情况下需要对随机事件发生的可能性进行定量分析，事件的频率与概率正源于此。

### （一）频率
在相同条件下进行\(n(n\geq1)\)次重复试验，若事件A在这n次重复试验中发生\(n_{A}\)次（称\(n_{A}\)为A在这n次试验中发生的频数，\(0\leq n_{A}\leq n\)），则称比值\(\frac{n_{A}}{n}\)为事件A在这n次试验中发生的频率（frequency），记为\(f_{n}(A)\)，即：
\[f_{n}(A)=\frac{n_{A}}{n}=\frac{A发生的次数}{总的试验次数}\]

由事件频率的定义，易知其具有以下性质：
1. 对任一事件A，\(0\leq f_{n}(A)\leq1\)；
2. \(f_{n}(S)=1\)；
3. 若事件A与B互不相容，即\(A\cap B=\emptyset\)，则\(f_{n}(A\cup B)=f_{n}(A)+f_{n}(B)\)。

性质（3）可以推广至多个两两互不相容的事件，当\(A_{1},A_{2},\cdots,A_{k}(k\geq3)\)两两不相容时：
\[f_{n}\left(\bigcup_{j=1}^{k}A_{j}\right)=\sum_{j=1}^{k}f_{n}(A_{j})\]

事件的频率\(f_{n}(A)\)体现了事件A发生的频繁程度，在一定程度上可以用来表征该事件发生的可能性大小，从其定义可知，事件频率依赖于具体的试验，它不仅与总的试验次数n有关，而且在n固定时，做多组的n次重复试验，各组试验中A发生的次数通常也不会完全相同，也就是各组的频率会有差异。

**例1.2.1（抛硬币试验）** 在相同的条件下将一枚硬币抛n次（读者也不妨一试），设\(A=\{正面朝上\}\)，记录A发生的次数。对于\(n=5\)，\(n=10\)，\(n=50\)，\(n=500\)各进行了10组试验，具体数据记录于表1.2.1。

表1.2.1 抛硬币试验结果1
| 试验序号 | n=5 |  | n=10 |  | n=50 |  | n=500 |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | \(n_{A}\) | \(f_{n}(A)\) | \(n_{A}\) | \(f_{n}(A)\) | \(n_{A}\) | \(f_{n}(A)\) | \(n_{A}\) | \(f_{n}(A)\) |
| 1 | 2 | 0.4 | 4 | 0.4 | 22 | 0.44 | 251 | 0.502 |
| 2 | 3 | 0.6 | 2 | 0.2 | 25 | 0.50 | 249 | 0.498 |
| 3 | 1 | 0.2 | 4 | 0.4 | 21 | 0.42 | 256 | 0.512 |
| 4 | 5 | 1.0 | 3 | 0.3 | 25 | 0.50 | 253 | 0.506 |
| 5 | 0 | 0.0 | 5 | 0.5 | 24 | 0.48 | 251 | 0.502 |
| 6 | 2 | 0.4 | 4 | 0.4 | 21 | 0.42 | 246 | 0.492 |
| 7 | 4 | 0.8 | 5 | 0.5 | 18 | 0.36 | 244 | 0.488 |
| 8 | 2 | 0.4 | 6 | 0.6 | 24 | 0.48 | 258 | 0.516 |
| 9 | 3 | 0.6 | 4 | 0.4 | 27 | 0.54 | 262 | 0.524 |
| 10 | 3 | 0.6 | 6 | 0.6 | 31 | 0.62 | 247 | 0.494 |

从表1.2.1中的数据可见，当n较小时，频率\(f_{n}(A)\)的变化幅度较大，但当总的试验次数n逐渐增加时，频率呈现出某种稳定性，其取值基本聚集在常数\(p=0.5\)附近，历史上也有不少数学家做过类似的试验，其结果见表1.2.2。

表1.2.2 抛硬币试验结果2
| 试验者 | n | \(n_{A}\) | \(f_{n}(A)\) |
| --- | --- | --- | --- |
| 德摩根 | 2048 | 1061 | 0.5181 |
| 蒲丰 | 4040 | 2048 | 0.5069 |
| K.皮尔逊 | 12000 | 6019 | 0.5016 |
| K.皮尔逊 | 24000 | 12012 | 0.5005 |

事件的频率这种随着总的试验次数增加而呈现出的“稳定性”其实就是随机现象统计规律性的体现，这一稳定属性也给了人们一个定量描述事件发生可能性大小的契机，即例子中的稳定常数\(p=0.5\)就可用来反映事件\(A=\{正面朝上\}\)发生的可能性。

### （二）概率
设某一随机试验所对应的样本空间为S，对S中的任一事件A，当总的试验次数n充分大时，A的频率\(f_{n}(A)\)的稳定值p定义为事件A的概率，记为\(P(A)=p\)。上述说法常称为概率的统计性定义。

概率的统计性定义，不仅说明了概率的存在性，也提供了概率的一种近似值的求解方法，即在实际应用中可进行大量试验，利用事件发生的频率来估算事件的概率。但这一定义是描述性的，稳定到什么程度才是概率，并没有一个确切的指标，在实践中难以达到统一，在数学上也不够严谨。1933年，著名数学家柯尔莫哥洛夫不仅注意到概率的直观含义，而且还针对概率是事件的函数这一本质，结合非负性、规范性及可列可加性等特点，提出了概率的公理性定义，其严格的数学定义涉及测度论的范畴，因此本书中仅介绍它的基本含义。

**定义1.2.1** 设某一随机试验所对应的样本空间为S，对S中的任一事件A定义一个实数\(P(A)\)，若它满足以下三条公理：
1. 非负性：\(P(A)\geq0\)；
2. 规范性：\(P(S)=1\)；
3. 可列可加性：对S中的可列个两两互不相容的事件\(A_{1},A_{2},\cdots,A_{n},\cdots\)（即\(A_{i}A_{j}=\emptyset\)，\(i\neq j\)，\(i,j=1,2,\cdots\)），有：
\[P\left(\bigcup_{j=1}^{+\infty}A_{j}\right)=\sum_{j=1}^{+\infty}P(A_{j})\]
则称\(P(A)\)为事件A发生的概率（probability）。

根据概率的公理化定义，可以得到以下性质：
1. 有限可加性：对于有限个两两互不相容的事件的和事件，有：
\[P\left(\bigcup_{j=1}^{n}A_{j}\right)=\sum_{j=1}^{n}P(A_{j})\]
2. \(P(A)=1-P(\overline{A})\)。特别地，\(\emptyset\cup S=S\)，可得\(P(\emptyset)=0\)。
3. 当\(A\supset B\)时，\(P(A-B)=P(A)-P(B)\)，由此可推出\(P(A)\geq P(B)\)。因为当\(A\supset B\)时，\(A=B\cup A\overline{B}\)，有：
\[P(A)=P(B)+P(A\overline{B})=P(B)+P(A-B)\]
所以\(P(A-B)=P(A)-P(B)\)。由于\(P(A-B)\geq0\)，故\(P(A)\geq P(B)\)。注意到任一事件\(A\subset S\)，进而可得\(P(A)\leq P(S)=1\)。
4. 概率的加法公式：
\[P(A\cup B)=P(A)+P(B)-P(AB)\quad(1.2.1)\]
因为\(A=AB\cup A\overline{B}\)，所以\(P(A)=P(AB)+P(A\overline{B})\)，即：
\[P(A\overline{B})=P(A)-P(AB)\]
又\(A\cup B=B\cup A\overline{B}\)，所以：
\[P(A\cup B)=P(B)+P(A\overline{B})=P(A)+P(B)-P(AB)\]

性质（4）可以推广：
\[P(A\cup B\cup C)=P(A)+P(B)+P(C)-P(AB)-P(AC)-P(BC)+P(ABC)\]

**例1.2.2** 甲、乙两人分别从两地出发去火车站搭乘某高铁列车。已知甲、乙能赶上这趟车的概率分别为0.7，0.8，甲、乙都赶上的概率为0.6，求甲、乙都没有赶上的概率。

解：设\(A=\{甲赶上\}\)，\(B=\{乙赶上\}\)。由题意可知：
\[P(A)=0.7\]
\[P(B)=0.8\]
\[P(AB)=0.6\]
所以：
\[
\begin{align*}
P(\{甲、乙都没有赶上\})&=P(\overline{A}\overline{B})\\
&=P(\overline{A\cup B})\\
&=1-P(A\cup B)\\
&=1-[P(A)+P(B)-P(AB)]\\
&=0.1
\end{align*}
\]

**例1.2.3** 设甲、乙、丙三人去参加某个活动的概率均为0.4，且甲、乙、丙中至少有两人去参加的概率为0.3，三人同时参加的概率为0.05，求甲、乙、丙三人至少有一人参加的概率。

解：设\(A=\{甲参加\}\)，\(B=\{乙参加\}\)，\(C=\{丙参加\}\)。由题意知：
\[P(A)=P(B)=P(C)=0.4\]
\[P(AB\cup AC\cup BC)=0.3\]
\[P(ABC)=0.05\]
由概率加法公式得：
\[
\begin{align*}
0.3&=P(AB\cup AC\cup BC)\\
&=P(AB)+P(AC)+P(BC)-2P(ABC)
\end{align*}
\]
故：
\[P(AB)+P(AC)+P(BC)=0.3+2P(ABC)=0.4\]
因此：
\[
\begin{align*}
P(\{甲、乙、丙三人至少有一人参加\})&=P(A\cup B\cup C)\\
&=P(A)+P(B)+P(C)-[P(AB)+P(AC)+P(BC)]+P(ABC)\\
&=0.85
\end{align*}
\]

## 1.3 等可能概型
在某些随机试验中，样本空间中样本点出现的可能性相等，例如抛硬币试验，\(S=\{正面,反面\}\)，由于通常情形下正、反面出现频率非常接近，所以我们常假设出现正面与反面的概率相等。

**定义1.3.1** 一个随机试验，如果满足下面两个条件：
1. 样本空间中样本点数有限（有限性）；
2. 出现每一个样本点的概率相等（等可能性）。

就称这个试验为等可能概型，又称古典概型。

若等可能概型的样本空间为\(S=\{e_{1},e_{2},\cdots,e_{n}\}(n\geq1)\)，则由定义1.3.1知：
\[P(\{e_{j}\})=\frac{1}{n},j=1,2,\cdots,n\]
对随机事件\(A=\{e_{i_{1}},e_{i_{2}},\cdots,e_{i_{l}}\}\)，即\(A=\{e_{i_{1}}\}\cup\{e_{i_{2}}\}\cup\cdots\cup\{e_{i_{l}}\}\)，其中\(i_{1},i_{2},\cdots,i_{l}\)是\(1,2,\cdots,n\)中某\(l(l\geq1)\)个不同的值。由基本事件两两互不相容的性质，知：
\[P(A)=P\left(\bigcup_{j=1}^{l}\{e_{i_{j}}\}\right)=\sum_{j=1}^{l}P(\{e_{i_{j}}\})=\frac{l}{n}\]
这就是说，在等可能概型中，任一事件A的概率为：
\[P(A)=\frac{A所包含的样本点数}{S中样本点总数}\quad(1.3.1)\]

因此在等可能概型中，求随机事件的概率就可以转化为计算样本点数的问题，在实际操作中常会涉及排列组合。

**例1.3.1** 一副扑克牌共52张（去掉两个王），采用下列两种方式抽取两张牌，求抽到的恰好是一红一黑的概率。
1. 无放回抽样：第一次随机抽出1张，无放回，第二次从剩下的牌中再抽1张；
2. 有放回抽样：第一次随机抽出1张，记录颜色后放回，第二次仍从全部的牌中随机抽1张。

解：设\(A=\{两张牌是一红一黑\}\)。

（1）无放回抽样方式：第一次抽样有52种情况，第二次抽样有51种情况，所以样本空间中样本点总数为\(52\times51\)。事件A发生包括“先抽到红牌后抽到黑牌”及“先抽到黑牌后抽到红牌”两种情况，所以事件A所包含的样本点数为\(2\times26\times26\)。于是：
\[P(A)=\frac{2\times26\times26}{52\times51}=\frac{26}{51}\]

注意到事件A与顺序无关，在考虑样本空间时也可以不考虑顺序，即当作一次性抽出2张牌，此时样本空间中样本点总数为\(C_{52}^{2}=\frac{52\times51}{2}\)，事件A所包含的样本点数为\(C_{26}^{1}\times C_{26}^{1}=26\times26\)，与上面的计算结果完全一致。

一般地，如果有a张红牌，b张黑牌，\(a+b=N\)，采用无放回抽样抽取\(n(0<n<N)\)张牌，那么恰好取到\(k(max\{0,n-b\}\leq k\leq min\{a,n\})\)张红牌的概率为\(\frac{C_{a}^{k}C_{b}^{n-k}}{C_{N}^{n}}\)，其中\(C_{N}^{n}=\frac{N!}{n!(N-n)!}\)（\(C_{N}^{n}\)也常记为\(\binom{N}{n}\)）。

（2）有放回抽样方式：第一次和第二次抽样都有52种情况，所以样本空间中样本点总数为\(52\times52\)。事件A所包含的样本点数仍为\(2\times26\times26\)。于是：
\[P(A)=\frac{2\times26\times26}{52\times52}=\frac{1}{2}\]

**例1.3.2（抽签问题）** 袋中有编号为\(1,2,\cdots,n(n>1)\)的n个球，其中有a个红球，b个白球（\(a+b=n\)）。从中每次摸一球，无放回，共摸n次，假设各个球的大小和材质相同，求第\(k(1\leq k\leq n)\)次摸到红球的概率。

解：设\(A_{k}=\{第k次摸到红球\}\)，\(k=1,2,\cdots,n\)。

解法1：若视n次摸出的球的编号的先后排列为一个样本点，则样本空间中共有\(n!\)个样本点，由题意知，出现每一个样本点的概率相等，而第k次为红球共有\(a(n-1)!\)个样本点，所以：
\[P(A_{k})=\frac{a(n-1)!}{n!}=\frac{a}{n}=\frac{a}{a+b},k=1,2,\cdots,n\]

解法2：若n个同学去摸球，我们只关心哪几个同学摸到红球，即视“哪几次摸到红球”为样本点，则样本空间中样本点总数为\(C_{n}^{a}\)。由题意知，出现每一个样本点的概率相等，如果\(A_{k}\)发生，即第k次一定为红球，只要在余下的\((n-1)\)次中决定\((a-1)\)次就行。故：
\[P(A_{k})=\frac{C_{n-1}^{a-1}}{C_{n}^{a}}=\frac{a}{n}=\frac{a}{a+b},k=1,2,\cdots,n\]

解法3：若视第k次摸到的球编号为样本点，则样本空间中共有n个样本点，其中有a个样本点使得\(A_{k}\)发生，故：
\[P(A_{k})=\frac{a}{n}=\frac{a}{a+b},k=1,2,\cdots,n\]

从以上三种解法的计算结果得到：在抽签问题中，第\(k(1\leq k\leq n)\)次摸到红球的概率即为第1次摸到红球的概率，与k无关。

同理可以得到，某两次都摸到红球的概率与第1次、第2次都摸到红球的概率相等，请读者自行证明。

**例1.3.3** 足球场内23个人（双方队员各11人加1名主裁），求至少有两人生日相同的概率（假设每人的生日在一年的365天是等可能的，且无双胞胎或多胞胎的情形）。

解：样本空间中样本点总数为\(365^{23}\)，所有人生日都不一样的样本点数为\(365\times364\times\cdots\times343\)，所以至少有两人生日相同的概率为：
\[1-\frac{365\times364\times\cdots\times343}{365^{23}}=0.507\]

是不是有点不可思议，概率超过0.5！同理可以计算50人的团体中至少有两人生日相同的概率为0.97。

## 1.4 条件概率
### （一）条件概率
在实际应用中，经常会遇到这样一类问题：在事件B发生的条件下，考察事件A发生的概率，此时在讨论事件A发生的概率时附加了“B已经发生”这一条件，概率度量往往会有变化，先来看一个简单的例子。一个袋子里有编号为0,1,2,…,9的10个球，设摸到每一个球的概率相等，采用有放回抽样，从袋中抽取两次，每次摸一球。将两次摸到的球的编号视为一个样本点，则样本空间S中共有100个样本点，出现每一个样本点的概率均为\(\frac{1}{100}\)，为古典概型。设\(A=\{两次号码之和大于16\}\)，则A包含3个样本点：(8,9)，(9,8)，(9,9)，故\(P(A)=\frac{3}{100}\)。若已知第一次摸到的球的编号为9，则此时试验只有(9,0)，(9,1)，…，(9,9)共10个结果，其中当(9,8)，(9,9)两个结果出现时事件A才发生，所以在第一次摸到的球的编号为9的条件下A发生的概率应为\(\frac{2}{10}\)。若记\(B=\{第一次摸到的球的编号为9\}\)，则\(\frac{2}{10}\)为在事件B发生的条件下事件A发生的条件概率，记为\(P(A|B)\)。\(P(A|B)\)与\(P(A)\)的差异，从直观上而言，也是容易理解的。因为在讨论\(P(A|B)\)时，已知事件B已经发生，所以此时试验的所有可能结果构成的集合就是B，即相应的样本空间S缩小为B，其样本点总数为10。此时，若A发生，则试验结果只能是(9,8)或(9,9)，故\(P(A|B)=\frac{2}{10}\neq P(A)=\frac{3}{100}\)。

**定义1.4.1** 如果\(P(B)>0\)，那么在B发生的条件下A发生的条件概率（conditional probability）为：
\[P(A|B)=\frac{P(AB)}{P(B)}\quad(1.4.1)\]

条件概率的图示分析如图1.4.1所示，条件概率\(P(A|B)\)可视为在缩小的样本空间B中对事件A的概率度量，因此条件概率满足概率的定义和性质，例如当\(P(C)\neq0\)时，有：
1. \(P(A|C)\geq0\)；
2. \(P(S|C)=1\)；
3. \(P(B|C)=1-P(\overline{B}|C)\)；
4. 当\(A\supset B\)时，\(P(A|C)\geq P(B|C)\)；
5. \(P(A\cup B|C)=P(A|C)+P(B|C)-P(AB|C)\)。

特别地，若\(AB=\emptyset\)，则\(P(A\cup B|C)=P(A|C)+P(B|C)\)。

**例1.4.1** 掷一颗骰子两次，已知两次点数之和大于8，求第一次是6点的概率。

解：设\(A=\{第一次是6点\}\)，\(B=\{两次点数之和大于8\}\)。由题意知，这是等可能概型，且样本空间中共有36个样本点，易知\(P(B)=\frac{10}{36}\)，\(P(AB)=\frac{4}{36}\)。

解法1：由(1.4.1)式知：
\[P(A|B)=\frac{P(AB)}{P(B)}=\frac{4/36}{10/36}=\frac{2}{5}\]

解法2：已知在B发生的条件下，可将B视为缩减了的样本空间，共有10个样本点，其中有4个使A发生，故：
\[P(A|B)=\frac{4}{10}=\frac{2}{5}\]

解法1是用条件概率的定义来求解，解法2是从条件概率的直观含义出发，用缩小的样本空间来求解，两种解法都是可行的。

**例1.4.2** 一袋中有5个红球，4个白球，从中每次摸一球，无放回抽样，抽4次。
1. 已知前两次中至少有一次摸到红球，求前两次中恰有一次摸到红球的概率；
2. 已知第4次摸到的是红球，求第1次和第2次摸到的都是红球的概率。

解：设\(A_{i}=\{第i次摸到红球\}\)，\(i=1,2,3,4\)；\(B=\{前两次中至少有一次摸到红球\}\)；\(C=\{前两次恰有一次摸到红球\}\)。

（1）根据条件概率的定义，可得：
\[P(C|B)=\frac{P(BC)}{P(B)}=\frac{P(C)}{1-P(\overline{B})}=\frac{C_{4}^{1}C_{5}^{1}/C_{9}^{2}}{1-C_{4}^{2}/C_{9}^{2}}=\frac{2}{3}\]

（2）注意到\(P(A_{1}A_{2}|A_{4})=\frac{P(A_{1}A_{2}A_{4})}{P(A_{4})}\)。由1.3节的例1.3.2可知\(P(A_{4})=\frac{5}{9}\)，而\(P(A_{1}A_{2}A_{4})=\frac{C_{5}^{3}}{C_{9}^{3}}=\frac{5}{42}\)，所以：
\[P(A_{1}A_{2}|A_{4})=\frac{3}{14}\]

### （二）乘法公式
由条件概率的定义知，当\(P(A)\neq0\)，\(P(B)\neq0\)时：
\[P(AB)=P(A)\cdot P(B|A)=P(B)\cdot P(A|B)\quad(1.4.2)\]
即两个事件积事件的概率等于一个事件的概率乘以在这个事件发生的条件下另一个事件的条件概率，称此等式为概率的乘法公式（multiplication formula）。

乘法公式可推广到多个事件的情形。当\(P(AB)\neq0\)时：
\[P(ABC)=P(A)P(B|A)P(C|AB)\quad(1.4.3)\]
一般地，当\(P(A_{1}A_{2}\cdots A_{n-1})\neq0(n\geq3)\)时，有：
\[P(A_{1}A_{2}\cdots A_{n})=P(A_{1})P(A_{2}|A_{1})P(A_{3}|A_{1}A_{2})\cdots P(A_{n}|A_{1}A_{2}\cdots A_{n-1})\]

此外，结合概率的直观含义，对应于(1.4.2)，条件概率的乘法公式也成立，即当\(P(AC)\neq0\)时，有：
\[P(AB|C)=P(A|C)P(B|AC)\quad(1.4.5)\]

**例1.4.3** 设一社区“三口之家”占了70%，已知该社区有40%的家庭至少有一人职业为教师，且在“三口之家”中有30%的家庭至少有一人职业为教师。在该社区随机找一户。
1. 求这一户既是“三口之家”又“至少有一人职业为教师”的概率；
2. 求这一户既不是“三口之家”又“没有人职业为教师”的概率；
3. 已知这一户“没有人职业为教师”，求这一户是“三口之家”的概率。

解：设\(A=\{这一户是“三口之家”\}\)，\(B=\{这一户“有人职业为教师”\}\)。由题意知：
\[P(A)=70\%\]
\[P(B)=40\%\]
\[P(B|A)=30\%\]

（1）所求概率为：
\[P(AB)=P(A)P(B|A)=0.7\times0.3=0.21\]

（2）所求概率为：
\[
\begin{align*}
P(\overline{A}\overline{B})&=P(\overline{A\cup B})\\
&=1-[P(A)+P(B)-P(AB)]\\
&=0.11
\end{align*}
\]

（3）所求概率为：
\[
\begin{align*}
P(A|\overline{B})&=1-P(\overline{A}|\overline{B})\\
&=1-\frac{P(\overline{A}\overline{B})}{P(\overline{B})}\\
&=1-\frac{0.11}{0.6}\\
&=\frac{49}{60}
\end{align*}
\]

**例1.4.4** 某人参加某种技能考试，已知第1次考合格的概率为60%；若第1次没有合格，第2次能考合格的概率为70%；若第1次和第2次均不合格，第3次能考合格的概率为80%，求此人最多3次能考合格的概率。

解：设\(A_{i}=\{第i次考合格\}\)，\(i=1,2,3\)；\(B=\{最多3次能考合格\}\)。

解法1：注意到\(B=A_{1}\cup\overline{A}_{1}A_{2}\cup\overline{A}_{1}\overline{A}_{2}A_{3}\)，所以：
\[
\begin{align*}
P(B)&=P(A_{1})+P(\overline{A}_{1}A_{2})+P(\overline{A}_{1}\overline{A}_{2}A_{3})\\
&=P(A_{1})+P(\overline{A}_{1})P(A_{2}|\overline{A}_{1})+P(\overline{A}_{1})P(\overline{A}_{2}|\overline{A}_{1})P(A_{3}|\overline{A}_{1}\overline{A}_{2})\\
&=0.6+0.4\times0.7+0.4\times0.3\times0.8\\
&=0.976
\end{align*}
\]

解法2：由于\(\overline{B}=\overline{A}_{1}\overline{A}_{2}\overline{A}_{3}\)，故：
\[
\begin{align*}
P(B)&=1-P(\overline{A}_{1}\overline{A}_{2}\overline{A}_{3})\\
&=1-P(\overline{A}_{1})P(\overline{A}_{2}|\overline{A}_{1})P(\overline{A}_{3}|\overline{A}_{1}\overline{A}_{2})\\
&=1-0.4\times0.3\times0.2\\
&=0.976
\end{align*}
\]

### （三）全概率公式、贝叶斯公式
假设A，B为随机事件，那么总有\(A=AB\cup A\overline{B}\)。又因为\(AB\)与\(A\overline{B}\)互不相容，利用概率的有限可加性可得：
\[P(A)=P(AB)+P(A\overline{B})=P(B)\cdot P(A|B)+P(\overline{B})\cdot P(A|\overline{B})\quad(1.4.6)\]

(1.4.6)式为我们计算A的概率带来了一定启示，当直接计算\(P(A)\)比较困难时，可利用与事件A有密切关系的事件B，先将A分解成互不相容的两部分\(AB\)与\(A\overline{B}\)，结合事件B发生与否条件下的概率计算来求得A的概率。注意到\(P(B)+P(\overline{B})=1\)，故(1.4.6)式也可视为条件概率的加权平均。(1.4.6)式中重要的是如何寻找合适的B。

为了将(1.4.6)式推广至更一般的情形，下面先给出一个定义。

**定义1.4.2** 设S为某一随机试验的样本空间，\(B_{1},B_{2},\cdots,B_{n}\)为该试验的一组事件，且满足：
1. \(B_{i}B_{j}=\emptyset\)，\(i,j=1,2,\cdots,n\)，\(i\neq j\)；
2. \(B_{1}\cup B_{2}\cup\cdots\cup B_{n}=S\)。

则称\(B_{1},B_{2},\cdots,B_{n}\)为S的一个划分，或称为S的一个完备事件组。

上述定义中的两条，直观而言，即\(B_{1},B_{2},\cdots,B_{n}\)两两同时发生是不可能的，而至少有一个发生又是必然的，易见，任意一个事件B与其逆事件\(\overline{B}\)就是S的一个划分，其实，当样本空间S的样本点有限时，所有基本事件就是S的一个划分。

若A是S中的一个事件，\(B_{1},B_{2},\cdots,B_{n}\)是S的一个划分，则类似(1.4.6)式，可以将A分解成两两互不相容的事件的和，即：
\[A=AS=A\cap(B_{1}\cup B_{2}\cup\cdots\cup B_{n})=AB_{1}\cup AB_{2}\cup\cdots\cup AB_{n}=\bigcup_{j=1}^{n}AB_{j}\]
两边求概率，利用概率的有限可加性得：
\[P(A)=P\left(\bigcup_{j=1}^{n}AB_{j}\right)=\sum_{j=1}^{n}P(AB_{j})\]
结合概率的乘法公式，得到以下定理。

**定理1.4.1** 设S为某一试验的样本空间。若\(B_{1},B_{2},\cdots,B_{n}\)是S的一个划分，且\(P(B_{j})>0\)，\(j=1,2,\cdots,n\)，则对任一事件A有：
\[P(A)=\sum_{j=1}^{n}P(B_{j})P(A|B_{j})\]
称(1.4.7)式为概率的全概率公式（law of total probability）。

运用公式(1.4.7)的关键是找到一组合适的划分。

**定理1.4.2** 设S为某一试验的样本空间。若\(B_{1},B_{2},\cdots,B_{n}\)是S的一个划分，且\(P(B_{j})>0\)，\(j=1,2,\cdots,n\)，则对任一事件A，\(P(A)\neq0\)有：
\[P(B_{k}|A)=\frac{P(B_{k}A)}{P(A)}=\frac{P(B_{k})P(A|B_{k})}{\sum_{j=1}^{n}P(B_{j})P(A|B_{j})},k=1,2,\cdots,n\quad(1.4.8)\]
称(1.4.8)式为概率的贝叶斯公式（Bayes formula）或逆概公式。

若把事件A视为某一试验结果，把划分\(B_{1},B_{2},\cdots,B_{n}\)作为导致A发生的n种原因，则贝叶斯公式为由“结果”推测“原因”的一个重要工具。

在利用贝叶斯公式时，其中的\(P(B_{j})(j=1,2,\cdots,n)\)的概率往往是已知或事先假设（或者根据以往的资料或经验的累积）的，常称\(P(B_{j})\)为先验概率（prior probability）；而当事件A发生后，对\(B_{j}\)发生的概率重新进行推断（或修正），常称\(P(B_{j}|A)\)为后验概率（posterior probability）。

**例1.4.5** 一小学举办家长开放日，欢迎家长参加。某同学母亲参加的概率为0.80，如果母亲参加，那么父亲参加的概率为0.30；如果母亲不参加，那么父亲参加的概率为0.90。
1. 求该同学父母都参加的概率；
2. 求该同学父亲参加的概率；
3. 在已知父亲参加的条件下，求母亲也参加的概率。

解：设\(A=\{母亲参加\}\)，\(B=\{父亲参加\}\)。由题意知：
\[P(A)=0.80\]
\[P(B|A)=0.30\]
\[P(B|\overline{A})=0.90\]

（1）\(P(AB)=P(A)P(B|A)=0.80\times0.30=0.24\)

（2）
\[
\begin{align*}
P(B)&=P(AB\cup\overline{A}B)\\
&=P(AB)+P(\overline{A}B)\\
&=P(A)P(B|A)+P(\overline{A})P(B|\overline{A})\\
&=0.80\times0.30+0.20\times0.90\\
&=0.42
\end{align*}
\]

（3）
\[P(A|B)=\frac{P(AB)}{P(B)}=\frac{0.24}{0.42}\approx0.57\]

**例1.4.6** 某保险公司的某险种有高、中、低三种类型风险客户，他们的年度索赔概率分别为0.02，0.01，0.002。设三类客户所占份额分别是0.05，0.15，0.80，在其中任选一位客户。
1. 求该客户的年度索赔概率；
2. 若该客户在这一年中发生了索赔，求他是高风险客户的概率。

解：设\(A=\{客户在这一年中发生了索赔\}\)，\(B_{1}=\{客户属于高风险类型\}\)，\(B_{2}=\{客户属于中风险类型\}\)，\(B_{3}=\{客户属于低风险类型\}\)，那么\(B_{1},B_{2},B_{3}\)构成了样本空间的一个划分，且由题意知：
\[P(B_{1})=0.05\]
\[P(B_{2})=0.15\]
\[P(B_{3})=0.80\]
\[P(A|B_{1})=0.02\]
\[P(A|B_{2})=0.01\]
\[P(A|B_{3})=0.002\]

（1）
\[
\begin{align*}
P(A)&=P(B_{1})P(A|B_{1})+P(B_{2})P(A|B_{2})+P(B_{3})P(A|B_{3})\\
&=0.05\times0.02+0.15\times0.01+0.80\times0.002\\
&=0.0041
\end{align*}
\]

（2）
\[
\begin{align*}
P(B_{1}|A)&=\frac{P(B_{1}A)}{P(A)}\\
&=\frac{P(B_{1})P(A|B_{1})}{P(A)}\\
&=\frac{0.05\times0.02}{0.0041}\\
&=\frac{10}{41}
\end{align*}
\]

**例1.4.7** 小王参加一个棋类比赛，参与的棋手有三类，其中45%为1类棋手，45%为2类棋手，10%为3类棋手，若已知他与这三类棋手进行比赛，获胜的概率分别为0.3，0.5和0.6。从这些棋手中任选一人与他比赛，如果他获胜，问对手最有可能是哪类棋手？

解：令\(A=\{小王获胜\}\)，\(B_{i}=\{对手为i类棋手\}\)，\(i=1,2,3\)，那么\(B_{1},B_{2},B_{3}\)构成样本空间的一个划分，且由题意知：
\[P(B_{1})=0.45\]
\[P(B_{2})=0.45\]
\[P(B_{3})=0.10\]
\[P(A|B_{1})=0.3\]
\[P(A|B_{2})=0.5\]
\[P(A|B_{3})=0.6\]

根据贝叶斯公式：
\[P(B_{i}|A)=\frac{P(B_{i})P(A|B_{i})}{P(B_{1})P(A|B_{1})+P(B_{2})P(A|B_{2})+P(B_{3})P(A|B_{3})},i=1,2,3\]

故：
\[P(B_{1}|A)=\frac{0.45\times0.3}{0.45\times0.3+0.45\times0.5+0.10\times0.6}=0.3214\]
\[P(B_{2}|A)=\frac{0.45\times0.5}{0.45\times0.3+0.45\times0.5+0.10\times0.6}=0.5357\]
\[P(B_{3}|A)=\frac{0.10\times0.6}{0.45\times0.3+0.45\times0.5+0.10\times0.6}=0.1429\]

因为\(P(B_{2}|A)=max\{P(B_{1}|A),P(B_{2}|A),P(B_{3}|A)\}\)，所以对手最有可能是2类棋手。

**例1.4.8** 设有3个箱子，第1个箱子装有3个白球和5个红球，第2个箱子装有2个白球和2个红球，第3个箱子装有5个白球和2个红球，现从3个箱子中任挑一个，然后从该箱子中随机取两次，每次取一球，无放回抽样。
1. 求第一次取到的是白球的概率；
2. 已知第一次取到的是白球，问取到的是第1，第2，第3个箱子的概率分别是多少？
3. 在已知第一次取到白球的条件下，求第二次也取到白球的概率。

解：设\(A_{i}=\{取到第i个箱子\}\)，\(i=1,2,3\)；\(B_{j}=\{第j次取到白球\}\)，\(j=1,2\)，那么\(A_{1},A_{2},A_{3}\)构成了样本空间的一个划分，且易知：
\[P(B_{1}|A_{1})=\frac{3}{8}\]
\[P(B_{1}|A_{2})=\frac{2}{4}=\frac{1}{2}\]
\[P(B_{1}|A_{3})=\frac{5}{7}\]

（1）
\[
\begin{align*}
P(B_{1})&=P\left(\bigcup_{i=1}^{3}A_{i}B_{1}\right)\\
&=\sum_{i=1}^{3}P(A_{i})P(B_{1}|A_{i})\\
&=\frac{1}{3}\left(\frac{3}{8}+\frac{1}{2}+\frac{5}{7}\right)\\
&=\frac{89}{168}
\end{align*}
\]

（2）
\[P(A_{1}|B_{1})=\frac{P(A_{1}B_{1})}{P(B_{1})}=\frac{P(A_{1})P(B_{1}|A_{1})}{P(B_{1})}=\frac{\frac{1}{3}\times\frac{3}{8}}{\frac{89}{168}}=\frac{21}{89}\]
\[P(A_{2}|B_{1})=\frac{P(A_{2}B_{1})}{P(B_{1})}=\frac{P(A_{2})P(B_{1}|A_{2})}{P(B_{1})}=\frac{\frac{1}{3}\times\frac{1}{2}}{\frac{89}{168}}=\frac{28}{89}\]
\[P(A_{3}|B_{1})=\frac{P(A_{3}B_{1})}{P(B_{1})}=\frac{P(A_{3})P(B_{1}|A_{3})}{P(B_{1})}=\frac{\frac{1}{3}\times\frac{5}{7}}{\frac{89}{168}}=\frac{40}{89}\]

（3）\(P(B_{2}|B_{1})=\frac{P(B_{1}B_{2})}{P(B_{1})}\)，而：
\[
\begin{align*}
P(B_{1}B_{2})&=\sum_{i=1}^{3}P(A_{i})P(B_{1}B_{2}|A_{i})\\
&=\frac{1}{3}\left(\frac{C_{3}^{2}}{C_{8}^{2}}+\frac{C_{2}^{2}}{C_{4}^{2}}+\frac{C_{5}^{2}}{C_{7}^{2}}\right)\\
&=\frac{1}{4}
\end{align*}
\]
所以：
\[P(B_{2}|B_{1})=\frac{P(B_{1}B_{2})}{P(B_{1})}=\frac{\frac{1}{4}}{\frac{89}{168}}=\frac{42}{89}\]

## 1.5 事件的独立性与独立试验
从1.4节中的一些例题可知，若A，B均为随机事件，一般情形下，\(P(A | B)\)不等于\(P(A)\)，也就是说事件B发生的条件会改变事件A发生的概率。但也有不改变的，例如，某种彩票每次公布的最后两个数都是从0到9这10个数字中随机取1个数，若记\(A_{i}\)={倒数第i位数小于5}，\(i=1,2\)，则从彩票设计的公平性考虑，应该有\(P(A_{2})=P(A_{2} | A_{1})\)，也就是说\(A_{1}\)发生并不影响\(A_{2}\)发生的可能性。由概率的乘法公式知，此时\(P(A_{1} A_{2})=P(A_{1}) \cdot P(A_{2} | A_{1})=P(A_{1}) \cdot P(A_{2})\)，易见此式中\(A_{1}\)，\(A_{2}\)是对称的。这时称\(A_{1}\)，\(A_{2}\)是相互独立的。

**定义1.5.1** 设A，B为两随机事件，当
\[P(AB)=P(A)\cdot P(B) (1.5.1)\]
时，称事件A，B相互独立(independent)。

**定理1.5.1** 当\(P(A) \cdot P(B) ≠0\)时，“事件A与事件B相互独立”等价于“条件概率等于无条件概率”，即
\[P(B | A)=P(B) (或 P(A | B)=P(A)).\]

**定理1.5.2** 当事件A与事件B相互独立时，A与\(\bar{B}\)，\(\bar{A}\)与B，\(\bar{A}\)与\(\bar{B}\)均相互独立。

证明 因为\(A=A B \cup A \bar{B}\)，两边求概率并移项得
\[P(A \overline{B})=P(A)-P(A B) .\]
当事件A与事件B相互独立时，
\[\begin{aligned} P(A \overline{B}) & =P(A)-P(A) \cdot P(B) \\ & =P(A) \cdot[1-P(B)]=P(A) \cdot P(\overline{B}) . \end{aligned}\]
故A与\(\bar{B}\)相互独立，由此可进一步得\(\bar{A}\)与B，\(\bar{A}\)与\(\bar{B}\)均相互独立。

至此，描述两个随机事件A，B的关系除包含关系和不相容关系外，还有独立关系。

**例1.5.1** 甲、乙两人同时向一目标进行射击，若甲的击中率为0.8，乙的击中率为0.7，求目标被击中的概率。

解 设\(A={甲击中目标}\)，\(B={乙击中目标}\)，\(C={目标被击中}\)，由题意知
\[P(A)=0.8, P(B)=0.7, C=A \cup B .\]
注意到甲、乙两人的射击是同时进行的，因此可以认为其结果是相互独立的，即认为事件A，B相互独立，利用加法公式可得
\[\begin{aligned} P(C) & =P(A \cup B)=P(A)+P(B)-P(A B) \\ & =P(A)+P(B)-P(A) P(B) \\ & =0.8+0.7-0.8 × 0.7=0.94 . \end{aligned}\]

**例1.5.2** 设A，B为随机事件，且\(P(A)=0.5\)，\(P(B)=0.4\)，求在下列四种情况下，A与B至少有一个发生的概率：
(1) A与B互不相容；
(2) B发生必有A发生；
(3) A与B相互独立；
(4) \(P(A B)=0.3\)。

解 利用加法公式，\(P(A \cup B)=P(A)+P(B)-P(A B)\)
(1) 如果A与B互不相容，那么\(P(A B)=0\)，故\(P(A \cup B)=0.5 + 0.4 - 0 = 0.9\)；
(2) 如果B发生必有A发生，即\(A \supset B\)，那么\(A B=B\)，\(A \cup B=A\)，故\(P(A \cup B)=P(A)=0.5\)；
(3) 如果A与B相互独立，那么\(P(A B)=P(A) P(B)=0.5×0.4 = 0.2\)，故\(P(A \cup B)=0.5 + 0.4 - 0.2 = 0.7\)；
(4) \(P(A \cup B)=0.5 + 0.4 - 0.3 = 0.6\)。

本例告诉我们，只知道A与B的概率，无法得到A与B至少有一个发生的概率，还需要了解两个事件之间的关系，不能凭自己的想象随意加条件，否则就可能得到错误的结果。

**定义1.5.2** 设A，B，C为三个随机事件，当
\[P(A B)=P(A) P(B),\]
\[P(A C)=P(A) P(C),\]
\[P ( B C ) = P ( B ) P ( C )\]
都成立时，称事件A，B，C两两独立。若同时还满足
\[P(A B C)=P(A) P(B) P(C),\]
则称事件A，B，C相互独立。

应注意，相互独立的事件一定是两两独立的，而两两独立的事件不一定相互独立。

例如，一袋中有4个球，分别涂白色、红色、黑色和红白黑三色。设取到每一个球的可能性相等，从中任取一球，令\(A_{1}={取到涂白色的球}\)，\(A_{2}={取到涂红色的球}\)，\(A_{3}={取到涂黑色的球}\)，则\(P(A_{1})=P(A_{2})=P(A_{3})=\frac{2}{4}=\frac{1}{2}\)，\(P(A_{1} A_{2})=P(A_{1} A_{3})=P(A_{2} A_{3})=P\)（取到涂两种颜色的球）\(=\frac{1}{4}\)。那么，\(P(A_{1} A_{2})=P(A_{1}) P(A_{2})\)，同理有\(P(A_{1} A_{3})=P(A_{1}) P(A_{3})\)，\(P(A_{2} A_{3})=P(A_{2}) P(A_{3})\)，即\(A_{1}\)，\(A_{2}\)，\(A_{3}\)两两独立。但\(A_{1}A_{2}A_{3}={取到涂三种颜色的球}\)，\(P(A_{1} A_{2} A_{3})=\frac{1}{4}\)，而\(P(A_{1}) P(A_{2}) P(A_{3})=\frac{1}{8}\)，故\(P(A_{1} A_{2} A_{3}) ≠ P(A_{1}) P(A_{2}) P(A_{3})\)，即\(A_{1}\)，\(A_{2}\)，\(A_{3}\)不相互独立。

**定义1.5.3** 设n个事件\(A_{1}, A_{2}, \cdots, A_{n}(n ≥2)\)，若对其中任意k个事件\(A_{i_{1}}, A_{i_{2}}, \cdots, A_{i_{k}}(2 ≤k ≤n)\)，都有
\[P\left(A_{i_{1}} A_{i_{2}} \cdots A_{i_{k}}\right)=\prod_{j=1}^{k} P\left(A_{i_{j}}\right)\]
成立，则称事件\(A_{1}, A_{2}, \cdots, A_{n}\)相互独立。

对于可列个事件，若其中任意有限个事件相互独立，则称这可列个事件相互独立。

值得一提的是，在实际问题中，我们常常不是用独立的定义去验证事件的独立性，而是根据实际情况来判断，并将事件独立的定义作为性质来使用。

在实际应用中还常常涉及试验的独立性，假设所考虑的试验由一系列子试验组成。例如，某种彩票一期一期地不断开奖，就可以把每一次开奖看作一个子试验，而且这一期开奖的结果不影响其他期的开奖结果，像这样的试验结果互不影响的一系列试验称为独立试验。如果各个子试验是在相同条件下进行的，就称这些试验为重复试验。

**例1.5.3** 由5个独立元件组成的系统（如图1.5.1所示），设每个元件正常工作的概率为p，\(0<p<1\)，求系统正常工作的概率。

解 设\(A_{i}={第i个元件正常工作}\)，\(i=1,2,3,4,5\)，由题意知\(A_{1}, A_{2}, \cdots, A_{5}\)相互独立。又设\(A={系统正常工作}\)，则\(A=A_{3}A \cup \overline{A}_{3}A\)，那么
\[P(A)=P\left(A_{3}\right) \cdot P\left(A | A_{3}\right)+P\left(\overline{A}_{3}\right) \cdot P\left(A | \overline{A}_{3}\right) .\]

用缩小的样本空间求解\(P(A | A_{3})\)的值为\(p_{1}\)，\(p_{1}\)即为图1.5.2所示系统正常工作的概率。由于\(A_{1}, A_{2}, \cdots, A_{5}\)相互独立，故\(A_{1} \cup A_{4}\)与\(A_{2} \cup A_{5}\)也相互独立。再结合加法公式，可得
\[\begin{aligned} p_{1} & =P\left(\left(A_{1} \cup A_{4}\right) \cdot\left(A_{2} \cup A_{5}\right)\right) \\ & =P\left(A_{1} \cup A_{4}\right) \cdot P\left(A_{2} \cup A_{5}\right) \\ & =\left(2 p-p^{2}\right)^{2} . \end{aligned}\]

又若记\(P(A | \bar{A}_{3})\)的值为\(p_{2}\)，\(p_{2}\)即为图1.5.3所示系统正常工作的概率，利用加法公式，再结合\(A_{1}, A_{2}, \cdots, A_{5}\)的相互独立性，可得
\[\begin{aligned} p_{2} & =P\left(A_{1} A_{2} \cup A_{4} A_{5}\right) \\ & =P\left(A_{1} A_{2}\right)+P\left(A_{4} A_{5}\right)-P\left(A_{1} A_{2} A_{4} A_{5}\right) \\ & =2 p^{2}-p^{4} . \end{aligned}\]

所以
\[\begin{aligned} P(A) & =p\left(2 p-p^{2}\right)^{2}+(1-p)\left(2 p^{2}-p^{4}\right) \\ & =2 p^{2}+2 p^{3}-5 p^{4}+2 p^{5} . \end{aligned}\]

**例1.5.4** 一袋中有编号为1,2,3,4共四个球，从袋中有放回地取两次（每次取一个，且假设取到每一个号码的概率相等），并记录号码之和，这样独立重复地试验，求“和等于3”出现在“和等于5”之前的概率。

解 设\(A={"和等于3"出现在"和等于5"之前}\)，\(B={第一次号码之和等于3}\)，\(C={第一次号码之和等于5}\)，\(D={第一次号码和既不等于3，也不等于5}\)。

“号码之和等于3”的概率为\(\frac{2}{16}\)，“号码之和等于5”的概率为\(\frac{4}{16}\)，“号码之和既不等于3又不等于5”的概率为\(\frac{10}{16}\)，故
\[P(B)=\frac{2}{16}, P(C)=\frac{4}{16}, P(D)=\frac{10}{16} .\]

由全概率公式得
\[\begin{aligned} P(A) & =P(B) \cdot P(A | B)+P(C) \cdot P(A | C)+P(D) \cdot P(A | D) \\ & =\frac{2}{16} × 1+\frac{4}{16} × 0+\frac{10}{16} × P(A | D) . \end{aligned}\]

在已知“第一次号码之和既不等于3，也不等于5”的条件下，求A的条件概率问题，相当于重新考虑A的概率，因为试验是相互独立的，即第一次结果不影响A发生的概率，所以\(P(A | D)=P(A)\)。故
\[P(A)=\frac{2}{16}+\frac{10}{16} × P(A),\]
从而
\[P(A)=\frac{1}{3} .\]

如果要你判断一下，发生概率为\(p=0.0001\)的事件A在一次试验中是否会发生呢？回答：一般不会发生。从长期实践中得到“概率很小的事件在一次试验中几乎不发生”（称之为实际推断原理），但是若独立进行成千上万次试验，结果又如何呢？且看下面的例题。

**例1.5.5** 某技术工人长期进行某项技术操作，经验丰富，因嫌按规定操作太过烦琐，他就按照自己的方法进行，但这样做有可能发生事故，设他每次操作发生事故的概率为\(p(p>0\)且很小)，他独立地进行了n次操作，求：
(1) n次都不发生事故的概率；
(2) 至少有一次发生事故的概率。

解 设\(A={n次都不发生事故}\)，\(B={n次中至少有一次发生事故}\)，\(C_{i}={第i次不发生事故}\)，\(i=1,2, \cdots, n\)，由题意知\(C_{1}, C_{2}, \cdots, C_{n}\)相互独立，且\(P(C_{i})=1-p\)，故
(1) \(P(A)=P\left(C_{1} C_{2} \cdots C_{n}\right)=(1-p)^{n}\)；
(2) \(P(B)=1-P(A)=1-(1-p)^{n}\)。

注意到\(\lim _{n \to +\infty} P(B)=1\)，也就是说，虽然每次发生事故的概率p很小，但只要次数多（n充分大），至少有一次发生事故的概率就会很大，甚至接近于1。总之，随着独立重复试验次数的增多，“小概率事件至少有一次发生”的概率渐渐增大。
