# 第7章 参数估计
本章我们开始着手利用样本对总体作出统计推断。统计推断为我们提供了从样本数据中推断出有关总体结论的方法，通常分为两大类：参数估计与假设检验。本章讨论总体参数的估计问题。在前面已多次使用“参数”这个词，它指的是总体分布函数$F(x ; \theta)$中所含的未知参数$\theta$，但是在统计研究中，参数的含义更广泛一些，用来刻画总体某方面特征的量统称为参数(parameter)。在实际应用中，人们感兴趣的参数称为待估参数，有时也简称为参数。对于参数估计，通常有两种估计方式：点估计和区间估计。简单地说，点估计(point estimation)就是用一个具体的数值去估计一个未知参数；区间估计(interval estimation)就是给出未知参数估计的上、下界。譬如，估计某个城市居民某年的人均消费为10000元，这是一个点估计；若估计人均消费在8000元到12000元之间，这就是一个区间估计。点估计与区间估计是互为补充的两种参数估计形式。

## 7.1 点估计
设总体$X$的分布函数为$F(x ; \theta)$，$\theta$是待估参数，$X_{1}, X_{2}, \cdots, X_{n}$是$X$的一个样本。点估计问题就是要构造一个适当的统计量$\widehat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$，用来估计参数$\theta$，此时称$\widehat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$为$\theta$的(点)估计量(point) estimator)。

如果把其中的样本用样本值$x_{1}, x_{2}, \cdots, x_{n}$代替，就称$\widehat{\theta}(x_{1}, x_{2}, \cdots, x_{n})$为$\theta$的一个估计值，在不致混淆的情况下，统称估计量和估计值为估计，并都简记为$\widehat{\theta}$。

由前一章的内容知，我们可以将统计量$\bar{X}$（样本均值）作为参数$\mu$（总体均值）的估计量。同一个参数可以构造不同的点估计量，例如我们也可以用$\sum_{i=1}^{n} c_{i} X_{i}$替代$\bar{X}$作为总体均值$\mu$的估计，其中权系数满足$\sum_{i=1}^{n} c_{i}=1$。那么如何比较这些估计量之间的好坏呢？7.2节将给出常用的估计量评价标准，我们可以依据这些标准进行比较。

根据不同的统计思想，可得到不同的点估计方法，下面将介绍两种常用的点估计方法：矩法(moment method)和极大似然法(maximum likelihood method)。

### (一) 矩法
矩法是由英国统计学家皮尔逊(Pearson)在1894年提出来的，也是最古老的一种估计方法，其主要理论依据为大数定律，即当样本容量$n \to +\infty$时，样本矩依概率收敛于相应的总体矩，即
$$
A_{k} \stackrel{P}{\to} \mu_{k}, B_{k} \stackrel{P}{\to} v_{k},
$$
其中$A_{k}$，$B_{k}$分别为样本的$k$阶原点矩和$k$阶中心矩，$\mu_{k}$，$v_{k}$分别为总体的$k$阶原点矩和$k$阶中心矩。因此，我们可以用样本矩作为相应总体矩的估计，用样本矩的函数作为相应总体矩的同一函数的估计，这就是矩法的统计思想。

设$\theta_{1}, \theta_{2}, \cdots, \theta_{m}$是总体$X$的待估参数，并假定$X$的前$m(m \geq1)$阶矩存在。下面我们给出利用矩法求参数估计量的基本步骤：

1. 求总体$X$的前$m$阶矩（不妨设为原点矩）$\mu_{1}, \mu_{2}, \cdots, \mu_{m}$，一般地，这些矩可以写成待估参数$\theta_{1}, \theta_{2}, \cdots, \theta_{m}$的函数形式，记为
$$

\left\{
\begin{array}{c} 
\mu_{1}=E(X)=g_{1}\left(\theta_{1}, \theta_{2}, \cdots, \theta_{m}\right), \\ 
\mu_{2}=E\left(X^{2}\right)=g_{2}\left(\theta_{1}, \theta_{2}, \cdots, \theta_{m}\right), \\ 
\cdots \cdots \cdots \\ 
\mu_{m}=E\left(X^{m}\right)=g_{m}\left(\theta_{1}, \theta_{2}, \cdots, \theta_{m}\right) .
\end{array}
\right.

$$

2. 由方程组(7.1.1)，可求出各参数关于前$m$阶矩$\mu_{1}, \mu_{2}, \cdots, \mu_{m}$的函数表达式：
$$

\theta_{k}=h_{k}\left(\mu_{1}, \mu_{2}, \cdots, \mu_{m}\right), k=1,2, \cdots, m

$$

3. 根据矩法思想，以$A_{i}$代替$\mu_{i}$，$i=1,2, \cdots, m$，即可得各参数的估计量为
$$

\hat{\theta}_{k}=h_{k}\left(A_{1}, A_{2}, \cdots, A_{m}\right), k=1,2, \cdots, m .

$$

我们称上述求得的$\widehat{\theta}_{k}$为参数$\theta_{k}$的矩估计量(moment estimator)，$k=1,2, \cdots, m$。

**注**：在上面的(7.1.1)式中，也可以用部分总体中心矩$v_{i}$代替原点矩$\mu_{i}$，此时在步骤(3)中以相应的样本矩$B_{i}$代替$v_{i}$即可。

**例7.1.1** 设总体$X$服从指数分布$E(\lambda)$，其密度函数为
$$

f(x ; \lambda)= 
\begin{cases}
\lambda e^{-\lambda x}, & x \geq 0, \\ 
0, & x<0,
\end{cases}

$$
其中$\lambda>0$未知。若$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本，请求参数$\lambda$的矩估计量。

由$\mu_{1}=E(X)=\frac{1}{\lambda}$可得
$$

\lambda=\frac{1}{\mu_{1}} .

$$
以$A_{1}$代替$\mu_{1}$，得$\lambda$的矩估计量为
$$

\hat{\lambda}=\frac{1}{A_{1}}=\frac{1}{\overline{X}}=\frac{n}{\sum_{i=1}^{n} X_{i}} .

$$

**例7.1.2** 设总体$X$服从区间$[a, b]$上均匀分布，其中$a<b$未知。若$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本。
(1) 试求参数$a$，$b$的矩估计量；
(2) 若已获得样本值1.8、0.5、1.6、0.9、2.0、1.2、1.3、2.5、2.4、0.6，求$a$，$b$的矩估计值。

解：(1) 由$\mu_{1}=E(X)=\frac{a+b}{2}$，$v_{2}=Var(X)=\frac{(b-a)^{2}}{12}$可得
$$

a=\mu_{1}-\sqrt{3 v_{2}}, b=\mu_{1}+\sqrt{3 v_{2}} .

$$
以$A_{1}=\bar{X}$代替$\mu_{1}$，$B_{2}=\frac{1}{n} \sum_{i=1}^{n}(X_{i}-\bar{X})^{2}$代替$v_{2}$，得参数$a$，$b$的矩估计量分别为
$$

\hat{a}=\overline{X}-\sqrt{3 B_{2}}, \hat{b}=\overline{X}+\sqrt{3 B_{2}} .

$$

(2) 根据样本值计算得$\bar{x}=1.48$，$B_{2}=0.4456$，所以$a$，$b$的矩估计值分别为
$$

\hat{a}=0.3238, \hat{b}=2.6362 .

$$

**例7.1.3** 设总体$X \sim N(\mu, \sigma^{2})$，$X_{1}, X_{2}, \cdots, X_{n}$是总体$X$的简单随机样本。
(1) 若$\mu$未知，$\sigma^{2}=1$，求$\mu$的矩估计量；
(2) 若$\sigma^{2}$未知，$\mu=1$，求$\sigma^{2}$的矩估计量；
(3) 若$\mu$，$\sigma^{2}$均未知，求$\mu$，$\sigma^{2}$的矩估计量。

解：(1) $\mu$的矩估计量为$\widehat{\mu}=\bar{X}$

(2) $E(X)=1$，$E(X^{2})=\sigma^{2}+1$，所以，$\sigma^{2}=E(X^{2})-1$，
$$

\hat{\sigma}^{2}=A_{2}-1=\frac{1}{n} \sum_{i=1}^{n} X_{i}^{2}-1 .

$$

(3) $\mu$，$\sigma^{2}$的矩估计量为
$$

\hat{\mu}=\overline{X}, \hat{\sigma}^{2}=A_{2}-\overline{X}^{2}=\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\overline{X}\right)^{2}=B_{2} .

$$

**注**：从本例可以看出，矩估计没有涉及总体是正态分布的信息。

**例7.1.4** 设某工厂生产的零件长度$X$（单位：mm）服从正态分布$N(\mu, \sigma^{2})$，其中$\mu$，$\sigma^{2}$是未知参数，规定当长度落在区间[46,50]时，产品合格，并以$\theta$代表该厂生产的零件的合格率。现从中随机抽取了10个零件，测得长度分别为46.2、50.3、48.8、47.7、49.8、46.5、48.3、49.7、48.4、47.2，试用矩法给出合格率$\theta$的估计值。

解：根据正态分布的性质，可得
$$

\begin{aligned} 
\theta & =P\{46 \leq X \leq 50\}=\Phi\left(\frac{50-\mu}{\sigma}\right)-\Phi\left(\frac{46-\mu}{\sigma}\right) \\ 
& =\Phi\left(\frac{50-\mu_{1}}{\sqrt{v_{2}}}\right)-\Phi\left(\frac{46-\mu_{1}}{\sqrt{v_{2}}}\right) .
\end{aligned}

$$
由实际数据可计算得
$$

a_{1}=\overline{x}=48.29, b_{2}=\frac{1}{10} \sum_{i=1}^{10}\left(x_{i}-\overline{x}\right)^{2}=1.7689 .

$$
因此，合格率$\theta$的矩估计值为
$$

\begin{aligned} 
\hat{\theta} & =\Phi\left(\frac{50-48.29}{\sqrt{1.7689}}\right)-\Phi\left(\frac{46-48.29}{\sqrt{1.7689}}\right) \\ 
& =\Phi(1.29)+\Phi(1.72)-1=0.8588 .
\end{aligned}

$$

由上述例子可以看出，用矩法获得估计量是简便易行的。当样本容量趋于无穷大时，矩估计量依概率收敛于相应的参数，通常称这种估计量为参数的相合估计。当总体的分布未知，但知道待估参数关于总体各阶矩的函数形式时，便可求出该参数的矩估计。矩法的缺点是：在总体分布已知时，没有充分利用总体分布所提供的信息。矩估计量不具有唯一性，譬如，泊松分布的参数$\lambda$既是总体的数学期望，又是总体的方差，所以样本均值$\bar{X}$和二阶中心矩$B_{2}$都是$\lambda$的矩估计量。

### (二) 极大似然法
极大似然法是在参数分布族的场合下使用的一种应用非常广泛的参数估计方法。它首先是由德国数学家高斯(Gauss)在1821年提出的，然而，这个方法常更加归功于英国统计学家费希尔，因为后者在1922年重新发掘了这一方法的重要性，并研究了该方法的一些优良性质。为了更好地理解极大似然法的统计思想，先举一个简单的例子。

**例7.1.5** 假设在一个罐中放着许多白球和黑球，并假定已经知道两种球的数量之比是1:3，但不知道哪种颜色的球多。如果用有放回抽样方法从罐中取5个球，观察结果为：黑、白、黑、黑、黑。试根据上述结果，估计从罐中任取一球，取到黑球的概率。

设抽到黑球的概率为$p$，则本例中$p=\frac{1}{4}$或$p=\frac{3}{4}$。

当$p=\frac{1}{4}$时，出现例中观察结果的概率为$p_{1}=(\frac{1}{4})^{4} \times\frac{3}{4}=\frac{3}{1024}$

当$p=\frac{3}{4}$时，出现例中观察结果的概率为$p_{2}=(\frac{3}{4})^{4} \times\frac{1}{4}=\frac{81}{1024}$

由于$p_{1}<p_{2}$，故认为$p=\frac{3}{4}$比$p=\frac{1}{4}$更有可能。于是取到黑球的概率的估计值为$\frac{3}{4}$更合理。

极大似然法的基本思想：设某事件$A$发生的概率依赖于待估参数$\theta$，如果观察到$A$已经发生，那么就取使得事件$A$发生的概率达到最大的$\theta$的值作为$\theta$的估计。

设$X$为离散型总体，其概率分布律为$P\{X=x\}=p(x ; \theta)$，$\theta \in \Theta$是未知的待估参数，$\Theta$为参数可取值范围（参数空间），$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本，并设$x_{1}, x_{2}, \cdots, x_{n}$是已经得到的样本值，则样本$X_{1}, X_{2}, \cdots, X_{n}$取到样本值$x_{1}, x_{2}, \cdots, x_{n}$的概率为
$$

P\left\{X_{1}=x_{1}, X_{2}=x_{2}, \cdots, X_{n}=x_{n}\right\}=\prod_{i=1}^{n} P\left\{X_{i}=x_{i}\right\}=\prod_{i=1}^{n} p\left(x_{i} ; \theta\right),

$$
它是参数$\theta$的函数，对于不同的$\theta$，这一概率是不相同的。记
$$

L(\theta)=L\left(\theta ; x_{1}, x_{2}, \cdots, x_{n}\right)=\prod_{i=1}^{n} p\left(x_{i} ; \theta\right) .

$$
我们称$L(\theta)$为似然函数(likelihood function)，其形式和样本的联合分布律$p(x_{1}, x_{2}, \cdots, x_{n} ; \theta)$相同，但似然函数$L(\theta)$是在样本值给定时关于参数$\theta$的函数，而样本的联合分布律$p(x_{1}, x_{2}, \cdots, x_{n} ; \theta)$则是在参数给定时关于样本值的函数。基于极大似然法的基本思想，我们应选取$\theta$的估计值$\widehat{\theta}$使得$L(\theta)$取到最大，于是$\widehat{\theta}$需满足
$$

L(\hat{\theta})=L\left(\hat{\theta} ; x_{1}, x_{2}, \cdots, x_{n}\right)=\max _{\theta \in \Theta} L\left(\theta ; x_{1}, x_{2}, \cdots, x_{n}\right), \quad(7.1.2)

$$
由此获得的$\widehat{\theta}=\widehat{\theta}(x_{1}, x_{2}, \cdots, x_{n})$称为参数$\theta$的极大似然估计值，相应的统计量$\widehat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$称为$\theta$的极大似然估计量(maximum likelihood estimation, 简记为MLE)。

当$X$为连续型总体时，设其密度函数为$f(x ; \theta)$，$\theta \in \Theta$是未知的待估参数，$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本，并设$x_{1}, x_{2}, \cdots, x_{n}$是已经得到的样本值。此时，似然函数可定义为
$$

L(\theta)=L\left(\theta ; x_{1}, x_{2}, \cdots, x_{n}\right)=\prod_{i=1}^{n} f\left(x_{i} ; \theta\right),

$$
形式与样本的联合密度函数$f(x_{1}, x_{2}, \cdots, x_{n} ; \theta)$相同，而参数$\theta$的极大似然估计值$\widehat{\theta}(x_{1}, x_{2}, \cdots, x_{n})$由(7.1.2)式确定，极大似然估计量为相应的统计量$\widehat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$。

寻求极大似然估计常常用微分法，有
$$

\left.\frac{d L(\theta)}{d \theta}\right|_{\theta=\hat{\theta}}=0, (7.1.3)

$$
通常称(7.1.3)为似然方程(likelihood equation)。为计算方便，往往对似然函数求对数，记为
$$

l(\theta)=\ln L(\theta),

$$
称$l(\theta)$为对数似然函数(log-likelihood function)。则方程(7.1.3)等价于
$$

\left.\frac{d l(\theta)}{d \theta}\right|_{\theta=\hat{\theta}}=0, \quad(7.1.4)

$$
称(7.1.4)为对数似然方程(log-likelihood equation)。

**注**：若总体分布含有多个待估参数，可将上文中的$\theta$看成向量，(7.1.3)和(7.1.4)需要对每个参数求偏导数，建立含多个式子的似然方程（或对数似然方程）。

**例7.1.6** 设总体$X$服从泊松分布$P(\lambda)$，其中$\lambda$是未知参数，若$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本，求参数$\lambda$的极大似然估计量。

解：设$x_{1}, x_{2}, \cdots, x_{n}$是样本$X_{1}, X_{2}, \cdots, X_{n}$的一组观测值，则泊松分布的似然函数为
$$

L(\lambda)=\prod_{i=1}^{n} p\left(x_{i} ; \lambda\right)=\prod_{i=1}^{n} \frac{\lambda^{x_{i}}}{x_{i} !} e^{-\lambda}=\frac{\lambda^{\sum_{i=1}^{n} x_{i}}}{\prod_{i=1}^{n} x_{i} !} e^{-n \lambda},

$$
相应的对数似然函数为
$$

l(\lambda)=\left(\sum_{i=1}^{n} x_{i}\right) \ln \lambda-\sum_{i=1}^{n} \ln x_{i} !-n \lambda .

$$
对$\lambda$求导并令其等于0，即
$$

\left.\frac{d l(\lambda)}{d \lambda}\right|_{\lambda=\hat{\lambda}}=0,

$$
上述方程有唯一解
$$

\hat{\lambda}=\frac{1}{n} \sum_{i=1}^{n} x_{i}=\overline{x}

$$
因此，参数$\lambda$的极大似然估计量为
$$

\hat{\lambda}=\frac{1}{n} \sum_{i=1}^{n} X_{i}=\overline{X}

$$

**例7.1.7** 设总体$X$服从正态分布$N(\mu, \sigma^{2})$，$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本。
(1) 若$\mu$未知，$\sigma^{2}=1$，求参数$\mu$的极大似然估计量；
(2) 若$\sigma^{2}$未知，$\mu=1$，求参数$\sigma^{2}$的极大似然估计量；
(3) 若$\mu$，$\sigma^{2}$均未知，求参数$\mu$，$\sigma^{2}$的极大似然估计量。

解：设$x_{1}, x_{2}, \cdots, x_{n}$是$X_{1}, X_{2}, \cdots, X_{n}$的一组观测值。

(1) 当$\sigma^{2}=1$时，似然函数为
$$

L(\mu)=(2 \pi)^{-\frac{n}{2}} \exp \left[-\frac{1}{2} \sum_{i=1}^{n}\left(x_{i}-\mu\right)^{2}\right],

$$
相应的对数似然函数为
$$

l(\mu)=-\frac{n}{2} \ln (2 \pi)-\frac{1}{2} \sum_{i=1}^{n}\left(x_{i}-\mu\right)^{2} .

$$
对$\mu$求导并令其等于0，即
$$

\left.\frac{d l(\mu)}{d \mu}\right|_{\mu=\hat{\mu}}=\sum_{i=1}^{n}\left(x_{i}-\hat{\mu}\right)=0,

$$
解之得
$$

\hat{\mu}=\frac{1}{n} \sum_{i=1}^{n} x_{i}=\overline{x} .

$$
因此，参数$\mu$的极大似然估计量为
$$

\hat{\mu}=\overline{X} .

$$

(2) 当$\mu=1$时，似然函数为
$$

L\left(\sigma^{2}\right)=\left(2 \pi \sigma^{2}\right)^{-\frac{n}{2}} \exp \left[-\frac{1}{2 \sigma^{2}} \sum_{i=1}^{n}\left(x_{i}-1\right)^{2}\right],

$$
相应的对数似然函数为
$$

l\left(\sigma^{2}\right)=-\frac{n}{2} \ln \left(2 \pi \sigma^{2}\right)-\frac{1}{2 \sigma^{2}} \sum_{i=1}^{n}\left(x_{i}-1\right)^{2} .

$$
对$\sigma^{2}$求导并令其等于0，即
$$

\left.\frac{d l\left(\sigma^{2}\right)}{d \sigma^{2}}\right|_{\sigma^{2}=\hat{\sigma}^{2}}=-\frac{n}{2 \hat{\sigma}^{2}}+\frac{1}{2 \hat{\sigma}^{4}} \sum_{i=1}^{n}\left(x_{i}-1\right)^{2}=0,

$$
解之得
$$

\hat{\sigma}^{2}=\frac{1}{n} \sum_{i=1}^{n}\left(x_{i}-1\right)^{2} .

$$
因此，参数$\sigma^{2}$的极大似然估计量为
$$

\hat{\sigma}^{2}=\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-1\right)^{2} .

$$

(3) 当$\mu$，$\sigma^{2}$均未知时，似然函数为
$$

L(\mu ,\sigma ^{2})=(2\pi \sigma ^{2})^{-\frac {n}{2}}\exp \left[ -\frac {1}{2\sigma ^{2}}\sum _{i=1}^{n}(x_{i}-\mu )^{2}\right] ,

$$
相应的对数似然函数为
$$

l\left(\mu, \sigma^{2}\right)=-\frac{n}{2} \ln \left(2 \pi \sigma^{2}\right)-\frac{1}{2 \sigma^{2}} \sum_{i=1}^{n}\left(x_{i}-\mu\right)^{2} .

$$
将$l(\mu, \sigma^{2})$分别关于$\mu$，$\sigma^{2}$求偏导数，得
$$

\left\{
\begin{array}{l} 
\frac{\partial l\left(\mu, \sigma^{2}\right)}{\partial \mu}=\frac{1}{\sigma^{2}} \sum_{i=1}^{n}\left(x_{i}-\mu\right), \\ 
\frac{\partial l\left(\mu, \sigma^{2}\right)}{\partial \sigma^{2}}=-\frac{n}{2 \sigma^{2}}+\frac{1}{2 \sigma^{4}} \sum_{i=1}^{n}\left(x_{i}-\mu\right)^{2} .
\end{array}
\right.

$$
令偏导数等于0，即
$$

\left\{
\begin{array}{l} 
\left.\frac{\partial l\left(\mu, \sigma^{2}\right)}{\partial \mu}\right|_{\mu=\hat{\mu}, \sigma^{2}=\hat{\sigma}^{2}}=0, \\ 
\left.\frac{\partial l\left(\mu, \sigma^{2}\right)}{\partial \sigma^{2}}\right|_{\mu=\hat{\mu}, \sigma^{2}=\hat{\sigma}^{2}}=0,
\end{array}
\right.

$$
解之得
$$

\hat{\mu}=\frac{1}{n} \sum_{i=1}^{n} x_{i}=\overline{x}, \hat{\sigma}^{2}=\frac{1}{n} \sum_{i=1}^{n}\left(x_{i}-\overline{x}\right)^{2} .

$$
因此，参数$\mu$，$\sigma^{2}$的极大似然估计量为
$$

\hat{\mu}=\overline{X}, \hat{\sigma}^{2}=\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\overline{X}\right)^{2} .

$$

**注**：根据极大值的充分条件，还需验证似然函数（或对数似然函数）关于待估参数的二阶导数是否小于零。利用微分知识，可以验证上述例子中似然方程的解满足该条件。

当似然方程的解不存在时，我们往往根据似然函数关于待估参数的单调性来求其极大似然估计。

**例7.1.8** 设总体$X$服从区间$[a, b]$上的均匀分布，其中$a<b$未知，若$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本，请求参数$a$，$b$的极大似然估计量。

解：设$x_{1}, x_{2}, \cdots, x_{n}$是$X_{1}, X_{2}, \cdots, X_{n}$的一组观测值，则样本的似然函数为
$$

L(a, b)=\prod _{i=1}^{n} f\left(x_{i} ; a, b\right)= 
\begin{cases}
\frac{1}{(b-a)^{n}}, & a \leq x_{i} \leq b, i=1,2, \cdots, n, \\ 
0, & 其他 .
\end{cases}

$$
根据极大似然估计的定义，为使$L(a, b)$达到最大，则$b-a$应该尽可能小，而$b$不能小于$\max\{x_{1}, x_{2}, \cdots, x_{n}\}$，$a$不能大于$\min\{x_{1}, x_{2}, \cdots, x_{n}\}$，否则$L(a, b)=0$。因此，$a$和$b$的极大似然估计量分别为
$$

\hat{a}=\min \left\{X_{1}, X_{2}, \cdots, X_{n}\right\}, \hat{b}=\max \left\{X_{1}, X_{2}, \cdots, X_{n}\right\} .

$$

**极大似然估计的不变性**：设参数$\theta$的极大似然估计为$\widehat{\theta}$，$\theta^{*}=g(\theta)$是$\theta$的连续函数，则参数$\theta^{*}$的极大似然估计为$\widehat{\theta}^{*}=g(\widehat{\theta})$。

**例7.1.9** 设$X_{1}, X_{2}, \cdots, X_{n}$是来自正态总体$X \sim N(\mu, \sigma^{2})$的样本，求$P\{X>1\}$的极大似然估计量。

解：记$p=P\{X>1\}$，则
$$

p=1-\Phi\left(\frac{1-\mu}{\sigma}\right)

$$
根据极大似然估计的不变性和例7.1.7的结果可得概率$P\{X>1\}$的极大似然估计量为
$$

\hat{p}=1-\Phi\left(\frac{1-\overline{X}}{\sqrt{B_{2}}}\right) .

$$

费希尔证明了，在一定的正则条件下，极大似然估计依概率收敛于相应的参数，且满足渐近正态分布，这里不做详细叙述，读者可参见相关的数理统计教材。

## 7.2 估计量的评价准则
从上一节的讨论可知，对总体的同一参数，采用不同的估计方法得到的估计量可能是不一样的，在实际中如何选择“较好”的估计量呢？如何评价估计量的优劣呢？本节将介绍四个评价准则：无偏性(unbiasedness)准则、有效性(efficiency)准则、均方误差(mean square error)准则和相合性(consistency)准则。

### (一) 无偏性准则
估计量本身是统计量，其取值随着样本值的改变而改变，因此我们不能根据某次抽样的结果来衡量估计量的好坏，一个自然评价标准是要求估计量无系统偏差，即要求在大量重复抽样时，所有估计值的平均应与待估参数的真值相同，这就是无偏性准则，具体定义如下。

**定义7.2.1** 设$\theta \in \Theta$是总体$X$的待估参数，$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本。若估计量$\widehat{\theta}=\widehat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$的数学期望存在，且满足
$$

E(\hat{\theta})=\theta, \forall \theta \in \Theta,

$$
则称$\widehat{\theta}$是$\theta$的无偏估计量或无偏估计(unbiased estimator)。

若$E(\widehat{\theta}) \neq\theta$，则称$E(\widehat{\theta})-\theta$为估计量$\widehat{\theta}$的偏差(bias)。

若$E(\widehat{\theta}) \neq\theta$，但满足$\lim _{n \to +\infty} E(\widehat{\theta})=\theta$，则称$\widehat{\theta}$是$\theta$的渐近无偏估计(asymptotic unbiased estimator)。

**例7.2.1** 设总体$X$的均值$\mu$和方差$\sigma^{2}$存在，$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本，证明：
(1) 样本均值$\bar{X}$和方差$S^{2}$分别为$\mu$和$\sigma^{2}$的无偏估计；
(2) $B_{2}$是$\sigma^{2}$的渐近无偏估计；
(3) $\mu^{*}=\sum_{i=1}^{n} c_{i} X_{i}$（其中权系数满足$\sum_{i=1}^{n} c_{i}=1$）也是$\mu$的无偏估计。

证明：(1) 由$X_{1}, X_{2}, \cdots, X_{n}$与$X$同分布且相互独立，得
$$

E(\overline{X})=E\left( \frac{1}{n}\sum_{i=1}^{n}X_{i}\right) = \frac{1}{n}\sum_{i=1}^{n}E\left( X_{i}\right) =E(X)=\mu ,

$$
$$

Var(\overline{X})=Var\left( \frac{1}{n}\sum_{i=1}^{n}X_{i}\right) = \frac{1}{n^{2}}\sum_{i=1}^{n}Var\left( X_{i}\right) = \frac{\sigma^{2}}{n}

$$
$$

\begin{aligned} 
E\left(S^{2}\right) & =E\left[\frac{1}{n-1} \sum_{i=1}^{n}\left(X_{i}-\overline{X}\right)^{2}\right] \\ 
& =\frac{1}{n-1} E\left(\sum_{i=1}^{n} X_{i}^{2}-n \overline{X}^{2}\right) \\ 
& =\frac{1}{n-1}\left[\sum_{i=1}^{n} E\left(X_{i}^{2}\right)-n E\left(\overline{X}^{2}\right)\right] \\ 
& =\frac{1}{n-1}\left[\sum_{i=1}^{n}\left(\mu^{2}+\sigma^{2}\right)-n\left(\mu^{2}+\frac{\sigma^{2}}{n}\right)\right]=\sigma^{2} .
\end{aligned}

$$
因此，样本均值$\bar{X}$和方差$S^{2}$分别为$\mu$和$\sigma^{2}$的无偏估计。

(2) 若取$\sigma^{2}$的估计量为$B_{2}=\frac{1}{n} \sum_{i=1}^{n}(X_{i}-\bar{X})^{2}$，则有$E(B_{2})=\frac{n-1}{n} \sigma^{2} \neq\sigma^{2}$，但满足
$$

\lim _{n \to+\infty} E\left(B_{2}\right)=\sigma^{2},

$$
因此$B_{2}$是$\sigma^{2}$的渐近无偏估计。

(3) 若取$\mu$的估计量为$\mu^{*}=\sum_{i=1}^{n} c_{i} X_{i}$（其中权系数满足$\sum_{i=1}^{n} c_{i}=1$），则
$$

E(\mu^{*})=\sum_{i=1}^{n} c_{i} E(X_{i})=\mu,

$$
所以$\mu^{*}$也是总体均值$\mu$的无偏估计，我们称$\mu^{*}$为参数$\mu$的线性无偏估计。

**例7.2.2** 设总体$X$的均值为1，方差$\sigma^{2}$存在，$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本，判断$\sigma^{2}$的三个估计量$\widehat{\sigma}_{1}^{2}=S^{2}$、$\widehat{\sigma}_{2}^{2}=A_{2}-1$、$\widehat{\sigma}_{3}^{2}=\frac{1}{n} \sum_{i=1}^{n}(X_{i}-1)^{2}$是否为$\sigma^{2}$的无偏估计。

解：由例7.2.1，$\widehat{\sigma}_{1}^{2}$是$\sigma^{2}$的无偏估计。注意到
$$

\sigma^{2}=E\left[(X-1)^{2}\right]=E\left(X^{2}\right)-1,

$$
所以$\widehat{\sigma}_{2}^{2}$与$\widehat{\sigma}_{3}^{2}$均是$\sigma^{2}$的无偏估计。

### (二) 有效性准则
在有些情况下，同一总体参数的无偏估计是不唯一的。为比较两个无偏估计量的好坏，我们需进一步考察估计量取值的波动性，即估计量的方差。无偏估计量的方差越小，说明该估计量的取值越集中在参数真值的附近。

**定义7.2.2** 设$\widehat{\theta}_{1}=\widehat{\theta}_{1}(X_{1}, X_{2}, \cdots, X_{n})$与$\widehat{\theta}_{2}=\widehat{\theta}_{2}(X_{1}, X_{2}, \cdots, X_{n})$都是参数$\theta$的无偏估计，若$\forall \theta \in \Theta$，$Var_{\theta}(\widehat{\theta}_{1}) \leq Var_{\theta}(\widehat{\theta}_{2})$且至少有一个$\theta \in \Theta$使不等号成立，则称$\widehat{\theta}_{1}$比$\widehat{\theta}_{2}$有效。

**例7.2.3**（例7.2.1续）讨论总体均值$\mu$的线性无偏估计$\mu^{*}$的有效性。

解：由于
$$

Var\left(\mu^{*}\right)=\sigma^{2} \sum_{i=1}^{n} c_{i}^{2},

$$
且满足$\sum_{i=1}^{n} c_{i}=1$，根据柯西施瓦茨不等式，在有关总体均值$\mu$的所有线性无偏估计$\sum_{i=1}^{n} c_{i} X_{i}$（$\sum_{i=1}^{n} c_{i}=1$）中，当$c_{1}=c_{2}=\cdots=c_{n}=\frac{1}{n}$时，$Var(\mu^{*})$达到最小，即样本均值$\bar{X}$是总体均值$\mu$的所有线性无偏估计中方差最小的估计，有时也称之为最有效线性无偏估计。

**例7.2.4** 设总体$X$服从区间$[0, \theta]$上的均匀分布，其中$\theta>0$未知。若$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本，请求参数$\theta$的矩估计量和极大似然估计量，并讨论估计量的无偏性和有效性。

解：由$E(X)=\frac{\theta}{2}$可得$\theta$的矩估计量为$\widehat{\theta}_{1}=2 \bar{X}$，且
$$

E\left(\hat{\theta}_{1}\right)=E(2 \overline{X})=2 E(X)=2 \cdot \frac{\theta}{2}=\theta,

$$
因此$\widehat{\theta}_{1}$是$\theta$的无偏估计。

根据例7.1.8，参数$\theta$的极大似然估计量为
$$

\hat{\theta}=X_{(n)}=\max \left\{X_{1}, X_{2}, \cdots, X_{n}\right\} .

$$
为考察$\widehat{\theta}$的无偏性，先求$X_{(n)}$的分布，由3.5节的知识，可求得$X_{(n)}$的分布函数为
$$

F_{n}(x)=(F(x))^{n}= 
\begin{cases}
0, & x<0, \\ 
\left(\frac{x}{\theta}\right)^{n}, & 0 \leq x \leq \theta, \\ 
1, & x>\theta .
\end{cases}

$$
所以，$X_{(n)}$的密度函数为
$$

f_{n}(x)= 
\begin{cases}
\frac{n x^{n-1}}{\theta^{n}}, & 0 \leq x \leq \theta, \\ 
0, & 其他,
\end{cases}

$$
则有
$$

E(\hat{\theta})=E\left(X_{(n)}\right)=\int_{0}^{\theta} \frac{n x^{n}}{\theta^{n}} d x=\frac{n}{n+1} \theta \neq \theta,

$$
因此$\widehat{\theta}$不是$\theta$的无偏估计。但我们可以对$\widehat{\theta}$进行修正，令$\widehat{\theta}_{2}=\frac{n+1}{n} \widehat{\theta}=\frac{n+1}{n} X_{(n)}$，则$\widehat{\theta}_{2}$也是$\theta$的无偏估计。

下面比较$\widehat{\theta}_{1}$与$\widehat{\theta}_{2}$的有效性。
$$

Var\left(\hat{\theta}_{1}\right)=Var(2 \overline{X})=4 Var(\overline{X})=\frac{4 Var(X)}{n}=\frac{\theta^{2}}{3 n} .

$$
由$X_{(n)}$的密度函数可计算得
$$

Var\left(\hat{\theta}_{2}\right)=\frac{\theta^{2}}{n(n+2)} .

$$
显然，当$n \geq2$时，$Var(\widehat{\theta}_{2})<Var(\widehat{\theta}_{1})$，因此$\widehat{\theta}_{2}$比$\widehat{\theta}_{1}$有效。

### *(三) 均方误差准则
**定义7.2.3** 设$\widehat{\theta}=\widehat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$是总体参数$\theta$的估计量，称$E[(\widehat{\theta}-\theta)^{2}]$是估计量$\widehat{\theta}$的均方误差，记为$Mse(\widehat{\theta})$。

设$\widehat{\theta}_{1}$与$\widehat{\theta}_{2}$都是$\theta$的估计量，若对于任意$\theta \in \Theta$，$Mse(\widehat{\theta}_{1}) \leq Mse(\widehat{\theta}_{2})$，且至少存在某个$\theta$使得不等号成立，则称在均方误差准则下，$\widehat{\theta}_{1}$优于$\widehat{\theta}_{2}$。

由定义可知，若$\widehat{\theta}$是参数$\theta$的无偏估计量，则$Mse(\widehat{\theta})=Var(\widehat{\theta})$。均方误差准则常用于有偏估计之间，或有偏估计与无偏估计之间的比较。若仅限于无偏估计之间的比较，则等价于有效性准则。

**例7.2.5** 设$X_{1}, X_{2}, \cdots, X_{n}(n \geq2)$是来自正态总体$X \sim N(\mu, \sigma^{2})$的样本，由前面讨论知，样本方差$S^{2}$是参数$\sigma^{2}$的无偏估计，而样本二阶中心矩$B_{2}$是$\sigma^{2}$的有偏估计，根据均方误差准则对这两个估计量作出评价。

解：由$S^{2}$的无偏性和$\frac{(n-1) S^{2}}{\sigma^{2}} \sim \chi^{2}(n-1)$，求得$S^{2}$的均方误差
$$

Mse\left(S^{2}\right)=Var\left(S^{2}\right)=\frac{2 \sigma^{4}}{n-1} . (7.2.1)

$$
下面计算$B_{2}$的均方误差：
$$

\begin{aligned} 
Mse\left(B_{2}\right) & =E\left[\left(B_{2}-\sigma^{2}\right)^{2}\right]=E\left(B_{2}^{2}\right)-2 \sigma^{2} E\left(B_{2}\right)+\sigma^{4} \\ 
& =\frac{(n-1)^{2}}{n^{2}}\left[Var\left(S^{2}\right)+\left(E\left(S^{2}\right)\right)^{2}\right]-\frac{2(n-1)}{n} \sigma^{2} E\left(S^{2}\right)+\sigma^{4} \\ 
& =\frac{2 n-1}{n^{2}} \sigma^{4} .
\end{aligned}

$$
显然对任何$n \geq2$有$\frac{2}{n-1}>\frac{2 n-1}{n^{2}}$，即$Mse(B_{2})<Mse(S^{2})$，因此根据均方误差准则，以$B_{2}$作为$\sigma^{2}$的估计量要比$S^{2}$更优。

**例7.2.6** 计算例7.2.4中$\theta$的矩估计量与极大似然估计量的均方误差（$n \geq3$），并在均方误差准则下比较哪个估计量更优。

解：由例7.2.4，$\theta$的矩估计量$\widehat{\theta}_{1}=2 \bar{X}$是$\theta$的无偏估计，因此
$$

Mse\left(\hat{\theta}_{1}\right)=Var\left(\hat{\theta}_{1}\right)=\frac{\theta^{2}}{3 n} .

$$
极大似然估计量$\widehat{\theta}=X_{(n)}=\max\{X_{1}, X_{2}, \cdots, X_{n}\}$不是$\theta$的无偏估计，所以先计算$E(\hat{\theta})$和$E(\hat{\theta}^{2})$：
$$

E(\hat{\theta})=\frac{n \theta}{n+1}, E\left(\hat{\theta}^{2}\right)=\frac{n \theta^{2}}{n+2} .

$$
于是
$$

Mse(\hat{\theta})=E\left[(\hat{\theta}-\theta)^{2}\right]=E\left(\hat{\theta}^{2}\right)-2 \theta E(\hat{\theta})+\theta^{2}=\frac{2 \theta^{2}}{(n+1)(n+2)} .

$$
计算$Mse\left(\hat{\theta}_{1}\right)-Mse(\hat{\theta})$：
$$

Mse\left(\hat{\theta}_{1}\right)-Mse(\hat{\theta})=\frac{(n-1)(n-2) \theta^{2}}{3 n(n+1)(n+2)}>0,

$$
即在均方误差准则下，$\widehat{\theta}$优于$\widehat{\theta}_{1}$。

在实际应用中，均方误差准则比无偏性准则更重要，即如果一个估计量虽然有偏，但其均方误差较小，有时比方差很大的无偏估计更有用。

### *(四) 相合性准则
前面三个准则都是在样本容量$n$固定的情况下讨论的。然而，由于估计量$\widehat{\theta}$依赖于样本容量$n$，自然会想到，一个好的估计量，当样本容量越大时，应该越精确越可靠，特别是当$n \to +\infty$时，估计量的取值与参数值应几乎完全一致，这就是估计量的相合性（或一致性）。相合性的严格定义如下。

**定义7.2.4** 设$\widehat{\theta}_{n}=\widehat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$是总体参数$\theta$的估计量，若对任意$\varepsilon>0$，有
$$

\lim _{n \to+\infty} P\left\{\left|\hat{\theta}_{n}-\theta\right|<\varepsilon\right\}=1,

$$
即$\widehat{\theta}_{n}$依概率收敛于$\theta$，则称$\widehat{\theta}_{n}$是$\theta$的相合估计量(consistent estimator)，并记为$\widehat{\theta}_{n} \stackrel{P}{\to } \theta$，$n \to +\infty$。

一般地，由矩法求得的参数估计量都满足相合性，对于极大似然估计，在总体分布满足一定的条件下，求得的估计量也是待估参数的相合估计量。

**例7.2.7** $X_{1}, X_{2}, \cdots, X_{n}$是来自均匀分布$U(0, \theta)$的样本，证明由例7.2.4给出的三个估计量$\widehat{\theta}_{1}$，$\widehat{\theta}$和$\widehat{\theta}_{2}$都是参数$\theta$的相合估计量。

证明：由辛钦大数定律知，当$n \to +\infty$时，$\bar{X} \stackrel{P}{\to } E(X)=\frac{\theta}{2}$，所以
$$

\hat{\theta}_{1}=2 \overline{X} \stackrel{P}{\to} \theta .

$$
即$\widehat{\theta}_{1}$是$\theta$的相合估计量。

根据例7.2.4的结果，有
$$

E\left(\hat{\theta}_{2}\right)=\theta, Var\left(\hat{\theta}_{2}\right)=\frac{\theta^{2}}{n(n+2)} .

$$
根据切比雪夫不等式，对任意$\varepsilon>0$，有
$$

1 \geq P\left\{\left|\hat{\theta}_{2}-\theta\right|<\varepsilon\right\} \geq 1-\frac{Var\left(\hat{\theta}_{2}\right)}{\varepsilon^{2}}=1-\frac{\theta^{2}}{n(n+2) \varepsilon^{2}} \to 1, n \to+\infty .

$$
因此$\widehat{\theta}_{2}$也是参数$\theta$的相合估计量。

由马尔可夫不等式，对任意$\varepsilon>0$有
$$

P\{|\hat{\theta}-\theta|<\varepsilon\} \geq 1-\frac{E(|\theta-\hat{\theta}|)}{\varepsilon} .

$$
由于$\widehat{\theta}<\theta$，所以
$$

E(|\hat{\theta}-\theta|)=E(\theta-\hat{\theta})=\frac{\theta}{n+1} .

$$
从而
$$

1 \geq P\{|\hat{\theta}-\theta|<\varepsilon\} \geq 1-\frac{\theta}{(n+1) \varepsilon} \to 1, n \to+\infty,

$$
故$\widehat{\theta} \stackrel{P}{\to } \theta$，即$\widehat{\theta}$也是$\theta$的相合估计量。

## 7.3 区间估计
人们常常根据点估计对总体参数作出判断，但这种判断的把握有多大？可信度有多高？点估计无法回答这些问题，统计学家为了弥补此种不足，提出了区间估计。

### (一) 置信区间的定义
**定义7.3.1** 设总体为$X$，$\theta \in \Theta$为待估参数。$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本，统计量$\widehat{\theta}_{L}=\widehat{\theta}_{L}(X_{1}, X_{2}, \cdots, X_{n})$和$\widehat{\theta}_{U}=\widehat{\theta}_{U}(X_{1}, X_{2}, \cdots, X_{n})$满足$\widehat{\theta}_{L}<\widehat{\theta}_{U}$，且对给定的$\alpha \in(0,1)$和任意的$\theta \in \Theta$，有
$$

P\left\{\hat{\theta}_{L}<\theta<\hat{\theta}_{U}\right\} \geq 1-\alpha, (7.3.1)

$$
则称随机区间$(\widehat{\theta}_{L}, \widehat{\theta}_{U})$是参数$\theta$的置信水平(confidence level)为$1-\alpha$的置信区间(confidence interval)，$\widehat{\theta}_{L}$和$\widehat{\theta}_{U}$分别称为$\theta$的置信水平是$1-\alpha$的双侧置信下限(lower confidence limit)和置信上限(upper confidence limit)。

称区间的平均长度$E(\widehat{\theta}_{U}-\widehat{\theta}_{L})$为置信区间$(\widehat{\theta}_{L}, \widehat{\theta}_{U})$的精确度，并称二分之一区间平均长度为置信区间的误差限(error limit)。由定义可知，当样本容量$n$给定时，置信水平和精确度是相互制约的。英国统计学家奈曼(Neyman)建议：在保证置信水平达到一定的前提下，尽可能提高精确度。人们常称该建议为奈曼原则。如果要同时提高置信水平和精确度，只有增大样本容量才能得以实现。

根据奈曼原则，当总体$X$是连续型随机变量时，对于给定的置信水平$1-\alpha$，我们应选择使(7.3.1)刚好等号成立时，即
$$

P\left\{\hat{\theta}_{L}<\theta<\hat{\theta}_{U}\right\}=1-\alpha \quad(7.3.2)

$$
的随机区间$(\widehat{\theta}_{L}, \widehat{\theta}_{U})$作为参数$\theta$的置信区间；而当总体$X$是离散型随机变量时，则应选择使$P\{\widehat{\theta}_{L}<\theta<\widehat{\theta}_{U}\} \geq1-\alpha$且尽可能接近$1-\alpha$的随机区间$(\widehat{\theta}_{L}, \widehat{\theta}_{U})$作为参数$\theta$的置信区间。

置信区间$(\widehat{\theta}_{L}, \widehat{\theta}_{U})$是一个随机区间，对某次具体样本观测来说，有时包含了参数$\theta$，有时不包含$\theta$，但此随机区间包含$\theta$的可能性至少为$1-\alpha$。我们可以理解为：给定样本容量$n$，若反复抽样多次，每个样本确定一个区间$(\widehat{\theta}_{L}, \widehat{\theta}_{U})$，每个区间要么包含$\theta$的真值要么不包含$\theta$的真值（如图7.3.1所示）。根据伯努利大数定律，在所有这样的区间中，至少有$100(1-\alpha) \%$的区间包含$\theta$的真值。在实际应用中，通常取$\alpha=0.1$或0.05。

在一些实际问题中，人们感兴趣的仅仅是未知参数的置信下限或置信上限。譬如，日光灯的平均寿命要越大越好，人们往往关心其平均寿命的置信下限；而药品的毒性则越小越好，往往较关心其毒性的置信上限，对这些问题，我们只需给出单侧的置信限形式。

**定义7.3.2** 对给定的$\alpha \in(0,1)$，如果统计量$\widehat{\theta}_{L}$和$\widehat{\theta}_{U}$满足
$$

P\left\{\hat{\theta}_{L}<\theta\right\} \geq 1-\alpha, \theta \in \Theta ;

$$
$$

P\left\{\theta<\hat{\theta}_{U}\right\} \geq 1-\alpha, \theta \in \Theta,

$$
那么分别称$\widehat{\theta}_{L}$和$\widehat{\theta}_{U}$是参数$\theta$的置信水平为$1-\alpha$的单侧置信下限(one-sided lower confidence limit)和单侧置信上限(one-sided upper confidence limit)。

当总体$X$是连续型随机变量时，应选择$\widehat{\theta}_{L}$和$\widehat{\theta}_{U}$使
$$

P\left\{\hat{\theta}_{L}<\theta\right\}=1-\alpha 和 P\left\{\hat{\theta}_{U}>\theta\right\}=1-\alpha, \theta \in \Theta.

$$

根据定义7.3.1和7.3.2，很容易得到单侧置信限和置信区间有下列关系。

**引理7.3.1** 设统计量$\widehat{\theta}_{L}$和$\widehat{\theta}_{U}$分别是参数$\theta$的置信水平为$1-\alpha_{1}$和$1-\alpha_{2}$的单侧置信下限、单侧置信上限，且$\widehat{\theta}_{L}<\widehat{\theta}_{U}$，那么$(\widehat{\theta}_{L}, \widehat{\theta}_{U})$是$\theta$的置信水平为$1-\alpha_{1}-\alpha_{2}$的置信区间。

证明：由引理的假设条件有
$$

P\left\{\hat{\theta}_{L}<\theta\right\} \geq 1-\alpha_{1}, P\left\{\theta<\hat{\theta}_{U}\right\} \geq 1-\alpha_{2} .

$$
根据事件的关系和概率性质，可得
$$

P\left\{\hat{\theta}_{L}<\theta<\hat{\theta}_{U}\right\}=1-P\left\{\theta \leq \hat{\theta}_{L}\right\}-P\left\{\theta \geq \hat{\theta}_{U}\right\} \geq 1-\alpha_{1}-\alpha_{2} .

$$

下面我们介绍置信区间的一种求解方法——枢轴量法。

### (二) 枢轴量法
首先，我们给出枢轴量的定义。

**定义7.3.3** 设总体$X$的密度函数（或概率分布律）为$f(x ; \theta)$，其中$\theta$为待估参数，并设$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本，如果样本和参数$\theta$的函数$G(X_{1}, X_{2}, \cdots, X_{n} ; \theta)$的分布完全已知，且形式上不依赖于其他未知参数，就称$G(X_{1}, X_{2}, \cdots, X_{n} ; \theta)$为枢轴量(pivot)。

我们可以根据下列三个步骤来寻求$\theta$的置信区间：

1. 构造一个分布已知的枢轴量$G(X_{1}, X_{2}, \cdots, X_{n} ; \theta)$。

2. 当总体$X$是连续型随机变量时，对给定的置信水平$1-\alpha$，根据枢轴量$G(X_{1}, X_{2}, \cdots, X_{n} ; \theta)$的分布，适当地选择两个常数$a$和$b$使
$$

P_{\theta}\left\{a<G\left(X_{1}, X_{2}, \cdots, X_{n} ; \theta\right)<b\right\}=1-\alpha . \quad(7.3.3)

$$

2)' 当总体$X$是离散型随机变量时，对给定的置信水平$1-\alpha$，选取常数$a$和$b$满足
$$

P_{\theta}\left\{a<G\left(X_{1}, X_{2}, \cdots, X_{n} ; \theta\right)<b\right\} \geq 1-\alpha 且尽可能接近 1-\alpha. (7.3.4)

$$

3. 假如参数$\theta$可以从$G(X_{1}, X_{2}, \cdots, X_{n} ; \theta)$中分离出来，不等式$a<G(X_{1}, X_{2}, \cdots, X_{n} ; \theta)<b$可以等价地转化为$\widehat{\theta}_{L}<\theta<\widehat{\theta}_{U}$，则对于连续型总体，由(7.3.3)得
$$

P\left\{\hat{\theta}_{L}<\theta<\hat{\theta}_{U}\right\}=1-\alpha ;

$$
对于离散型总体，由(7.3.4)得
$$

P\left\{\hat{\theta}_{L}<\theta<\hat{\theta}_{U}\right\} \geq 1-\alpha,

$$
且尽可能接近$1-\alpha$，这表明$(\widehat{\theta}_{L}, \widehat{\theta}_{U})$是$\theta$的置信水平为$1-\alpha$的置信区间。

一般地，满足(7.3.3)或(7.3.4)的常数$a$和$b$的解是不唯一的。根据奈曼原则，我们应该选择使置信区间$(\widehat{\theta}_{L}, \widehat{\theta}_{U})$的平均长度达到最短的$a$和$b$，但有时要做到这点并非易事，习惯上，我们取$a$和$b$满足
$$

P_{\theta}\left\{G\left(X_{1}, X_{2}, \cdots, X_{n} ; \theta\right) \leq a\right\}=P_{\theta}\left\{G\left(X_{1}, X_{2}, \cdots, X_{n} ; \theta\right) \geq b\right\}=\frac{\alpha}{2} .(7.3.5)

$$

在实际操作中，枢轴量$G(X_{1}, X_{2}, \cdots, X_{n} ; \theta)$的构造，通常会从参数$\theta$的点估计出发，结合估计量的分布，由估计量改造而得。在下一节中，我们将具体介绍如何利用枢轴量法来得到正态总体参数的置信区间。


## 7.4 正态总体参数的区间估计
### （一）单个正态总体情形
设总体 $X \sim N(\mu, \sigma^{2})$，$X_1, X_2, \cdots, X_n$ 是来自总体 $X$ 的样本，$\bar{X}$ 和 $S^{2}$ 分别是样本均值和样本方差，$1-\alpha$ 是给定的置信水平。

#### 1. 均值$\mu$的置信区间
##### （1）$\sigma^{2}$已知
我们取$\mu$的点估计为样本均值$\bar{X}$，根据定理6.3.1，$\bar{X} \sim N\left(\mu, \frac{\sigma^{2}}{n}\right)$，即$\frac{\bar{X}-\mu}{\sigma / \sqrt{n}} \sim N(0,1)$，该分布完全已知。因此，可取枢轴量为：
$$
G(X_{1}, X_{2}, \cdots, X_{n} ; \mu)=\frac{\bar{X}-\mu}{\sigma / \sqrt{n}}
$$
设常数$a < b$，且满足：
$$
P\left\{a<\frac{\bar{X}-\mu}{\sigma / \sqrt{n}}<b\right\}=1-\alpha
$$
即等价于：
$$
P\left\{\bar{X}-b \frac{\sigma}{\sqrt{n}}<\mu<\bar{X}-a \frac{\sigma}{\sqrt{n}}\right\}=1-\alpha
$$
此时，区间的平均长度为$L=(b - a)\frac{\sigma}{\sqrt{n}}$。根据正态分布的对称性可知，当取$a=-b=-z_{\alpha/2}$时，区间的长度$L$最短，从而所对应的$\mu$的置信水平为$1-\alpha$的置信区间为：
$$
\left(\bar{X}-\frac{\sigma}{\sqrt{n}} z_{\alpha / 2}, \bar{X}+\frac{\sigma}{\sqrt{n}} z_{\alpha / 2}\right) \quad (7.4.1)
$$
上式常写成：
$$
\left(\bar{X} \pm \frac{\sigma}{\sqrt{n}} z_{\alpha / 2}\right) \quad (7.4.2)
$$

**例7.4.1** 某袋装食品重量（单位：g）$X \sim N(\mu, 3^{2})$，现从一大批该产品中随机抽取10件，称得重量如下：
101.3 96.6 100.4 98.8 94.6 103.1 102.3 97.5 105.4 100.2
试在置信水平为95%下，求总体均值$\mu$的置信区间。

计算样本均值得$\bar{x}=100.02$。由给定的置信水平95%，利用Excel或查附表2得$z_{0.025}=1.96$，所以$\mu$的置信水平为95%的置信区间为：
$$
\left(\bar{x}-z_{0.025} \sigma / \sqrt{n}, \bar{x}+z_{0.025} \sigma / \sqrt{n}\right) \approx(98.16,101.88)
$$

注意，区间$(98.16,101.88)$不是随机区间，但有时仍称它是置信水平为0.95的置信区间。其含义是：若反复抽样多次（样本容量相同），每个样本值按(7.4.1)确定一个区间，在诸多区间中，包含真值$\mu$的约占95%，不包含真值$\mu$的约占5%。现在抽样得到区间$(98.16,101.88)$，则该区间属于那些包含真值$\mu$的区间的可信程度为95%，因此，我们有95%的把握认为该区间包含真值$\mu$。

在第2章和第6章中，已经介绍如何利用Excel计算各种分布的概率和分位数。实际上，我们还可以利用Excel中的各种统计函数对数据进行统计分析。下面给出例7.4.1在Excel中计算的具体步骤：
1. 先将样本值输入Excel表格中，设数据区域为A1到A10。
2. 利用AVERAGE函数计算样本均值，需给出数据区域。在Excel中选择任一空白单元格（例如选中单元格B1）⇒输入“=AVERAGE(A1:A10)”⇒确定后在单元格B1即可显示均值“100.02”。
3. 利用CONFIDENCE.NORM函数计算误差限，需给出$\alpha$、$\sigma$和$n$三个选项的值。在Excel中选择任一空白单元格（例如选中单元格C1）⇒输入“=CONFIDENCE.NORM(0.05,3,10)”⇒确定后在单元格C1即可显示误差限“1.859385”。
4. 区间估计。在Excel中选择两个空白单元格（例如选中单元格D1、D2）⇒输入“=B1 - C1”和“=B1 + C1”⇒确定后在单元格D1和D2中分别显示98.16061和101.8794，从而$\mu$的置信水平为95%的置信区间为$(98.16,101.88)$。

##### （2）$\sigma^{2}$未知
此时，我们不能取$\frac{\bar{X}-\mu}{\sigma / \sqrt{n}}$为枢轴量，因为其中除含有待估参数$\mu$外，还含有未知参数$\sigma^{2}$。考虑将$\sigma^{2}$的无偏估计量$S^{2}$代入，由定理6.3.3有：
$$
\frac{\bar{X}-\mu}{S / \sqrt{n}} \sim t(n-1)
$$
该分布完全已知，因此，可取枢轴量为：
$$
G(X_{1}, X_{2}, \cdots, X_{n} ; \mu)=\frac{\bar{X}-\mu}{S / \sqrt{n}}
$$
且：
$$
P\left\{\left|\frac{\bar{X}-\mu}{S / \sqrt{n}}\right|<<t_{\alpha / 2}(n-1)\right\}=1-\alpha
$$
即：
$$
P\left\{\bar{X}-\frac{S}{\sqrt{n}} t_{\alpha / 2}(n-1)<\mu<\bar{X}+\frac{S}{\sqrt{n}} t_{\alpha / 2}(n-1)\right\}=1-\alpha
$$
于是求得$\mu$的置信水平为$1-\alpha$的置信区间为：
$$
\left(\bar{X} \pm \frac{S}{\sqrt{n}} t_{\alpha / 2}(n-1)\right)
$$
根据$t$分布的对称性，上述所求得的置信区间平均长度最短，是最优的。

在实际问题中，总体方差$\sigma^{2}$经常是未知的，故上述区间较区间(7.4.2)有更大的实用价值。

**例7.4.2** 设新生儿体重（单位：g）$X \sim N(\mu, \sigma^{2})$，$-\infty<\mu<+\infty$，$\sigma>0$均未知，现测得某妇产医院的16名新生儿体重分别为：
3200 3050 2600 3530 3840 4450 2900 4180
2150 2650 2750 3450 2830 3730 3620 2270
求$\mu$的置信水平为95%的置信区间。

解：查附表3，$t_{0.025}(15)=2.1315$。计算得样本均值$\bar{x}=3200$，样本标准差$s=665.48$。代入上述置信区间公式，得$\mu$的置信水平为95%的置信区间为$(2845.39,3554.61)$。

注：Excel提供了CONFIDENCE.NORM及CONFIDENCE.T函数，它们可分别用于计算正态总体下总体方差已知及未知时的双侧置信区间的误差限。

**例7.4.3** 某种材料的长度（单位：cm）$X \sim N(\mu, \sigma^{2})$，$-\infty<\mu<+\infty$，$\sigma>0$均未知，现随机抽取10件产品进行测量，测得样本均值$\bar{x}=5.78$，样本标准差$s=0.92$，求$\mu$的置信水平为95%的单侧置信下限。

解：取枢轴量为$G(X_{1}, X_{2}, \cdots, X_{n} ; \mu)=\frac{\bar{X}-\mu}{S / \sqrt{n}}$，则有：
$$
P\left\{\frac{\bar{X}-\mu}{S / \sqrt{n}}<<t_{\alpha}(n-1)\right\}=1-\alpha
$$
等价于：
$$
P\left\{\mu>\bar{X}-\frac{S}{\sqrt{n}} t_{\alpha}(n-1)\right\}=1-\alpha
$$
因此，$\mu$的置信水平为95%的单侧置信下限为：
$$
\bar{x}-\frac{s}{\sqrt{n}} t_{0.05}(n-1)=5.78-\frac{0.92}{\sqrt{10}} \times 1.8331 \approx 5.25
$$

##### （3）成对数据情形
成对数据问题在医学和生物研究领域中广泛存在。例如，为了考察某种降压药的效果，测量了$n$个高血压患者在服药前后的血压，结果分别为$(X_{1}, Y_{1})$，$(X_{2}, Y_{2}), \cdots,(X_{n}, Y_{n})$。显然，对同一个患者$X_{i}$和$Y_{i}$是不独立的。另一方面，由于不同患者体质的差异，$X_{1}, X_{2}, \cdots, X_{n}$不能看成来自同一个正态总体的样本，$Y_{1}, Y_{2}, \cdots, Y_{n}$也一样。但差值$D_{i}=X_{i}-Y_{i}$则消除了体质差异，仅与降压药的作用有关，因此我们可以把$D_{i}=X_{i}-Y_{i}$，$i=1,2, \cdots, n$看成来自同一个正态总体$N(\mu_{D}, \sigma_{D}^{2})$的样本，所以，求有关成对数据的均值差$\mu_{1}-\mu_{2}$的置信区间问题可以转化为求单个正态总体均值$\mu_{D}$的置信区间问题。根据前面的推导，可得$\mu_{D}$的置信水平为$1-\alpha$的置信区间为：
$$
\left(\bar{D} \pm t_{\alpha / 2}(n-1) \frac{S_{D}}{\sqrt{n}}\right) \quad (7.4.4)
$$
其中$\bar{D}=\bar{X}-\bar{Y}$，$S_{D}^{2}=\frac{1}{n-1} \sum_{i=1}^{n}\left(D_{i}-\bar{D}\right)^{2}$。

**例7.4.4** 为评价某种训练方法是否能有效提高大学生的立定跳远成绩，在某大学随机选中16名学生，测量他们的立定跳远距离（三次中跳得最远的距离），经过三个月训练后再测量。实验数据如下（单位：cm）：

|编号|1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|训练前|189|211|228|216|212|231|210|198|215|234|234|209|220|195|193|230|
|训练后|201|242|226|220|233|258|228|238|240|221|218|214|236|248|248|230|
|数值差|-12|-31|-2|-4|-21|-27|-18|-40|-25|-13|-16|-5|-16|-53|-55|0|

假设训练前后距离差$D \sim N(\mu_{D}, \sigma_{D}^{2})$，求距离差均值$\mu_{D}$的置信水平为95%的置信区间。

计算得样本均值$\bar{d}=-15.375$，样本标准差$s_{D}=10.544$。查附表3，$t_{0.025}(15)=2.1315$。代入(7.4.4)，得置信水平为95%的置信区间为$(-20.994, -9.756)$。

#### 2. 方差$\sigma^{2}$的区间估计
我们根据实际问题的需要，只介绍$\mu$未知的情形。因为$\sigma^{2}$的无偏估计量为样本方差$S^{2}$，且由定理6.3.2知，$\frac{(n-1) S^{2}}{\sigma^{2}} \sim \chi^{2}(n-1)$，该分布不依赖于任何未知参数，所以可取枢轴量为：
$$
G(X_{1}, X_{2}, \cdots, X_{n} ; \sigma^{2})=\frac{(n-1) S^{2}}{\sigma^{2}}
$$
且有：
$$
P\left\{\chi_{1-\alpha / 2}^{2}(n-1)<\frac{(n-1) S^{2}}{\sigma^{2}}<\chi_{\alpha / 2}^{2}(n-1)\right\}=1-\alpha
$$
即：
$$
P\left\{\frac{(n-1) S^{2}}{\chi_{\alpha / 2}^{2}(n-1)}<\sigma^{2}<\frac{(n-1) S^{2}}{\chi_{1-\alpha / 2}^{2}(n-1)}\right\}=1-\alpha
$$
这样就求得方差$\sigma^{2}$的置信水平为$1-\alpha$的置信区间为：
$$
\left(\frac{(n-1) S^{2}}{\chi_{\alpha / 2}^{2}(n-1)}, \frac{(n-1) S^{2}}{\chi_{1-\alpha / 2}^{2}(n-1)}\right) \quad (7.4.5)
$$

注意，因$\chi^{2}$分布的密度函数是不对称的，故以上所求得的置信区间并不满足区间平均长度最短，但这样的求解可以给实际应用带来很大的方便。

**例7.4.5** （1）求例7.4.2中标准差$\sigma$的置信水平为95%的置信区间；（2）求例7.4.3中标准差$\sigma$的置信水平为95%的单侧置信上限。

解：（1）样本标准差$s=665.48$。查附表4，得$\chi_{0.025}^{2}(15)=27.488$，$\chi_{0.975}^{2}(15)=6.262$。代入(7.4.5)得方差$\sigma^{2}$的置信水平为95%的置信区间为$(241667.435, 1060835.908)$，标准差$\sigma$的置信水平为95%的置信区间为$(491.597, 1029.969)$。

（2）样本标准差$s=0.92$。查附表4，$\chi_{0.95}^{2}(9)=3.325$。方差$\sigma^{2}$的置信水平为95%的单侧置信上限为$\frac{(n-1) s^{2}}{\chi_{0.95}^{2}(9)}=2.291$，标准差$\sigma$的置信水平为95%的单侧置信上限为$\sqrt{\frac{(n-1) s^{2}}{\chi_{0.95}^{2}(9)}}=1.51$。

### （二）两个正态总体情形
设有两个正态总体$X \sim N(\mu_{1}, \sigma_{1}^{2})$和$Y \sim N(\mu_{2}, \sigma_{2}^{2})$，$X_{1}, X_{2}, \cdots, X_{n_1}$为来自总体$X$的样本，$Y_{1}, Y_{2}, \cdots, Y_{n_2}$为来自总体$Y$的样本（$n_{1}, n_{2} \geq2$），两样本相互独立，$\bar{X}$、$\bar{Y}$分别为两样本均值，$S_{1}^{2}$、$S_{2}^{2}$分别为两样本方差。

#### 1. 均值差$\mu_{1}-\mu_{2}$的区间估计
分三种情况讨论。

##### （1）两总体的方差$\sigma_{1}^{2}$和$\sigma_{2}^{2}$已知
我们取$\mu_{1}-\mu_{2}$的无偏估计为$\bar{X}-\bar{Y}$，则由正态分布的性质有：
$$
\bar{X}-\bar{Y} \sim N\left(\mu_{1}-\mu_{2}, \frac{\sigma_{1}^{2}}{n_{1}}+\frac{\sigma_{2}^{2}}{n_{2}}\right)
$$
类似于单个总体均值区间估计的推导，可得$\mu_{1}-\mu_{2}$的置信水平为$1-\alpha$的置信区间为：
$$
\left(\bar{X}-\bar{Y} \pm z_{\alpha / 2} \sqrt{\frac{\sigma_{1}^{2}}{n_{1}}+\frac{\sigma_{2}^{2}}{n_{2}}}\right) \quad (7.4.6)
$$

##### （2）两总体的方差相同，即$\sigma_{1}^{2}=\sigma_{2}^{2}=\sigma^{2}$，但未知
此时我们可取$\sigma^{2}$的无偏估计量为：
$$
S_{w}^{2}=\frac{\left(n_{1}-1\right) S_{1}^{2}+\left(n_{2}-1\right) S_{2}^{2}}{n_{1}+n_{2}-2}
$$
且由定理6.3.4知：
$$
\frac{(\bar{X}-\bar{Y})-\left(\mu_{1}-\mu_{2}\right)}{S_{w} \sqrt{\frac{1}{n_{1}}+\frac{1}{n_{2}}}} \sim t\left(n_{1}+n_{2}-2\right)
$$
仿照上述推导，可得$\mu_{1}-\mu_{2}$的置信水平为$1-\alpha$的置信区间为：
$$
\left(\bar{X}-\bar{Y} \pm t_{\alpha / 2}\left(n_{1}+n_{2}-2\right) S_{w} \sqrt{\frac{1}{n_{1}}+\frac{1}{n_{2}}}\right) \quad (7.4.7)
$$

##### （3）两总体的方差$\sigma_{1}^{2}$和$\sigma_{2}^{2}$不相同且未知
当样本容量$n_{1}$和$n_{2}$充分大时（一般要求大于50），可以证明：
$$
\frac{(\bar{X}-\bar{Y})-\left(\mu_{1}-\mu_{2}\right)}{\sqrt{\frac{S_{1}^{2}}{n_{1}}+\frac{S_{2}^{2}}{n_{2}}}}
$$
渐近服从标准正态分布$N(0,1)$，可得$\mu_{1}-\mu_{2}$的置信水平为$1-\alpha$的近似置信区间为：
$$
\left(\bar{X}-\bar{Y} \pm z_{\alpha / 2} \sqrt{\frac{S_{1}^{2}}{n_{1}}+\frac{S_{2}^{2}}{n_{2}}}\right) \quad (7.4.8)
$$

对于有限小样本，可以证明：
$$
\frac{(\bar{X}-\bar{Y})-\left(\mu_{1}-\mu_{2}\right)}{\sqrt{\frac{S_{1}^{2}}{n_{1}}+\frac{S_{2}^{2}}{n_{2}}}}
$$
近似服从自由度为$k$的$t$分布，其中：
$$
k=\left[\frac{\left(\frac{S_{1}^{2}}{n_{1}}+\frac{S_{2}^{2}}{n_{2}}\right)^{2}}{\frac{\left(S_{1}^{2}\right)^{2}}{n_{1}^{2}\left(n_{1}-1\right)}+\frac{\left(S_{2}^{2}\right)^{2}}{n_{2}^{2}\left(n_{2}-1\right)}}\right]
$$
其中$[\cdot]$表示取整。在实际中，也常用$\min\{n_{1}-1, n_{2}-1\}$近似代替上述自由度$k$，此时$\mu_{1}-\mu_{2}$的置信水平为$1-\alpha$的近似置信区间为：
$$
\left(\bar{X}-\bar{Y} \pm t_{\alpha / 2}(k) \sqrt{\frac{S_{1}^{2}}{n_{1}}+\frac{S_{2}^{2}}{n_{2}}}\right) \quad (7.4.9)
$$

**例7.4.6** 对某学校学生所配戴眼镜的价格进行抽样调查，男生19人，平均价格342元，标准差66.5元；女生17人，平均价格397元，标准差89元，假设两组样本相互独立，都来自正态总体且具有相同方差，试给出男生和女生所配戴眼镜的平均价格差值的置信水平为95%的置信区间。

解：设$\mu_{1}$和$\mu_{2}$分别是男生和女生所配戴眼镜的平均价格。根据已知资料有$n_{1}=19$，$n_{2}=17$，$\bar{x}=342$，$\bar{y}=397$，$s_{1}=66.5$，$s_{2}=89$，得：
$$
s_{w}^{2}=\frac{\left(n_{1}-1\right) s_{1}^{2}+\left(n_{2}-1\right) s_{2}^{2}}{n_{1}+n_{2}-2}=6068.72
$$
利用Excel或查$t$分布表得$t_{0.025}(34)=2.03$。因两总体的方差相同，将上述结果代入(7.4.7)，得$\mu_{1}-\mu_{2}$的置信水平为95%的置信区间为$(-107.80, -2.20)$。

**例7.4.7** 为了解某城镇居民的收入情况，随机抽查了115人，其中受过高等教育的62人，调查得其月平均收入为6516元，样本标准差为409元；未受过高等教育的53人，调查得其月平均收入为3550元，样本标准差为287元。假设两组样本相互独立，且都来自正态总体，试给出两类居民平均收入差值的置信水平为90%的置信区间。

解：设$\mu_{1}$和$\mu_{2}$分别是受过高等教育和未受过高等教育居民的平均收入。因题中没有假设两总体的方差相等，但两样本容量都大于50，故需根据(7.4.8)来求区间估计。

利用Excel或查正态分布表得$z_{0.05}=1.645$，并将已知资料$n_{1}=62$，$n_{2}=53$，$\bar{x}=6516$，$\bar{y}=3550$，$s_{1}=409$，$s_{2}=287$代入(7.4.8)，得$\mu_{1}-\mu_{2}$的置信水平为90%的置信区间为$(2858.73,3073.27)$。

**例7.4.8** 已知甲、乙两灯泡厂生产的灯泡寿命（单位：h）分别服从正态分布$N(\mu_{1}, \sigma_{1}^{2})$和$N(\mu_{2}, \sigma_{2}^{2})$。为比较两灯泡厂生产的灯泡质量，从甲、乙两厂生产的灯泡中分别抽取了16个和21个灯泡做试验，测得它们的样本均值和样本标准差分别为$\bar{x}_{1}=3680$，$s_{1}=130$，$\bar{x}_{2}=3230$，$s_{2}=58$。请以90%的置信水平估计两厂生产的灯泡平均寿命的差值范围。

解：这同样是有关两正态总体均值差的区间估计问题。题中没有假设两总体的方差相等，且两样本容量都小于50，因此需根据(7.4.9)来计算，其中自由度$k=\min\{n_{1}-1, n_{2}-1\}=\min\{16-1,21-1\}=15$。利用Excel或查$t$分布表得$t_{0.05}(15)=1.753$，并将已知资料$\bar{x}_{1}=3680$，$\bar{x}_{2}=3230$，$s_{1}=130$，$s_{2}=58$代入(7.4.9)，得$\mu_{1}-\mu_{2}$的置信水平为90%的置信区间为$(388.86, 511.14)$。

#### 2. 方差比$\frac{\sigma_{1}^{2}}{\sigma_{2}^{2}}$的区间估计
取$\frac{\sigma_{1}^{2}}{\sigma_{2}^{2}}$的点估计为$\frac{S_{1}^{2}}{S_{2}^{2}}$，由定理6.3.4知：
$$
\frac{S_{1}^{2} / S_{2}^{2}}{\sigma_{1}^{2} / \sigma_{2}^{2}} \sim F\left(n_{1}-1, n_{2}-1\right)
$$
利用枢轴量法，可求得$\frac{\sigma_{1}^{2}}{\sigma_{2}^{2}}$的置信水平为$1-\alpha$的置信区间为：
$$
\left(\frac{S_{1}^{2} / S_{2}^{2}}{F_{\alpha / 2}\left(n_{1}-1, n_{2}-1\right)}, \frac{S_{1}^{2} / S_{2}^{2}}{F_{1-\alpha / 2}\left(n_{1}-1, n_{2}-1\right)}\right) \quad (7.4.10)
$$

和$\chi^{2}$分布一样，$F$分布的密度函数同样不具有对称性，因此上述求得的置信区间的平均长度也不是最短的。

**例7.4.9** 根据例7.4.7中的数据资料，求受过高等教育和未受过高等教育的居民收入方差之比的置信区间（取$\alpha=0.05$）。

解：利用Excel得$F_{0.025}(61,52)=1.706$，$F_{0.975}(61,52)=0.593$，并将样本资料$n_{1}=62$，$n_{2}=53$，$s_{1}=409$，$s_{2}=287$代入(7.4.10)，得所求的置信区间为$(1.19, 3.42)$。

**例7.4.10** 甲、乙两台机床生产同一型号滚珠，从甲机床生产的滚珠中随机取8个，从乙机床生产的滚珠中随机取9个，测得这些滚珠的直径（单位：mm）如下：
甲机床：15.0 14.8 15.2 15.4 14.9 15.1 15.2 14.8
乙机床：15.2 15.0 14.8 15.1 14.6 14.8 15.1 14.5 15.0

设两机床生产的滚珠直径分别为$X$、$Y$，且$X \sim N(\mu_{1}, \sigma_{1}^{2})$，$Y \sim N(\mu_{2}, \sigma_{2}^{2})$，取置信水平为0.9。
（1）$\sigma_{1}=0.18$，$\sigma_{2}=0.24$，求$\mu_{1}-\mu_{2}$的置信区间；
（2）$\sigma_{1}=\sigma_{2}$未知，求$\mu_{1}-\mu_{2}$的置信区间；
（3）$\sigma_{1} \neq \sigma_{2}$未知，求$\mu_{1}-\mu_{2}$的置信区间；
（4）$\mu_{1}$，$\mu_{2}$未知，求$\frac{\sigma_{1}^{2}}{\sigma_{2}^{2}}$的置信区间。

解：由题意，$n_{1}=8$，$n_{2}=9$，计算得$\bar{x}=15.05$，$\bar{y}=14.90$，$s_{1}^{2}=0.0457$，$s_{2}^{2}=0.0575$。

（1）$\sigma_{1}=0.18$，$\sigma_{2}=0.24$，查表得$z_{0.05}=1.645$。根据公式(7.4.6)，计算得置信水平为0.9的$\mu_{1}-\mu_{2}$的置信区间为$(-0.018, 0.318)$。

（2）$\sigma_{1}=\sigma_{2}$未知，查表得$t_{0.05}(15)=1.753$。根据公式(7.4.7)，计算得置信水平为0.9的$\mu_{1}-\mu_{2}$的置信区间为$(-0.044,0.344)$。

（3）$\sigma_{1} \neq \sigma_{2}$未知，根据公式(7.4.9)计算，其中自由度$k=\min\{n_{1}-1, n_{2}-1\}=7$，查表得$t_{0.05}(7)=1.895$，得置信水平为0.9的$\mu_{1}-\mu_{2}$的置信区间为$(-0.058,0.358)$。

（4）$\mu_{1}$，$\mu_{2}$未知，查表得$F_{0.05}(7,8)=3.50$，$F_{0.95}(7,8)=\frac{1}{F_{0.05}(8,7)}=\frac{1}{3.73}$。根据公式(7.4.10)，计算得置信水平为0.9的$\frac{\sigma_{1}^{2}}{\sigma_{2}^{2}}$的置信区间为$(0.227,2.965)$。

注：置信区间与下一章的假设检验有密切关系，一般来说，若$\mu_{1}-\mu_{2}$的置信区间包含0，说明$\mu_{1}$与$\mu_{2}$没有显著差异；若$\frac{\sigma_{1}^{2}}{\sigma_{2}^{2}}$的置信区间包含1，说明$\sigma_{1}^{2}$与$\sigma_{2}^{2}$没有显著差异。

正态总体均值和方差的置信区间与单侧置信限见表7.4.1。

|总体类型|待估参数|其他参数|枢轴量的分布|置信区间|单侧置信限|
|---|---|---|---|---|---|
|单个正态总体|$\mu$|$\sigma^{2}$已知|$Z=\frac{\bar{X}-\mu}{\sigma / \sqrt{n}} \sim N(0,1)$| $\left(\bar{X} \pm \frac{\sigma}{\sqrt{n}} z_{\alpha / 2}\right)$| $\hat{\mu}_{U}=\bar{X}+\frac{\sigma}{\sqrt{n}} z_{\alpha}$，$\hat{\mu}_{L}=\bar{X}-\frac{\sigma}{\sqrt{n}} z_{\alpha}$|
|单个正态总体|$\mu$|$\sigma^{2}$未知|$t=\frac{\bar{X}-\mu}{S / \sqrt{n}} \sim t(n-1)$| $\left(\bar{X} \pm \frac{S}{\sqrt{n}} t_{\alpha / 2}(n-1)\right)$| $\hat{\mu}_{U}=\bar{X}+\frac{S}{\sqrt{n}} t_{\alpha}(n-1)$，$\hat{\mu}_{L}=\bar{X}-\frac{S}{\sqrt{n}} t_{\alpha}(n-1)$|
|单个正态总体|$\sigma^{2}$|$\mu$未知|$\chi^{2}=\frac{(n-1) S^{2}}{\sigma^{2}} \sim \chi^{2}(n-1)$| $\left(\frac{(n-1) S^{2}}{\chi_{\alpha / 2}^{2}(n-1)}, \frac{(n-1) S^{2}}{\chi_{1-\alpha / 2}^{2}(n-1)}\right)$| $\hat{\sigma}_{U}^{2}=\frac{(n-1) S^{2}}{\chi_{1-\alpha}^{2}(n-1)}$，$\hat{\sigma}_{L}^{2}=\frac{(n-1) S^{2}}{\chi_{\alpha}^{2}(n-1)}$|
|两个正态总体|$\mu_{1}-\mu_{2}$|$\sigma_{1}^{2}$和$\sigma_{2}^{2}$已知|$Z=\frac{(\bar{X}-\bar{Y})-(\mu_{1}-\mu_{2})}{\sqrt{\frac{\sigma_{1}^{2}}{n_{1}}+\frac{\sigma_{2}^{2}}{n_{2}}}} \sim N(0,1)$| $\left(\bar{X}-\bar{Y} \pm z_{\alpha / 2} \sqrt{\frac{\sigma_{1}^{2}}{n_{1}}+\frac{\sigma_{2}^{2}}{n_{2}}}\right)$| $(\hat{\mu_{1}-\mu_{2}})_{U}=\bar{X}-\bar{Y}+z_{\alpha} \sqrt{\frac{\sigma_{1}^{2}}{n_{1}}+\frac{\sigma_{2}^{2}}{n_{2}}}$，$(\hat{\mu_{1}-\mu_{2}})_{L}=\bar{X}-\bar{Y}-z_{\alpha} \sqrt{\frac{\sigma_{1}^{2}}{n_{1}}+\frac{\sigma_{2}^{2}}{n_{2}}}$|
|两个正态总体|$\mu_{1}-\mu_{2}$|$\sigma_{1}^{2}=\sigma_{2}^{2}=\sigma^{2}$未知|$t=\frac{(\bar{X}-\bar{Y})-(\mu_{1}-\mu_{2})}{S_{w} \sqrt{\frac{1}{n_{1}}+\frac{1}{n_{2}}}} \sim t(n_{1}+n_{2}-2)$（其中$S_{w}^{2}=\frac{(n_{1}-1) S_{1}^{2}+(n_{2}-1) S_{2}^{2}}{n_{1}+n_{2}-2}$）| $\left(\bar{X}-\bar{Y} \pm t_{\alpha / 2}(n_{1}+n_{2}-2) S_{w} \sqrt{\frac{1}{n_{1}}+\frac{1}{n_{2}}}\right)$| $(\hat{\mu_{1}-\mu_{2}})_{U}=\bar{X}-\bar{Y}+t_{\alpha}(n_{1}+n_{2}-2) S_{w} \sqrt{\frac{1}{n_{1}}+\frac{1}{n_{2}}}$，$(\hat{\mu_{1}-\mu_{2}})_{L}=\bar{X}-\bar{Y}-t_{\alpha}(n_{1}+n_{2}-2) S_{w} \sqrt{\frac{1}{n_{1}}+\frac{1}{n_{2}}}$|
|两个正态总体|$\mu_{1}-\mu_{2}$|$\sigma_{1}^{2} \neq \sigma_{2}^{2}$未知|$t=\frac{(\bar{X}-\bar{Y})-(\mu_{1}-\mu_{2})}{\sqrt{\frac{S_{1}^{2}}{n_{1}}+\frac{S_{2}^{2}}{n_{2}}}} \sim \begin{cases}N(0,1) & (n_{1},n_{2}>50) \\ t(k) & (k=\min\{n_{1}-1,n_{2}-1\})\end{cases}$| $\left(\bar{X}-\bar{Y} \pm q_{\alpha / 2} \sqrt{\frac{S_{1}^{2}}{n_{1}}+\frac{S_{2}^{2}}{n_{2}}}\right)$（其中$q_{p}=\begin{cases}z_{p} & (n_{1},n_{2}>50) \\ t_{p}(k) & (k=\min\{n_{1}-1,n_{2}-1\})\end{cases}$）| $(\hat{\mu_{1}-\mu_{2}})_{U}=\bar{X}-\bar{Y}+q_{\alpha} \sqrt{\frac{S_{1}^{2}}{n_{1}}+\frac{S_{2}^{2}}{n_{2}}}$，$(\hat{\mu_{1}-\mu_{2}})_{L}=\bar{X}-\bar{Y}-q_{\alpha} \sqrt{\frac{S_{1}^{2}}{n_{1}}+\frac{S_{2}^{2}}{n_{2}}}$|
|两个正态总体|$\frac{\sigma_{1}^{2}}{\sigma_{2}^{2}}$|$\mu_{1},\mu_{2}$未知|$F=\frac{S_{1}^{2} / S_{2}^{2}}{\sigma_{1}^{2} / \sigma_{2}^{2}} \sim F(n_{1}-1,n_{2}-1)$| $\left(\frac{S_{1}^{2} / S_{2}^{2}}{F_{\alpha / 2}(n_{1}-1,n_{2}-1)}, \frac{S_{1}^{2} / S_{2}^{2}}{F_{1-\alpha / 2}(n_{1}-1,n_{2}-1)}\right)$| $\hat{\left(\frac{\sigma_{1}^{2}}{\sigma_{2}^{2}}\right)}_{U}=\frac{S_{1}^{2} / S_{2}^{2}}{F_{1-\alpha}(n_{1}-1,n_{2}-1)}$，$\hat{\left(\frac{\sigma_{1}^{2}}{\sigma_{2}^{2}}\right)}_{L}=\frac{S_{1}^{2} / S_{2}^{2}}{F_{\alpha}(n_{1}-1,n_{2}-1)}$|

## *7.5 非正态总体参数的区间估计
当数据不服从正态分布时，求参数区间估计的一种有效方法就是所谓的大样本方法，即要求样本容量比较大，利用中心极限定理进行分析。

### （一）0-1分布参数的区间估计
设总体$X$服从0-1分布$B(1, p)$，$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本，当$n$充分大时，由中心极限定理知：
$$
\frac{\sum_{i=1}^{n} X_{i}-n p}{\sqrt{n p(1-p)}}=\frac{n \bar{X}-n p}{\sqrt{n p(1-p)}}
$$
近似服从标准正态分布$N(0,1)$。于是有：
$$
P\left\{-z_{\alpha / 2}<\frac{n \bar{X}-n p}{\sqrt{n p(1-p)}}<z_{\alpha / 2}\right\} \approx 1-\alpha
$$
等价于：
$$
P\left\{\left(n+z_{\alpha / 2}^{2}\right) p^{2}-\left(2 n \bar{X}+z_{\alpha / 2}^{2}\right) p+n \bar{X}^{2}<0\right\} \approx 1-\alpha
$$
求一元二次方程可得参数$p$的置信水平为$1-\alpha$的近似置信区间为：
$$
\left(\frac{1}{2 a}\left(-b-\sqrt{b^{2}-4 a c}\right), \frac{1}{2 a}\left(-b+\sqrt{b^{2}-4 a c}\right)\right)=\left(\hat{p}_{L}, \hat{p}_{U}\right) \quad (7.5.1)
$$
其中$a=n+z_{\alpha / 2}^{2}$，$b=-(2 n \bar{X}+z_{\alpha / 2}^{2})$，$c=n \bar{X}^{2}$。或取$p(1-p)$的估计量为$\bar{X}(1-\bar{X})$，得$p$的置信水平为$1-\alpha$的近似置信区间为：
$$
\left(\bar{X}-z_{\alpha / 2} \sqrt{\frac{\bar{X}(1-\bar{X})}{n}}, \bar{X}+z_{\alpha / 2} \sqrt{\frac{\bar{X}(1-\bar{X})}{n}}\right) \quad (7.5.2)
$$

在实际应用中，通常要满足$n>30$且$n p>5$，$n(1-p)>5$。

**例7.5.1** 某市随机抽取1000个家庭，调查知道其中有152个家庭拥有私家汽车，试根据此调查结果对该市家庭拥有私家汽车比例$p$作出区间估计（取置信水平为0.95）。

解：由已知资料计算得：
$$
a=n+z_{0.025}^{2}=1000+1.96^{2}=1003.8416
$$
$$
b=-\left(2 n \bar{x}+z_{0.025}^{2}\right)=-\left(2 \times 1000 \times \frac{152}{1000}+1.96^{2}\right)=-307.8416
$$
$$
c=n \bar{x}^{2}=1000 \times\left(\frac{152}{1000}\right)^{2}=23.104
$$
将上述结果代入(7.5.1)，得所求置信区间为$(0.131,0.176)$。

若按公式(7.5.2)计算，可得置信区间为$(0.130,0.174)$。

### （二）其他分布均值$\mu$的区间估计
设总体$X$的均值为$\mu$，方差为$\sigma^{2}$，$X_{1}, X_{2}, \cdots, X_{n}$是来自总体$X$的样本。根据中心极限定理，当样本容量$n$充分大时（要求$n>50$）：
$$
\frac{\sum_{i=1}^{n} X_{i}-n \mu}{\sqrt{n} \sigma} \stackrel{\text{近似地}}{\sim} N(0,1)
$$
故$\mu$的置信水平为$1-\alpha$的近似置信区间为：
$$
\left(\bar{X} \pm \frac{\sigma}{\sqrt{n}} z_{\alpha / 2}\right) \quad (7.5.3)
$$
如果方差$\sigma^{2}$未知，可以用估计量$S^{2}$代替$\sigma^{2}$，由此得到相应的近似置信区间为：
$$
\left(\bar{X} \pm \frac{S}{\sqrt{n}} z_{\alpha / 2}\right) \quad (7.5.4)
$$

注：当样本容量$n \leq50$时，根据实际经验，$t$分布具有良好的统计稳健性，即当总体$X$不服从正态分布，但样本数据基本对称时，枢轴量$\frac{\bar{X}-\mu}{S / \sqrt{n}}$仍可以看成近似服从分布$t(n-1)$，从而均值$\mu$的置信水平为$1-\alpha$的近似置信区间为：
$$
\left(\bar{X} \pm \frac{S}{\sqrt{n}} t_{\alpha / 2}(n-1)\right)
$$

**例7.5.2** 根据实际经验可以认为，任一路口单位时间内（如一分钟或一小时或一天等）的车流量服从泊松分布$P(\lambda)$。若以分钟为单位，对某路口进行2小时的记录，得平均每分钟车流量为50辆，标准差为10辆，求该路口平均每分钟车流量参数$\lambda$的置信水平为0.95的置信区间。

解：利用Excel或查正态分布表得$z_{0.025}=1.96$，并将样本资料$n=120$，$\bar{x}=50$，$s=10$代入(7.5.4)，得所求置信区间为$(48.211,51.789)$。