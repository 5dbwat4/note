---
title: 线代补天记录（1）
---

import { NCollapse, NCollapseItem } from 'naive-ui';


# 如何求矩阵乘法和特征值

$C = A \times B$ 

要计算 C 的第 i 行第 j 列的元素 c_ij：

1. 你的左手食指水平指向 A 的第 i 行。
2. 你的右手食指向下指向 B 的第 j 列。
3. 让两只手指在元素上“相遇”：把 A 第 i 行的第一个元素和 B 第 j 列的第一个元素相乘，然后 A 第 i 行的第二个元素和 B 第 j 列的第二个元素相乘，依此类推，直到这一行/列结束。
4. 把所有这些乘积加起来，得到的结果就是 c_ij。

特征值：

2x2 矩阵 $\det{A - \lambda I} = (a - \lambda)(d - \lambda) - bc$

3x3 或更高阶矩阵 对角矩阵/分块对角矩阵/上三角/下三角矩阵: 特征值就是主对角线上的元素
# 直线与方程

## 求异面直线距离

设异面直线 $L_1$ 和 $L_2$ 的参数方程为：  
$$
L_1: \boldsymbol{r_1} = \boldsymbol{a_1} + t\boldsymbol{v_1}, \quad L_2: \boldsymbol{r_2} = \boldsymbol{a_2} + s\boldsymbol{v_2},
$$  
其中：  
- $\boldsymbol{a_1}, \boldsymbol{a_2}$ 分别为 $L_1, L_2$ 上的定点，  
- $\boldsymbol{v_1}, \boldsymbol{v_2}$ 分别为 $L_1, L_2$ 的方向矢量，  

**原理**：分子是平行六面体的体积，分母是底面积，比值即为高（公垂线长度）。


| 直线关系       | 距离公式                                                                 |  
|----------------|--------------------------------------------------------------------------|  
| **异面直线**   | $d = \frac{\abs{\boldsymbol{P_1P_2} \cdot (\boldsymbol{v_1} \times \boldsymbol{v_2})}}{\abs{\boldsymbol{v_1} \times \boldsymbol{v_2}}}$ |  
| **平行直线**   | $d = \frac{\abs{\boldsymbol{P_1P_2} \times \boldsymbol{v}}}{\abs{\boldsymbol{v}}}$                                           |  

## 求直线/平面

设出方向向量/法向量，然后和已知条件联立$\boldsymbol{v}\boldsymbol{n}=0$方程

## 点到直线的距离

**注意是叉乘**

**适用条件**：直线用参数式或对称式表示，如 $L: \frac{x - x_0}{a} = \frac{y - y_0}{b} = \frac{z - z_0}{c}$（方向向量 $\boldsymbol{v} = (a, b, c)$），点为 $P(x_1, y_1, z_1)$。  
**公式**：  
$$
d = \frac{|\overrightarrow{P_0P} \times \boldsymbol{v}|}{|\boldsymbol{v}|},
$$  
其中 $P_0(x_0, y_0, z_0)$ 是直线上的定点，$\overrightarrow{P_0P} = (x_1 - x_0, y_1 - y_0, z_1 - z_0)$ 为点 $P$ 到 $P_0$ 的向量，$\times$ 表示向量叉乘。  

# 向量空间的积

$$
V_{1} \times \cdots \times V_{m} = \left\{ \left( v_{1},\ldots,v_{m} \right):v_{1} \in V_{1},\ldots,v_{m} \in V_{m} \right\}.
$$

向量空间之积的维数是各向量空间维数之和

# 对偶线性空间和对偶线性映照

# 欧式空间（内积空间）

（可以定义在复数域上）

**证明是内积空间**：

满足：**正，定，可加，齐次，共轭对称**

- 正性（positivity）：对于所有 $\mathbf{u} \in V$，均有 $\langle \mathbf{u}, \mathbf{u} \rangle \geq 0$。
- 定性（definiteness）：$\langle \mathbf{u}, \mathbf{u} \rangle = 0$ 当且仅当 $\mathbf{u} = 0$。
- 第一个位置上的可加性（additivity in first slot）：对于所有 $\mathbf{u}, \mathbf{v}, \mathbf{w} \in V$，均有 $\langle \mathbf{u} + \mathbf{v}, \mathbf{w} \rangle = \langle \mathbf{u}, \mathbf{w} \rangle + \langle \mathbf{v}, \mathbf{w} \rangle$。
- 第一个位置上的齐次性（homogeneity in first slot）：对于所有 $\lambda \in F$ 和所有 $\mathbf{u}, \mathbf{v} \in V$，均有 $\langle \lambda \mathbf{u}, \mathbf{v} \rangle = \lambda \langle \mathbf{u}, \mathbf{v} \rangle$。
- 共轭对称性（conjugate symmetry）：对于所有 $\mathbf{u}, \mathbf{v} \in V$，均有 $\langle \mathbf{u}, \mathbf{v} \rangle = \overline{\langle \mathbf{v}, \mathbf{u} \rangle}$。


# 格拉姆-施密特过程（Gram-Schmidt procedure）正交化

一组**线性无关**的向量 $\mathbf{v}_1, \mathbf{v}_2, \dots, \mathbf{v}_k$，生成一组**正交向量** $\mathbf{u}_1, \mathbf{u}_2, \dots, \mathbf{u}_k$，或一组**标准正交向量** $\mathbf{q}_1, \mathbf{q}_2, \dots, \mathbf{q}_k$

1. $\mathbf{u}_1 = \mathbf{v}_1$
2. $\mathbf{u}_2 = \mathbf{v}_2 - \text{proj}_{\mathbf{u}_1}(\mathbf{v}_2) = \mathbf{v}_2 - \frac{\mathbf{v}_2 \cdot \mathbf{u}_1}{\|\mathbf{u}_1\|^2} \mathbf{u}_1$
3. $\mathbf{u}_j = \mathbf{v}_j - \sum_{i=1}^{j-1} \text{proj}_{\mathbf{u}_i}(\mathbf{v}_j) = \mathbf{v}_j - \sum_{i=1}^{j-1} \frac{\mathbf{v}_j \cdot \mathbf{u}_i}{\|\mathbf{u}_i\|^2} \mathbf{u}_i$
4. 标准化： $\mathbf{q}_j = \frac{\mathbf{u}_j}{\|\mathbf{u}_j\|}$

<NCollapse>
<NCollapseItem title="详细步骤">

### 过程（步骤）
假设我们有一组**线性无关**的向量 $\mathbf{v}_1, \mathbf{v}_2, \dots, \mathbf{v}_k$。我们要生成一组**正交向量** $\mathbf{u}_1, \mathbf{u}_2, \dots, \mathbf{u}_k$，或者进一步得到一组**标准正交向量** $\mathbf{q}_1, \mathbf{q}_2, \dots, \mathbf{q}_k$（即单位正交向量，满足 $\|\mathbf{q}_i\| = 1$ 且 $\mathbf{q}_i \cdot \mathbf{q}_j = 0$ for $i \neq j$）。

#### 步骤 1：第一个正交向量
*   直接把第一个向量 $\mathbf{v}_1$ 当作正交化过程的起点：
    $$
    \mathbf{u}_1 = \mathbf{v}_1
    $$
*   （可选：标准化）如果你想得到标准正交基，就把 $\mathbf{u}_1$ 变成单位向量：
    $$
    \mathbf{q}_1 = \frac{\mathbf{u}_1}{\|\mathbf{u}_1\|}
    $$

#### 步骤 2：第二个正交向量
*   从 $\mathbf{v}_2$ 中**减去**它在**第一个正交向量** $\mathbf{u}_1$（或 $\mathbf{q}_1$）方向上的**投影分量**。
*   **投影分量**的计算：$\mathbf{v}_2$ 在 $\mathbf{u}_1$ 方向上的投影向量是：
    $$
    \text{proj}_{\mathbf{u}_1}(\mathbf{v}_2) = \frac{\mathbf{v}_2 \cdot \mathbf{u}_1}{\mathbf{u}_1 \cdot \mathbf{u}_1} \mathbf{u}_1
    $$
*   得到垂直于 $\mathbf{u}_1$ 的分量：
    $$
    \mathbf{u}_2 = \mathbf{v}_2 - \text{proj}_{\mathbf{u}_1}(\mathbf{v}_2) = \mathbf{v}_2 - \frac{\mathbf{v}_2 \cdot \mathbf{u}_1}{\|\mathbf{u}_1\|^2} \mathbf{u}_1
    $$
*   （可选：标准化）：
    $$
    \mathbf{q}_2 = \frac{\mathbf{u}_2}{\|\mathbf{u}_2\|}
    $$

#### 步骤 3：第三个正交向量
*   从 $\mathbf{v}_3$ 中**减去**它在**前两个已经正交化**的向量 $\mathbf{u}_1, \mathbf{u}_2$（或 $\mathbf{q}_1, \mathbf{q}_2$）方向上的**投影分量之和**。
*   **投影分量之和**的计算：
    $$
    \text{proj}_{\mathbf{u}_1}(\mathbf{v}_3) + \text{proj}_{\mathbf{u}_2}(\mathbf{v}_3) = \frac{\mathbf{v}_3 \cdot \mathbf{u}_1}{\mathbf{u}_1 \cdot \mathbf{u}_1} \mathbf{u}_1 + \frac{\mathbf{v}_3 \cdot \mathbf{u}_2}{\mathbf{u}_2 \cdot \mathbf{u}_2} \mathbf{u}_2
    $$
*   得到垂直于 $\mathbf{u}_1$ 和 $\mathbf{u}_2$ 的分量：
    $$
    \mathbf{u}_3 = \mathbf{v}_3 - \left( \frac{\mathbf{v}_3 \cdot \mathbf{u}_1}{\|\mathbf{u}_1\|^2} \mathbf{u}_1 + \frac{\mathbf{v}_3 \cdot \mathbf{u}_2}{\|\mathbf{u}_2\|^2} \mathbf{u}_2 \right)
    $$
*   （可选：标准化）：
    $$
    \mathbf{q}_3 = \frac{\mathbf{u}_3}{\|\mathbf{u}_3\|}
    $$

#### 通用步骤 j：第 j 个正交向量
*   从 $\mathbf{v}_j$ 中**减去**它在**前面所有已经正交化**的向量 $\mathbf{u}_1, \mathbf{u}_2, \dots, \mathbf{u}_{j-1}$ 方向上的**投影分量之和**：
    $$
    \mathbf{u}_j = \mathbf{v}_j - \sum_{i=1}^{j-1} \text{proj}_{\mathbf{u}_i}(\mathbf{v}_j) = \mathbf{v}_j - \sum_{i=1}^{j-1} \frac{\mathbf{v}_j \cdot \mathbf{u}_i}{\|\mathbf{u}_i\|^2} \mathbf{u}_i
    $$
*   （可选：标准化）：
    $$
    \mathbf{q}_j = \frac{\mathbf{u}_j}{\|\mathbf{u}_j\|}
    $$
*   对 $j = 1, 2, \dots, k$ 重复这个过程。

### 关键点
*   **线性无关是前提：** 输入的向量组**必须线性无关**。如果向量组线性相关，那么在进行到某个步骤时（比如第 m 步），你会发现 $\mathbf{u}_m = \mathbf{0}$（零向量），这说明 $\mathbf{v}_m$ 可以完全由前面的向量线性表示，它不能为新的正交方向做出贡献。这时可以丢弃 $\mathbf{v}_m$，继续处理下一个向量。
*   **结果：** 最终得到的 $\{\mathbf{u}_1, \mathbf{u}_2, \dots, \mathbf{u}_k\}$ 是一组**正交向量**（彼此点积为0）。如果进行了标准化，得到的 $\{\mathbf{q}_1, \mathbf{q}_2, \dots, \mathbf{q}_k\}$ 是一组**标准正交向量**（彼此点积为0，且长度都为1）。
*   **张成的空间相同：** 新生成的正交向量组（或标准正交向量组）**张成的空间**（Span）与原始的线性无关向量组张成的空间**完全相同**。它只是同一空间的一组“更规整”（正交）的基。
*   **几何意义：** 每个步骤都是在求一个向量在“已经建立好的正交坐标系”上的垂直分量（残差）。

</NCollapseItem>

<NCollapseItem title="例子">

### 例子（二维空间）
假设我们有两个线性无关的向量：
$$
\mathbf{v}_1 = \begin{bmatrix} 1 \\ 1 \end{bmatrix}, \quad \mathbf{v}_2 = \begin{bmatrix} 2 \\ 0 \end{bmatrix}
$$
目标：用格拉姆-施密特过程求一组标准正交基 $\{\mathbf{q}_1, \mathbf{q}_2\}$。

1.  **计算第一个正交向量 $\mathbf{u}_1$ (并标准化为 $\mathbf{q}_1$):**
    $$
    \mathbf{u}_1 = \mathbf{v}_1 = \begin{bmatrix} 1 \\ 1 \end{bmatrix}
    $$
    $$
    \|\mathbf{u}_1\| = \sqrt{1^2 + 1^2} = \sqrt{2}
    $$
    $$
    \mathbf{q}_1 = \frac{\mathbf{u}_1}{\|\mathbf{u}_1\|} = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 \\ 1 \end{bmatrix} = \begin{bmatrix} \frac{\sqrt{2}}{2} \\ \frac{\sqrt{2}}{2} \end{bmatrix}
    $$

2.  **计算第二个向量在 $\mathbf{u}_1$ 上的投影：**
    $$
    \text{proj}_{\mathbf{u}_1}(\mathbf{v}_2) = \frac{\mathbf{v}_2 \cdot \mathbf{u}_1}{\mathbf{u}_1 \cdot \mathbf{u}_1} \mathbf{u}_1 = \frac{\begin{bmatrix} 2 \\ 0 \end{bmatrix} \cdot \begin{bmatrix} 1 \\ 1 \end{bmatrix}}{\begin{bmatrix} 1 \\ 1 \end{bmatrix} \cdot \begin{bmatrix} 1 \\ 1 \end{bmatrix}} \begin{bmatrix} 1 \\ 1 \end{bmatrix} = \frac{(2 \times 1 + 0 \times 1)}{(1 \times 1 + 1 \times 1)} \begin{bmatrix} 1 \\ 1 \end{bmatrix} = \frac{2}{2} \begin{bmatrix} 1 \\ 1 \end{bmatrix} = \begin{bmatrix} 1 \\ 1 \end{bmatrix}
    $$

3.  **计算第二个正交向量 $\mathbf{u}_2$：**
    $$
    \mathbf{u}_2 = \mathbf{v}_2 - \text{proj}_{\mathbf{u}_1}(\mathbf{v}_2) = \begin{bmatrix} 2 \\ 0 \end{bmatrix} - \begin{bmatrix} 1 \\ 1 \end{bmatrix} = \begin{bmatrix} 1 \\ -1 \end{bmatrix}
    $$
    *验证正交性：* $\mathbf{u}_1 \cdot \mathbf{u}_2 = \begin{bmatrix} 1 & 1 \end{bmatrix} \begin{bmatrix} 1 \\ -1 \end{bmatrix} = 1 \times 1 + 1 \times (-1) = 0$。 垂直！

4.  **标准化 $\mathbf{u}_2$ 得到 $\mathbf{q}_2$：**
    $$
    \|\mathbf{u}_2\| = \sqrt{1^2 + (-1)^2} = \sqrt{2}
    $$
    $$
    \mathbf{q}_2 = \frac{\mathbf{u}_2}{\|\mathbf{u}_2\|} = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 \\ -1 \end{bmatrix} = \begin{bmatrix} \frac{\sqrt{2}}{2} \\ -\frac{\sqrt{2}}{2} \end{bmatrix}
    $$

**结果：** 我们得到了一组标准正交基：
$$
\mathbf{q}_1 = \begin{bmatrix} \frac{\sqrt{2}}{2} \\ \frac{\sqrt{2}}{2} \end{bmatrix}, \quad \mathbf{q}_2 = \begin{bmatrix} \frac{\sqrt{2}}{2} \\ -\frac{\sqrt{2}}{2} \end{bmatrix}
$$
这两个向量互相垂直（$\mathbf{q}_1 \cdot \mathbf{q}_2 = 0$），并且长度都是1 ($\|\mathbf{q}_1\| = 1, \|\mathbf{q}_2\| = 1$)。它们张成的平面和原来的 $\mathbf{v}_1, \mathbf{v}_2$ 张成的平面是同一个平面。

</NCollapseItem>
</NCollapse>

# 投影


# 里斯主定理

（复习课上讲的例子）

> 6.41 例 如下定义的函数 $\varphi: \mathcal{P}_2(\mathbb{R}) \to \mathbb{R}$
> 
> $$
> \varphi(p) = \int_{-1}^{1} p(t)(\cos(\pi t)) \, dt
> $$
> 
> 是 $\mathcal{P}_2(\mathbb{R})$ 上的线性泛函（这里 $\mathcal{P}_2(\mathbb{R})$ 上的内积是 $[-1, 1]$ 上的两个函数相乘后做定积分，见 6.33）。下面的事实并不显然：存在 $u \in \mathcal{P}_2(\mathbb{R})$ 使得对任意 $p \in \mathcal{P}_2(\mathbb{R})$ 均有
> 
> $$
> \varphi(p) = \langle p, u \rangle.
> $$
> 
> （我们不能取 $u(t) = \cos(\pi t)$，因为它不是 $\mathcal{P}_2(\mathbb{R})$ 中的元素。）


# 代数重数（Algebraic Multiplicity, AM）

# 若当标准型

**若当块（Jordan Block）**：每个若当块对应一个特征值，形式如下：
- **1阶块**：$[\lambda]$  
- **k阶块**：主对角线全为 $\lambda$，次对角线全为1：
  $$
  \begin{bmatrix}
  \lambda & 1 & 0 & \cdots & 0 \\
  0 & \lambda & 1 & \cdots & 0 \\
  \vdots & \vdots & \ddots & \ddots & \vdots \\
  0 & 0 & \cdots & \lambda & 1 \\
  0 & 0 & \cdots & 0 & \lambda
  \end{bmatrix}
  $$


**计算步骤**

1. 求特征值$\lambda_1, \lambda_2, \dots$
2. 对每个特征值 $\lambda$，计算其代数重数 $m$ 和几何重数 $g$。
3. 确定每个若当块的大小：$m \times m$，$g$个，对角线是$\lambda_i$，对角线上面一层$1$
4. 组装若当标准型 $J$，将所有若当块按特征值分组，沿对角线排列。



<NCollapse>
<NCollapseItem title="详细过程">
### **计算步骤**
#### **1. 求特征值**
计算矩阵 $A$ 的特征多项式 $\det(A - \lambda I) = 0$，得到所有特征值 $\lambda_1, \lambda_2, \dots$（含重数）。

#### **2. 对每个特征值 $\lambda$，计算几何重数与若当块**
- **代数重数（Algebraic Multiplicity）**：特征值在特征多项式中的重数，记为 $m$。  
- **几何重数（Geometric Multiplicity）**：特征空间维数，即 $\dim \ker(A - \lambda I)$，记为 $g$。  
  **关键结论**：几何重数 $g$ 等于该特征值对应的若当块个数。

#### **3. 确定每个若当块的大小**
对特征值 $\lambda$，令 $B = A - \lambda I$，计算幂零矩阵 $B^k$ 的秩（或零空间维数）：
- 计算序列：  
  $d_k = \dim \ker(B^k) - \dim \ker(B^{k-1})$（约定 $\dim \ker(B^0) = 0$）。  
- **大小为 $s$ 的若当块个数** = $d_s - d_{s+1}$。

#### **4. 组装若当标准型**
将所有若当块按特征值分组，沿对角线排列：
$$
J = \begin{bmatrix}
J_1 & & \\
& J_2 & \\
& & \ddots
\end{bmatrix}
$$

</NCollapseItem>

<NCollapseItem title="示例">

### **示例**
设矩阵 $A = \begin{bmatrix} 3 & 0 & 1 \\ 0 & 2 & 0 \\ 0 & 0 & 3 \end{bmatrix}$，求其若当标准型。

#### **步骤1：求特征值**
特征多项式：
$$
\det(A - \lambda I) = \det \begin{bmatrix} 3-\lambda & 0 & 1 \\ 0 & 2-\lambda & 0 \\ 0 & 0 & 3-\lambda \end{bmatrix} = (2-\lambda)(3-\lambda)^2.
$$
特征值：$\lambda_1 = 2$（代数重数 $m_1=1$），$\lambda_2 = 3$（代数重数 $m_2=2$）。

#### **步骤2：计算几何重数**
- **对 $\lambda_1 = 2$**：  
  $A - 2I = \begin{bmatrix} 1 & 0 & 1 \\ 0 & 0 & 0 \\ 0 & 0 & 1 \end{bmatrix}$，秩为 2 → $\dim \ker(A-2I) = 3-2=1$ → 几何重数 $g_1=1$。  
- **对 $\lambda_2 = 3$**：  
  $A - 3I = \begin{bmatrix} 0 & 0 & 1 \\ 0 & -1 & 0 \\ 0 & 0 & 0 \end{bmatrix}$，秩为 2 → $\dim \ker(A-3I) = 3-2=1$ → 几何重数 $g_2=1$。

#### **步骤3：确定若当块大小**
- **$\lambda_1 = 2$**：$g_1=1$ → 有 1 个若当块。代数重数 $m_1=1$ → 块大小为 $1 \times 1$，即 $[2]$。  
- **$\lambda_2 = 3$**：$g_2=1$ → 有 1 个若当块。代数重数 $m_2=2$ → 块大小为 $2 \times 2$。  
  验证：令 $B = A - 3I$，计算：
  - $B = \begin{bmatrix} 0 & 0 & 1 \\ 0 & -1 & 0 \\ 0 & 0 & 0 \end{bmatrix}$，$\dim \ker(B) = 1$ → $d_1 = 1$。  
  - $B^2 = \begin{bmatrix} 0 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 0 \end{bmatrix}$，$\dim \ker(B^2) = 2$ → $d_2 = 2 - 1 = 1$。  
  - $B^3 = 0$，$\dim \ker(B^3)=3$ → $d_3 = 3-2=1$。  
  块大小分布：  
  - 大小为 1 的块数：$d_1 - d_2 = 1 - 1 = 0$，  
  - 大小为 2 的块数：$d_2 - d_3 = 1 - 1 = 0$，  
  - 大小为 3 的块数：$d_3 = 1$（但总大小需为 2，矛盾）。  
  **修正**：因代数重数为 2，且几何重数为 1，唯一可能是 **1 个 $2 \times 2$ 若当块**（无需完整计算 $d_k$）。

#### **步骤4：组装若当标准型**
- $\lambda_1=2$ → $[2]$  
- $\lambda_2=3$ → $\begin{bmatrix} 3 & 1 \\ 0 & 3 \end{bmatrix}$  
最终若当标准型：
$$
J = \begin{bmatrix}
2 & 0 & 0 \\
0 & 3 & 1 \\
0 & 0 & 3
\end{bmatrix}.
$$

</NCollapseItem>
</NCollapse>


# 不变子空间

要求一个线性变换 $T: V \to V $ 的**不变子空间**

1. 求特征值$\lambda_1, \dots, \lambda_k $
2. 对每个特征值 $\lambda_i $，求特征空间 $E_{\lambda_i} = \ker(T - \lambda_i I) $。  
   - 特征空间是 $T $-不变子空间。
3. 对于重数大于 1 的特征值，求广义特征空间 $K_{\lambda_i} = \ker\big( (T - \lambda_i I)^{m_i} \big) $。  
   - 广义特征空间也是 $T $-不变子空间。
4. 此外，$\{0\}$和$V$也是不变子空间。



<NCollapse>
<NCollapseItem title="详细一点">

---

### **核心定义**
- **不变子空间**：子空间 $W \subseteq V $ 满足 $\forall \mathbf{w} \in W,\ T(\mathbf{w}) \in W $。
- **平凡解**：$\{0\} $ 和 $V $ 总是不变子空间。
- **非平凡解**：通常与特征值、特征向量、广义特征向量相关。

---

### **求解方法（有限维空间）**
设 $\dim V = n $，$T $ 的矩阵表示为 $A \in \mathbb{C}^{n \times n} $（或 $\mathbb{R}^{n \times n} $）。

#### **步骤 1：求特征值和特征向量**
1. 解特征方程 $\det(A - \lambda I) = 0 $，得特征值 $\lambda_1, \dots, \lambda_k $（含重数）。
2. 对每个 $\lambda_i $，求特征空间 $E_{\lambda_i} = \ker(A - \lambda_i I) $。  
   - **关键结论**：每个特征空间 $E_{\lambda_i} $ 是 $T $-不变子空间。  
   - 一维不变子空间必由特征向量生成。

#### **步骤 2：求广义特征空间（当特征值重数 > 1 时）**
对特征值 $\lambda_i $（代数重数 $m_i $），计算广义特征空间：  
$$
K_{\lambda_i} = \ker\big( (A - \lambda_i I)^{m_i} \big)
$$  
- $K_{\lambda_i} $ 是 $T $-不变子空间，且 $\dim K_{\lambda_i} = m_i $。  
- 其子空间可能不变（需验证）。

#### **步骤 3：利用循环子空间或若当链**
1. **循环子空间**：对向量 $\mathbf{v} \in V $，生成子空间：  
   $$
   W_{\mathbf{v}} = \operatorname{span} \{ \mathbf{v}, T\mathbf{v}, T^2\mathbf{v}, \dots \}
   $$  
   $W_{\mathbf{v}} $ 总是 $T $-不变的（称为循环子空间）。
2. **若当链**：若当标准型中的每个若当块对应一个循环子空间，由广义特征向量生成。

#### **步骤 4：验证子空间不变性（通用方法）**
若给定子空间 $W $，验证 $T(W) \subseteq W $：  
1. 取 $W $ 的基 $\{\mathbf{w}_1, \dots, \mathbf{w}_k\} $。  
2. 计算 $T\mathbf{w}_j $ 并检查是否可被基线性表示：  
   $$
   T\mathbf{w}_j = \sum_{i=1}^k c_{ij} \mathbf{w}_i \quad (\forall j)
   $$  
   若成立，则 $W $ 不变。

</NCollapseItem>


<NCollapseItem title="示例">
### **示例详解**
#### **示例 1：对角矩阵（可对角化）**
设 $T $ 的矩阵为 $A = \begin{bmatrix} 2 & 0 \\ 0 & 3 \end{bmatrix} $。  
1. **特征值**：$\lambda_1 = 2 $，$\lambda_2 = 3 $。  
2. **特征空间**：  
   - $E_2 = \ker \begin{bmatrix} 0 & 0 \\ 0 & 1 \end{bmatrix} = \operatorname{span} \left\{ \begin{bmatrix} 1 \\ 0 \end{bmatrix} \right\} $  
   - $E_3 = \ker \begin{bmatrix} -1 & 0 \\ 0 & 0 \end{bmatrix} = \operatorname{span} \left\{ \begin{bmatrix} 0 \\ 1 \end{bmatrix} \right\} $  
3. **不变子空间**：  
   - 0 维：$\{0\} $  
   - 1 维：$\operatorname{span} \left\{ \begin{bmatrix} 1 \\ 0 \end{bmatrix} \right\} $，$\operatorname{span} \left\{ \begin{bmatrix} 0 \\ 1 \end{bmatrix} \right\} $  
   - 2 维：$\mathbb{R}^2 $

---

#### **示例 2：若当块（不可对角化）**
设 $A = \begin{bmatrix} 3 & 1 \\ 0 & 3 \end{bmatrix} $。  
1. **特征值**：$\lambda = 3 $（代数重数 2）。  
2. **特征空间**：  
   $$
   E_3 = \ker \begin{bmatrix} 0 & 1 \\ 0 & 0 \end{bmatrix} = \operatorname{span} \left\{ \begin{bmatrix} 1 \\ 0 \end{bmatrix} \right\}
   $$  
3. **广义特征空间**：  
   $$
   K_3 = \ker \left( (A - 3I)^2 \right) = \ker \begin{bmatrix} 0 & 0 \\ 0 & 0 \end{bmatrix} = \mathbb{R}^2
   $$  
4. **求所有不变子空间**：  
   - **一维子空间**：设 $W = \operatorname{span} \left\{ \begin{bmatrix} a \\ b \end{bmatrix} \right\} $。  
     需 $A \begin{bmatrix} a \\ b \end{bmatrix} = \begin{bmatrix} 3a + b \\ 3b \end{bmatrix} \in W $，即存在 $k $ 使得：  
     $$
     \begin{cases}
     3a + b = k a \\
     3b = k b
     \end{cases}
     $$  
     - 若 $b \neq 0 $，则 $k = 3 $，代入得 $b = 0 $（矛盾）。  
     - 若 $b = 0 $，则 $W = \operatorname{span} \left\{ \begin{bmatrix} 1 \\ 0 \end{bmatrix} \right\} $。  
     **结论**：唯一一维不变子空间是 $E_3 $。  
   - **二维子空间**：$\mathbb{R}^2 $（平凡解）。  
   **最终不变子空间**：$\{0\} $，$\operatorname{span} \left\{ \begin{bmatrix} 1 \\ 0 \end{bmatrix} \right\} $，$\mathbb{R}^2 $。

---

#### **示例 3：三维空间（综合）**
设 $A = \begin{bmatrix} 4 & 1 & 0 \\ 0 & 4 & 0 \\ 0 & 0 & 3 \end{bmatrix} $。  
1. **特征值**：$\lambda = 4 $（代数重数 2），$\lambda = 3 $（代数重数 1）。  
2. **特征空间**：  
   - $E_4 = \ker \begin{bmatrix} 0 & 1 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & -1 \end{bmatrix} = \operatorname{span} \left\{ \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} \right\} $  
   - $E_3 = \ker \begin{bmatrix} 1 & 1 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 0 \end{bmatrix} = \operatorname{span} \left\{ \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix} \right\} $  
3. **广义特征空间（对 $\lambda = 4 $)**：  
   $$
   K_4 = \ker \left( (A - 4I)^2 \right) = \ker \begin{bmatrix} 0 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 1 \end{bmatrix} = \operatorname{span} \left\{ \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}, \begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix} \right\}
   $$  
4. **所有不变子空间**：  
   - 0 维：$\{0\} $  
   - 1 维：  
     $$
     \operatorname{span} \left\{ \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} \right\}, \quad \operatorname{span} \left\{ \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix} \right\}
     $$  
   - 2 维：  
     - $\operatorname{span} \left\{ \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}, \begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix} \right\} $（即 $K_4 $)  
     - $\operatorname{span} \left\{ \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}, \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix} \right\} $  
     **验证**：  
     - $A \begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix} = \begin{bmatrix} 1 \\ 4 \\ 0 \end{bmatrix} = 1 \cdot \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} + 4 \cdot \begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix} \in K_4 $  
     - $A \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix} = \begin{bmatrix} 0 \\ 0 \\ 3 \end{bmatrix} \in \operatorname{span} \left\{ \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}, \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix} \right\} $  
   - 3 维：$\mathbb{R}^3 $

</NCollapseItem>
</NCollapse>

# 奇异值和极分解

**奇异值**直接定义为矩阵 $A^TA$ 的特征值的**非负平方根**。

<NCollapse>
<NCollapseItem title="例子">
**例子：** 求矩阵 $A = \begin{bmatrix} 1 & 1 \\ 0 & 1 \end{bmatrix}$ 的奇异值。
1.  $A^TA = \begin{bmatrix} 1 & 0 \\ 1 & 1 \end{bmatrix} \begin{bmatrix} 1 & 1 \\ 0 & 1 \end{bmatrix} = \begin{bmatrix} 1 & 1 \\ 1 & 2 \end{bmatrix}$
2.  求 $A^TA$ 的特征值： $\det\left(\begin{bmatrix} 1-\lambda & 1 \\ 1 & 2-\lambda \end{bmatrix}\right) = (1-\lambda)(2-\lambda) - 1 = \lambda^2 - 3\lambda + 1 = 0$
    *   特征值： $\lambda_1 = \frac{3 + \sqrt{5}}{2}$, $\lambda_2 = \frac{3 - \sqrt{5}}{2}$ (都为正)。
3.  奇异值： $\sigma_1 = \sqrt{\frac{3 + \sqrt{5}}{2}}$, $\sigma_2 = \sqrt{\frac{3 - \sqrt{5}}{2}}$

</NCollapseItem>
</NCollapse>
